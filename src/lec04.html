<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas Ranner">

<title>4&nbsp; Direct solvers for systems of linear equations – COMP2870 Theoretical Foundations: Linear Algebra</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../src/lec05.html" rel="next">
<link href="../src/lec03.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ccb7598c1076c02ad842cf9fb90770d1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-6543c591f586cb3d6e99e55162843527.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-ccb7598c1076c02ad842cf9fb90770d1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../src/lec04.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Direct solvers for systems of linear equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">COMP2870 Theoretical Foundations: Linear Algebra</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/COMP2870-2526/linear-algebra-notes" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../COMP2870-Theoretical-Foundations--Linear-Algebra.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Floating point number systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to systems of linear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec04.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Direct solvers for systems of linear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Iterative solutions of linear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Complex numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Eigenvectors and eigenvalues</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../src/lec08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eigenvectors and eigenvalues: practical solutions</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#reminder-of-the-problem" id="toc-reminder-of-the-problem" class="nav-link active" data-scroll-target="#reminder-of-the-problem"><span class="header-section-number">4.1</span> Reminder of the problem</a></li>
  <li><a href="#elementary-row-operations" id="toc-elementary-row-operations" class="nav-link" data-scroll-target="#elementary-row-operations"><span class="header-section-number">4.2</span> Elementary row operations</a></li>
  <li><a href="#gaussian-elimination" id="toc-gaussian-elimination" class="nav-link" data-scroll-target="#gaussian-elimination"><span class="header-section-number">4.3</span> Gaussian elimination</a>
  <ul class="collapse">
  <li><a href="#the-algorithm" id="toc-the-algorithm" class="nav-link" data-scroll-target="#the-algorithm"><span class="header-section-number">4.3.1</span> The algorithm</a></li>
  <li><a href="#python-version" id="toc-python-version" class="nav-link" data-scroll-target="#python-version"><span class="header-section-number">4.3.2</span> Python version</a></li>
  </ul></li>
  <li><a href="#solving-triangular-systems-of-equations" id="toc-solving-triangular-systems-of-equations" class="nav-link" data-scroll-target="#solving-triangular-systems-of-equations"><span class="header-section-number">4.4</span> Solving triangular systems of equations</a></li>
  <li><a href="#combining-gaussian-elimination-and-backward-substitution" id="toc-combining-gaussian-elimination-and-backward-substitution" class="nav-link" data-scroll-target="#combining-gaussian-elimination-and-backward-substitution"><span class="header-section-number">4.5</span> Combining Gaussian elimination and backward substitution</a></li>
  <li><a href="#the-cost-of-gaussian-elimination" id="toc-the-cost-of-gaussian-elimination" class="nav-link" data-scroll-target="#the-cost-of-gaussian-elimination"><span class="header-section-number">4.6</span> The cost of Gaussian Elimination</a></li>
  <li><a href="#sec-LU-factorisation" id="toc-sec-LU-factorisation" class="nav-link" data-scroll-target="#sec-LU-factorisation"><span class="header-section-number">4.7</span> LU factorisation</a>
  <ul class="collapse">
  <li><a href="#computing-l-and-u" id="toc-computing-l-and-u" class="nav-link" data-scroll-target="#computing-l-and-u"><span class="header-section-number">4.7.1</span> Computing <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span></a></li>
  </ul></li>
  <li><a href="#effects-of-finite-precision-arithmetic" id="toc-effects-of-finite-precision-arithmetic" class="nav-link" data-scroll-target="#effects-of-finite-precision-arithmetic"><span class="header-section-number">4.8</span> Effects of finite precision arithmetic</a>
  <ul class="collapse">
  <li><a href="#gaussian-elimination-with-pivoting" id="toc-gaussian-elimination-with-pivoting" class="nav-link" data-scroll-target="#gaussian-elimination-with-pivoting"><span class="header-section-number">4.8.1</span> Gaussian elimination with pivoting</a></li>
  <li><a href="#python-code-for-gaussian-elimination-with-pivoting" id="toc-python-code-for-gaussian-elimination-with-pivoting" class="nav-link" data-scroll-target="#python-code-for-gaussian-elimination-with-pivoting"><span class="header-section-number">4.8.2</span> Python code for Gaussian elimination with pivoting</a></li>
  </ul></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">4.9</span> Further reading</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/edit/main/src/lec04.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/blob/main/src/lec04.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Direct solvers for systems of linear equations</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Thomas Ranner <a href="mailto:T.Ranner@leeds.ac.uk" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Computer Science, University of Leeds
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Module learning objective
</div>
</div>
<div class="callout-body-container callout-body">
<p>Apply direct and iterative solvers to solve systems of linear equations; implement methods using floating point numbers and investigate computational cost using computer experiments.</p>
</div>
</div>
<p>This section deals with first method we will use to solve systems of linear equations. We will see that by using the approach of Gaussian elimination (and variations of that method), we can solve any system of linear equations that has a solution.</p>
<p>Gaussian elimination should look very familiar to you – this looks a lot like solving simultaneous equations in high school. Here, we are trying to codify this approach into an algorithm that a computer can apply without any further human input in a way that always ‘works’ (or at least works when it should!).</p>
<section id="reminder-of-the-problem" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="reminder-of-the-problem"><span class="header-section-number">4.1</span> Reminder of the problem</h2>
<p>Recall the problem is to solve a set of <span class="math inline">\(n\)</span> <strong>linear</strong> equations for <span class="math inline">\(n\)</span> unknown values <span class="math inline">\(x_j\)</span>, for <span class="math inline">\(j=1, 2, \ldots, n\)</span>.</p>
<p><strong>Notation</strong>:</p>
<p><span class="math display">\[\begin{align*}
\text{Equation } 1:
&amp;&amp; a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n &amp; = b_1 \\
\text{Equation } 2:
&amp;&amp; a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n &amp; = b_2 \\
\vdots \\
\text{Equation } i:
&amp;&amp; a_{i1} x_1 + a_{i2} x_2 + a_{i3} x_3 + \cdots + a_{in} x_n &amp; = b_i \\
\vdots \\
\text{Equation } n:
&amp;&amp; a_{n1} x_1 + a_{n2} x_2 + a_{n3} x_3 + \cdots + a_{nn} x_n &amp; = b_n.
\end{align*}\]</span></p>
<p>We can also write the system of linear equations in <em>general matrix-vector</em> form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
<p>Recall that the <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> represents the coefficients that multiply the unknowns in each equation (row), while the <span class="math inline">\(n\)</span>-vector <span class="math inline">\(\vec{b}\)</span> represents the right-hand-side values.</p>
<p>Our strategy will be to reduce the system to a triangular system of matrices, which is then easy to solve!</p>
</section>
<section id="elementary-row-operations" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="elementary-row-operations"><span class="header-section-number">4.2</span> Elementary row operations</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<p>Note three things…</p>
<ul>
<li><p>The order in which we choose to write the <span class="math inline">\(n\)</span> equations is irrelevant</p></li>
<li><p>We can multiply any equation by an arbitrary real number (<span class="math inline">\(k \neq 0\)</span> say):</p>
<p><span class="math display">\[
k a_{p1} x_1 + k a_{p2} x_2 + k a_{p3} x_3 + \cdots + k a_{pn} x_n = k b_p.
\]</span></p></li>
<li><p>We can add any two equations:</p>
<p><span class="math display">\[
k a_{p1} x_1 + k a_{p2} x_2 + k a_{p3} x_3 + \cdots + k a_{pn} x_n = k b_p
\]</span></p></li>
</ul>
<p>added to</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q
\]</span></p>
<p>yields</p>
<p><span class="math display">\[
(k a_{p1} + a_{q1}) x_1 + (k a_{p2} + a_{q2}) x_2 + \cdots + (k a_{pn} +
a_{qn}) x_n = k b_p + b_q.
\]</span></p>
<div id="exm-ero" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1</strong></span> Consider the system <span class="math display">\[\begin{align}
2 x_1 + 3 x_2 &amp; = 4  \label{eq:eg1a} \\
-3 x_1 + 2 x_2 &amp; = 7 \label{eq:eg1b}.
\end{align}\]</span> Then we have: <span class="math display">\[\begin{align*}
4 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp; 8 x_1 + 12 x_2 &amp; = 16 \\
-15. \times \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp; 4.5 x_2 - 3 x_2 &amp; = -10.5 \\
\text{\eqref{eq:eg1a}} + \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp;
-x_1 + 5 x_2 &amp; = 11 \\
\text{\eqref{eq:eg1b}} + 1.5 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp;
0 + 6.5 x_2 &amp; = 13.
\end{align*}\]</span></p>
</div>
<div id="exr-elo" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1</strong></span> Consider the system <span class="math display">\[\begin{align}
x_1 + 2 x_2 &amp; = 1 \label{eq:eg2a} \\
4 x_1 + x_2 &amp; = -3 \label{eq:eg2b}.
\end{align}\]</span> Work out the result of these elementary row operations: <span class="math display">\[\begin{align*}
2 \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
0.25 \times \text{\eqref{eq:eg2b}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-1) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-4) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow
\end{align*}\]</span></p>
</div>
<p>For a system written in matrix form our three observations mean the following:</p>
<ul>
<li><p>We can swap any two rows of the matrix (and corresponding right-hand side entries). For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
-3 &amp; 2\\ 2 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
7 \\ 4
\end{pmatrix}
\]</span></p></li>
<li><p>We can multiply any row of the matrix (and corresponding right-hand side entry) by a scalar. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; \frac{3}{2} \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7
\end{pmatrix}
\]</span></p></li>
<li><p>We can replace row <span class="math inline">\(q\)</span> by row <span class="math inline">\(q + k \times\)</span> row <span class="math inline">\(p\)</span>. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
2 &amp; 3 \\ 0 &amp; 6.5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 13
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(w\)</span> by row <span class="math inline">\(2 + 1.5 \times\)</span> row <span class="math inline">\(1\)</span>)</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2 \\ 4 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -3
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; 2 \\ 0 &amp; -7
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -7
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(2\)</span> by row <span class="math inline">\(2 + (-4) \times\)</span> row <span class="math inline">\(1\)</span>)</p></li>
</ul>
<p>Our strategy for solving systems of linear equations using Gaussian elimination is based on the following ideas:</p>
<ul>
<li><p>The three types of operation described above are called <strong>elementary row operations</strong> (ERO).</p></li>
<li><p>We will apply a sequence of ERO to reduce an arbitrary system to a triangular form, which, we will see, can be easily solved.</p></li>
<li><p>The algorithm for reducing a general matrix to upper triangular form is known as <strong>forward elimination</strong> or (more commonly) as <strong>Gaussian elimination</strong>.</p></li>
</ul>
</section>
<section id="gaussian-elimination" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="gaussian-elimination"><span class="header-section-number">4.3</span> Gaussian elimination</h2>
<p>The algorithm of Gaussian elimination is an ancient method that you may have already met at school – perhaps by a different name. The details of the method may seem confusing at first. We are following the ideas of elimination from systems of simultaneous equations, but in a way that a computer understands. Thinking like a computer is an important point in this section. You will have seen different ideas of how to solve systems of simultaneous equations where the first step is to “look at the equations to decide the easiest first step”. When there are <span class="math inline">\(10^9\)</span> equations, it is not effective for a computer to try to find an easy way through the problem. The computer must be given a simple set of instructions to follow: this will be our algorithm.</p>
<p>The method is so old, in fact we have evidence of Chinese mathematicians using Gaussian elimination in 179CE (From <a href="https://en.wikipedia.org/wiki/Gaussian_elimination">Wikipedia</a>):</p>
<blockquote class="blockquote">
<p>The method of Gaussian elimination appears in the Chinese mathematical text Chapter Eight: Rectangular Arrays of The Nine Chapters on the Mathematical Art. Its use is illustrated in eighteen problems, with two to five equations. The first reference to the book by this title is dated to 179 CE, but parts of it were written as early as approximately 150 BCE. It was commented on by Liu Hui in the 3rd century.</p>
<p>The method in Europe stems from the notes of Isaac Newton. In 1670, he wrote that all the algebra books known to him lacked a lesson for solving simultaneous equations, which Newton then supplied. Carl Friedrich Gauss in 1810 devised a notation for symmetric elimination that was adopted in the 19th century by professional hand computers to solve the normal equations of least-squares problems. The algorithm that is taught in high school was named for Gauss only in the 1950s as a result of confusion over the history of the subject.</p>
</blockquote>
<div id="58382582" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lec04_files/figure-html/cell-3-output-1.png" width="319" height="470" class="figure-img"></p>
<figcaption>Image from Nine Chapter of the Mathematical art. By Yang Hui(1238-1298) - mybook, Public Domain, <a href="https://commons.wikimedia.org/w/index.php?curid=10317744" class="uri">https://commons.wikimedia.org/w/index.php?curid=10317744</a></figcaption>
</figure>
</div>
</div>
</div>
<section id="the-algorithm" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-algorithm"><span class="header-section-number">4.3.1</span> The algorithm</h3>
<p>The following algorithm systematically introduces zeros into the system of equations, below the diagonal.</p>
<ol type="1">
<li>Subtract multiples of row 1 from the rows below it to eliminate (make zero) non-zero entries in column 1.</li>
<li>Subtract multiples of the new row 2 from the rows below it to eliminate non-zero entries in column 2.</li>
<li>Repeat for row <span class="math inline">\(3, 4, \ldots, n-1\)</span>.</li>
</ol>
<p>After row <span class="math inline">\(n-1\)</span> all entities below the diagonal have been eliminated, so <span class="math inline">\(A\)</span> is now upper triangular and the resulting system can be solved by backward substitution.</p>
<div id="exm-ge" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2</strong></span> Use Gaussian elimination to reduce the following system of equations to upper triangular form:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\ 1 &amp; 2 &amp; 2 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}.
\]</span></p>
<p>First, use the first row to eliminate the first column below the diagonal:</p>
<ul>
<li><p>(row 2) <span class="math inline">\(- 0.5 \times\)</span> (row 1) gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 22
\end{pmatrix}
\]</span></p></li>
<li><p>(row 3) <span class="math inline">\(-\)</span> (row 1) then gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; 3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 10
\end{pmatrix}
\]</span></p></li>
</ul>
<p>Now use the second row to eliminate the second column below the diagonal.</p>
<ul>
<li><p>(row 3) <span class="math inline">\(- 2 \times\)</span> (row 2) gives</p>
<p><span class="math display">\[
  \begin{pmatrix}
   2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; \mathbf{0} &amp; 2
  \end{pmatrix}
  \begin{pmatrix}
  x_1 \\ x_2 \\ x_3
  \end{pmatrix} =
  \begin{pmatrix}
  12 \\ 3 \\ 4
  \end{pmatrix}
  \]</span></p></li>
</ul>
</div>
<div id="exr-ge" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2</strong></span> Use Gaussian elimination to reduce the following system of linear equations to upper triangular form.</p>
<p><span class="math display">\[
\begin{pmatrix}
4 &amp; -1 &amp; -1 \\ 2 &amp; 4 &amp; 2 \\ 1 &amp; 2 &amp; 4
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
9 \\ -6 \\ 3
\end{pmatrix}.
\]</span></p>
</div>
<p>The key idea is that:</p>
<ul>
<li><p>Each row <span class="math inline">\(i\)</span> is used to eliminate the entries in column <span class="math inline">\(i\)</span> below <span class="math inline">\(a_{ii}\)</span>, i.e.&nbsp;it forces <span class="math inline">\(a_{ji} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span>.</p></li>
<li><p>The elimination is done by subtracting a multiple of row <span class="math inline">\(i\)</span> from row <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[
  (\text{row } j) \leftarrow (\text{row } j) - \frac{a_{ji}}{a_{ii}}
  (\text{row } i).
  \]</span></p></li>
<li><p>Our update formula guarantees that <span class="math inline">\(a_{ji}\)</span> becomes zero because</p>
<p><span class="math display">\[
  a_{ji} \leftarrow a_{ji} - \frac{a_{ji}}{a_{ii}} a_{ii} = a_{ji} - a_{ji} =
  0.
  \]</span></p></li>
</ul>
</section>
<section id="python-version" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="python-version"><span class="header-section-number">4.3.2</span> Python version</h3>
<p>We start with some helper code which determines the size of the system we are working with:</p>
<div id="19eac711" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> system_size(A, b):</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="co">"""</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">    Validate the dimensions of a linear system and return its size.</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">    This function checks whether the given coefficient matrix `A` is square</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">    and whether its dimensions are compatible with the right-hand side vector</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">    `b`. If the dimensions are valid, it returns the size of the system.</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">    Parameters</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">    ----------</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">        A 2D array of shape ``(n, n)`` representing the coefficient matrix of</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">        the linear system.</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">        A array of shape ``(n, o)`` representing the right-hand side vector.</span></span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">    Returns</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">    -------</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">    int</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">        The size of the system, i.e., the number of variables `n`.</span></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">    Raises</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">    ------</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">    ValueError</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">        If `A` is not square or if the size of `b` does not match the number of</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">        rows in `A`.</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">    """</span></span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="co"># Validate that A is a 2D square matrix</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>    <span class="cf">if</span> A.ndim <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb1-31"><a href="#cb1-31"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"Matrix A must be 2D, but got </span><span class="sc">{</span>A<span class="sc">.</span>ndim<span class="sc">}</span><span class="ss">D array"</span>)</span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a>    n, m <span class="op">=</span> A.shape</span>
<span id="cb1-34"><a href="#cb1-34"></a>    <span class="cf">if</span> n <span class="op">!=</span> m:</span>
<span id="cb1-35"><a href="#cb1-35"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"Matrix A must be square, but got A.shape=</span><span class="sc">{</span>A<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a></span>
<span id="cb1-37"><a href="#cb1-37"></a>    <span class="cf">if</span> b.shape[<span class="dv">0</span>] <span class="op">!=</span> n:</span>
<span id="cb1-38"><a href="#cb1-38"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(</span>
<span id="cb1-39"><a href="#cb1-39"></a>            <span class="ss">f"System shapes are not compatible: A.shape=</span><span class="sc">{</span>A<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, "</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>            <span class="ss">f"b.shape=</span><span class="sc">{</span>b<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb1-41"><a href="#cb1-41"></a>        )</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a>    <span class="cf">return</span> n</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Then we can implement the elementary row operations</p>
<div id="6cba958d" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> row_swap(A, b, p, q):</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">    Swap two rows in a linear system of equations in place.</span></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">    This function swaps the rows `p` and `q` of the coefficient matrix `A`</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">    and the right-hand side vector `b` for a linear system of equations</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">    of the form ``Ax = b``. The operation is performed **in place**, modifying</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">    the input arrays directly.</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">    Parameters</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">    ----------</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">        of the linear system.</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">        vector of the system.</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">    p : int</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">        The index of the first row to swap. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">    q : int</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">        The index of the second row to swap. Must satisfy ``0 &lt;= q &lt; n``.</span></span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">    Returns</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">    -------</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">    None</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">        anything.</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co">    """</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="co"># get system size</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="co"># swap rows of A</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb2-33"><a href="#cb2-33"></a>        A[p, j], A[q, j] <span class="op">=</span> A[q, j], A[p, j]</span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="co"># swap rows of b</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>    b[p, <span class="dv">0</span>], b[q, <span class="dv">0</span>] <span class="op">=</span> b[q, <span class="dv">0</span>], b[p, <span class="dv">0</span>]</span>
<span id="cb2-36"><a href="#cb2-36"></a></span>
<span id="cb2-37"><a href="#cb2-37"></a></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="kw">def</span> row_scale(A, b, p, k):</span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="co">"""</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">    Scale a row of a linear system by a constant factor in place.</span></span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co">    This function multiplies all entries in row `p` of the coefficient matrix</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co">    `A` and the corresponding entry in the right-hand side vector `b` by a</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co">    scalar `k`. The operation is performed **in place**, modifying the input</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="co">    arrays directly.</span></span>
<span id="cb2-46"><a href="#cb2-46"></a></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="co">    Parameters</span></span>
<span id="cb2-48"><a href="#cb2-48"></a><span class="co">    ----------</span></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="co">        of the linear system.</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="co">        vector of the system.</span></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="co">    p : int</span></span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="co">        The index of the row to scale. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="co">    k : float</span></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="co">        The scalar multiplier applied to the entire row.</span></span>
<span id="cb2-59"><a href="#cb2-59"></a></span>
<span id="cb2-60"><a href="#cb2-60"></a><span class="co">    Returns</span></span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="co">    -------</span></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="co">    None</span></span>
<span id="cb2-63"><a href="#cb2-63"></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="co">        anything.</span></span>
<span id="cb2-65"><a href="#cb2-65"></a><span class="co">    """</span></span>
<span id="cb2-66"><a href="#cb2-66"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb2-67"><a href="#cb2-67"></a></span>
<span id="cb2-68"><a href="#cb2-68"></a>    <span class="co"># scale row p of A</span></span>
<span id="cb2-69"><a href="#cb2-69"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb2-70"><a href="#cb2-70"></a>        A[p, j] <span class="op">=</span> k <span class="op">*</span> A[p, j]</span>
<span id="cb2-71"><a href="#cb2-71"></a>    <span class="co"># scale row p of b</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">*</span> k</span>
<span id="cb2-73"><a href="#cb2-73"></a></span>
<span id="cb2-74"><a href="#cb2-74"></a></span>
<span id="cb2-75"><a href="#cb2-75"></a><span class="kw">def</span> row_add(A, b, p, k, q):</span>
<span id="cb2-76"><a href="#cb2-76"></a>    <span class="co">"""</span></span>
<span id="cb2-77"><a href="#cb2-77"></a><span class="co">    Perform an in-place row addition operation on a linear system.</span></span>
<span id="cb2-78"><a href="#cb2-78"></a></span>
<span id="cb2-79"><a href="#cb2-79"></a><span class="co">    This function applies the elementary row operation:</span></span>
<span id="cb2-80"><a href="#cb2-80"></a></span>
<span id="cb2-81"><a href="#cb2-81"></a><span class="co">    ``row_p ← row_p + k * row_q``</span></span>
<span id="cb2-82"><a href="#cb2-82"></a></span>
<span id="cb2-83"><a href="#cb2-83"></a><span class="co">    where `row_p` and `row_q` are rows in the coefficient matrix `A` and the</span></span>
<span id="cb2-84"><a href="#cb2-84"></a><span class="co">    right-hand side vector `b`. It updates the entries of `A` and `b`</span></span>
<span id="cb2-85"><a href="#cb2-85"></a><span class="co">    **in place**, directly modifying the original data.</span></span>
<span id="cb2-86"><a href="#cb2-86"></a></span>
<span id="cb2-87"><a href="#cb2-87"></a><span class="co">    Parameters</span></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="co">    ----------</span></span>
<span id="cb2-89"><a href="#cb2-89"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb2-90"><a href="#cb2-90"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb2-91"><a href="#cb2-91"></a><span class="co">        of the linear system.</span></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb2-93"><a href="#cb2-93"></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb2-94"><a href="#cb2-94"></a><span class="co">        vector of the system.</span></span>
<span id="cb2-95"><a href="#cb2-95"></a><span class="co">    p : int</span></span>
<span id="cb2-96"><a href="#cb2-96"></a><span class="co">        The index of the row to be updated (destination row). Must satisfy</span></span>
<span id="cb2-97"><a href="#cb2-97"></a><span class="co">        ``0 &lt;= p &lt; n``.</span></span>
<span id="cb2-98"><a href="#cb2-98"></a><span class="co">    k : float</span></span>
<span id="cb2-99"><a href="#cb2-99"></a><span class="co">        The scalar multiplier applied to `row_q` before adding it to `row_p`.</span></span>
<span id="cb2-100"><a href="#cb2-100"></a><span class="co">    q : int</span></span>
<span id="cb2-101"><a href="#cb2-101"></a><span class="co">        The index of the source row to be scaled and added. Must satisfy</span></span>
<span id="cb2-102"><a href="#cb2-102"></a><span class="co">        ``0 &lt;= q &lt; n``.</span></span>
<span id="cb2-103"><a href="#cb2-103"></a><span class="co">    """</span></span>
<span id="cb2-104"><a href="#cb2-104"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb2-105"><a href="#cb2-105"></a></span>
<span id="cb2-106"><a href="#cb2-106"></a>    <span class="co"># Perform the row operation</span></span>
<span id="cb2-107"><a href="#cb2-107"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb2-108"><a href="#cb2-108"></a>        A[p, j] <span class="op">=</span> A[p, j] <span class="op">+</span> k <span class="op">*</span> A[q, j]</span>
<span id="cb2-109"><a href="#cb2-109"></a></span>
<span id="cb2-110"><a href="#cb2-110"></a>    <span class="co"># Update the corresponding value in b</span></span>
<span id="cb2-111"><a href="#cb2-111"></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">+</span> k <span class="op">*</span> b[q, <span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let’s test we are ok so far:</p>
<p>Test 1: swapping rows</p>
<div id="2bdeb5d4" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">3.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.0</span>]])</span>
<span id="cb3-2"><a href="#cb3-2"></a>b <span class="op">=</span> np.array([[<span class="fl">4.0</span>], [<span class="fl">7.0</span>]])</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="bu">print</span>(<span class="st">"starting arrays:"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>print_array(A)</span>
<span id="cb3-6"><a href="#cb3-6"></a>print_array(b)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="bu">print</span>()</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="bu">print</span>(<span class="st">"swapping rows 0 and 1"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>row_swap(A, b, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># remember numpy arrays are indexed starting from zero!</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="bu">print</span>()</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="bu">print</span>(<span class="st">"new arrays:"</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a>print_array(A)</span>
<span id="cb3-15"><a href="#cb3-15"></a>print_array(b)</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting arrays:
A = [  2.0,  3.0 ]
    [ -3.0,  2.0 ]
b = [  4.0 ]
    [  7.0 ]

swapping rows 0 and 1

new arrays:
A = [ -3.0,  2.0 ]
    [  2.0,  3.0 ]
b = [  7.0 ]
    [  4.0 ]
</code></pre>
</div>
</div>
<p>Test 2: scaling one row</p>
<div id="f7ef56c2" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">3.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.0</span>]])</span>
<span id="cb5-2"><a href="#cb5-2"></a>b <span class="op">=</span> np.array([[<span class="fl">4.0</span>], [<span class="fl">7.0</span>]])</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="bu">print</span>(<span class="st">"starting arrays:"</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>print_array(A)</span>
<span id="cb5-6"><a href="#cb5-6"></a>print_array(b)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="bu">print</span>()</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="bu">print</span>(<span class="st">"row 0 |-&gt; 0.5 * row 0"</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a>row_scale(A, b, <span class="dv">0</span>, <span class="fl">0.5</span>)  <span class="co"># remember numpy arrays are indexed started from zero!</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="bu">print</span>()</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="bu">print</span>(<span class="st">"new arrays:"</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a>print_array(A)</span>
<span id="cb5-15"><a href="#cb5-15"></a>print_array(b)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting arrays:
A = [  2.0,  3.0 ]
    [ -3.0,  2.0 ]
b = [  4.0 ]
    [  7.0 ]

row 0 |-&gt; 0.5 * row 0

new arrays:
A = [  1.0,  1.5 ]
    [ -3.0,  2.0 ]
b = [  2.0 ]
    [  7.0 ]
</code></pre>
</div>
</div>
<p>Test 3: replacing a row by that adding a multiple of another row</p>
<div id="5bf62b2e" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">3.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.0</span>]])</span>
<span id="cb7-2"><a href="#cb7-2"></a>b <span class="op">=</span> np.array([[<span class="fl">4.0</span>], [<span class="fl">7.0</span>]])</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="bu">print</span>(<span class="st">"starting arrays:"</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>print_array(A)</span>
<span id="cb7-6"><a href="#cb7-6"></a>print_array(b)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="bu">print</span>()</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="bu">print</span>(<span class="st">"row 1 |-&gt; row 1 + 1.5 * row 0"</span>)</span>
<span id="cb7-10"><a href="#cb7-10"></a>row_add(A, b, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># remember numpy arrays are indexed started from zero!</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="bu">print</span>()</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="bu">print</span>(<span class="st">"new arrays:"</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a>print_array(A)</span>
<span id="cb7-15"><a href="#cb7-15"></a>print_array(b)</span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting arrays:
A = [  2.0,  3.0 ]
    [ -3.0,  2.0 ]
b = [  4.0 ]
    [  7.0 ]

row 1 |-&gt; row 1 + 1.5 * row 0

new arrays:
A = [  2.0,  3.0 ]
    [  0.0,  6.5 ]
b = [  4.0 ]
    [ 13.0 ]
</code></pre>
</div>
</div>
<p>Now we can define our Gaussian elimination function. We update the values in-place to avoid extra memory allocations.</p>
<div id="588ce616" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co">"""</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">    Perform Gaussian elimination to reduce a linear system to upper triangular</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">    form.</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">    This function performs **forward elimination** to transform the coefficient</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">    matrix `A` into an upper triangular matrix, while applying the same</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">    operations to the right-hand side vector `b`. This is the first step in</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">    solving a linear system of equations of the form ``Ax = b`` using Gaussian</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">    elimination.</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">    Parameters</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">    ----------</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">        of the system.</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">        vector.</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">    verbose : bool, optional</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">        If ``True``, prints detailed information about each elimination step,</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">        including the row operations performed and the intermediate forms of</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">        `A` and `b`. Default is ``False``.</span></span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">    Returns</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">    -------</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">    None</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">        This function modifies `A` and `b` **in place** and does not return</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">        anything.</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">    """</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>    <span class="co"># find shape of system</span></span>
<span id="cb9-32"><a href="#cb9-32"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb9-33"><a href="#cb9-33"></a></span>
<span id="cb9-34"><a href="#cb9-34"></a>    <span class="co"># perform forwards elimination</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb9-36"><a href="#cb9-36"></a>        <span class="co"># eliminate column i</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb9-38"><a href="#cb9-38"></a>            <span class="bu">print</span>(<span class="ss">f"eliminating column </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-39"><a href="#cb9-39"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb9-40"><a href="#cb9-40"></a>            <span class="co"># row j</span></span>
<span id="cb9-41"><a href="#cb9-41"></a>            factor <span class="op">=</span> A[j, i] <span class="op">/</span> A[i, i]</span>
<span id="cb9-42"><a href="#cb9-42"></a>            <span class="cf">if</span> verbose:</span>
<span id="cb9-43"><a href="#cb9-43"></a>                <span class="bu">print</span>(<span class="ss">f"  row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> |-&gt; row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss"> * row </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-44"><a href="#cb9-44"></a>            row_add(A, b, j, <span class="op">-</span>factor, i)</span>
<span id="cb9-45"><a href="#cb9-45"></a></span>
<span id="cb9-46"><a href="#cb9-46"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb9-47"><a href="#cb9-47"></a>            <span class="bu">print</span>()</span>
<span id="cb9-48"><a href="#cb9-48"></a>            <span class="bu">print</span>(<span class="st">"new system"</span>)</span>
<span id="cb9-49"><a href="#cb9-49"></a>            print_array(A)</span>
<span id="cb9-50"><a href="#cb9-50"></a>            print_array(b)</span>
<span id="cb9-51"><a href="#cb9-51"></a>            <span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can try our code on Example 1:</p>
<div id="269f319a" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">4.0</span>], [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>], [<span class="fl">2.0</span>, <span class="fl">4.0</span>, <span class="fl">6.0</span>]])</span>
<span id="cb10-2"><a href="#cb10-2"></a>b <span class="op">=</span> np.array([[<span class="fl">12.0</span>], [<span class="fl">9.0</span>], [<span class="fl">22.0</span>]])</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="bu">print</span>(<span class="st">"starting system:"</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>print_array(A)</span>
<span id="cb10-6"><a href="#cb10-6"></a>print_array(b)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="bu">print</span>()</span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="bu">print</span>(<span class="st">"performing Gaussian Elimination"</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a>gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="bu">print</span>()</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="bu">print</span>(<span class="st">"final system:"</span>)</span>
<span id="cb10-14"><a href="#cb10-14"></a>print_array(A)</span>
<span id="cb10-15"><a href="#cb10-15"></a>print_array(b)</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="bu">print</span>()</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co"># test that A is really upper triangular</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="bu">print</span>(<span class="st">"Is A really upper triangular?"</span>, np.allclose(A, np.triu(A)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting system:
A = [  2.0,  1.0,  4.0 ]
    [  1.0,  2.0,  2.0 ]
    [  2.0,  4.0,  6.0 ]
b = [ 12.0 ]
    [  9.0 ]
    [ 22.0 ]

performing Gaussian Elimination
eliminating column 0
  row 1 |-&gt; row 1 - 0.5 * row 0
  row 2 |-&gt; row 2 - 1.0 * row 0

new system
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  3.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [ 10.0 ]

eliminating column 1
  row 2 |-&gt; row 2 - 2.0 * row 1

new system
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  0.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [  4.0 ]


final system:
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  0.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [  4.0 ]

Is A really upper triangular? True</code></pre>
</div>
</div>
</section>
</section>
<section id="solving-triangular-systems-of-equations" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="solving-triangular-systems-of-equations"><span class="header-section-number">4.4</span> Solving triangular systems of equations</h2>
<p>A general <em>lower triangular</em> system of equations has <span class="math inline">\(a_{ij} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span> and takes the form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; \cdots &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
<p>Note that first equation is</p>
<p><span class="math display">\[
a_{11} x_1 = b_1.
\]</span></p>
<p>Then <span class="math inline">\(x_i\)</span> can be found by calculating</p>
<p><span class="math display">\[
x_i = \frac{1}{a_{ii}} \left(b_i - \sum_{j=1}^{i-1} a_{ij} x_j \right)
\]</span></p>
<p>for each row <span class="math inline">\(i = 1, 2, \ldots, n\)</span> in turn.</p>
<ul>
<li>Each calculation requires only previously computed values <span class="math inline">\(x_j\)</span> (and the sum gives a loop for <span class="math inline">\(j &lt; i\)</span>.</li>
<li>The matrix <span class="math inline">\(A\)</span> <strong>must</strong> have non-zero diagonal entries<br>
i.e.&nbsp;<span class="math inline">\(a_{ii} \neq 0\)</span> for <span class="math inline">\(i = 1, 2, \ldots, n\)</span>.</li>
<li><strong>Upper triangular</strong> systems of equations can be solved in similarly.</li>
</ul>
<div id="exm-fs" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3</strong></span> Solve the lower triangular system of equations given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;&amp; &amp;&amp; &amp;= 2 \\
x_1 &amp;+&amp; 2 x_2 &amp;&amp; &amp;= 7 \\
2 x_1 &amp;+&amp; 4 x_2 &amp;+&amp; 6 x_3 &amp;= 26
\end{aligned}
\]</span></p>
<p>or, equivalently,</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 0 &amp; 0 \\
1 &amp; 2 &amp; 0 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7 \\ 26
\end{pmatrix}.
\]</span></p>
<p>The solution can be calculated systematically from</p>
<p><span class="math display">\[
\begin{aligned}
x_1 &amp;= \frac{b_1}{a_{11}} = \frac{2}{2} = 1 \\
x_2 &amp;= \frac{b_2 - a_{21} x_1}{a_{22}}
= \frac{7 - 1 \times 1}{2} = \frac{6}{2} = 3 \\
x_3 &amp;= \frac{b_3 - a_{31} x_1 - a_{32} x_2}{a_33}
= \frac{26 - 2 \times 1 - 4 \times 3}{6}  = \frac{12}{6}
= 2
\end{aligned}
\]</span></p>
<p>which gives the solution <span class="math inline">\(\vec{x} = (1, 3, 2)^T\)</span>.</p>
</div>
<div id="exr-fs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3</strong></span> Solve the upper triangular linear system given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;+&amp; x_2 &amp;+&amp; 4 x_3 &amp;=&amp; 12 \\
&amp;&amp; 1.5 x_2 &amp;&amp; &amp;=&amp; 3 \\
&amp;&amp; &amp;&amp; 2 x_3 &amp;=&amp; 4
\end{aligned}.
\]</span></p>
</div>
<div id="rem-triangular" class="proof remark">
<p><span class="proof-title"><em>Remark 4.1</em>. </span></p>
<ul>
<li><p>It is simple to solve a lower (upper) triangular system of equations (provided the diagonal is non-zero).</p></li>
<li><p>This process is often referred to as <strong>forward</strong> (<strong>backwards</strong>) <strong>substitution</strong>.</p></li>
<li><p>A general system of equations (i.e.&nbsp;a full matrix <span class="math inline">\(A\)</span>) can be solved rapidly once it has been reduced to upper triangular form. The entire process is called Gaussian elimination with backward substitution.</p></li>
</ul>
</div>
<p>We can define functions to solve both upper and lower triangular form systems of linear equations:</p>
<div id="216bce13" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">def</span> forward_substitution(A, b):</span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="co">"""</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">    Solve a lower triangular system of linear equations using forward</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">    substitution.</span></span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">    This function solves the system of equations:</span></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">    .. math::</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">        A x = b</span></span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">    where `A` is a **lower triangular matrix** (all elements above the main</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">    diagonal are zero). The solution vector `x` is computed sequentially by</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">    solving each equation starting from the first row.</span></span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">    Parameters</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">    ----------</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the lower triangular</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">        coefficient matrix of the system.</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">        A 1D NumPy array of shape ``(n,)`` or a 2D NumPy array of shape</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">        ``(n, 1)`` representing the right-hand side vector.</span></span>
<span id="cb12-23"><a href="#cb12-23"></a></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">    Returns</span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co">    -------</span></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co">    x : numpy.ndarray</span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">        A NumPy array of shape ``(n,)`` containing the solution vector.</span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co">    """</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>    <span class="co">"""</span></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="co">    solves the system of linear equationa Ax = b assuming that A is lower</span></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co">    triangular. returns the solution x</span></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co">    """</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>    <span class="co"># get size of system</span></span>
<span id="cb12-34"><a href="#cb12-34"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb12-35"><a href="#cb12-35"></a></span>
<span id="cb12-36"><a href="#cb12-36"></a>    <span class="co"># check is lower triangular</span></span>
<span id="cb12-37"><a href="#cb12-37"></a>    <span class="cf">if</span> <span class="kw">not</span> np.allclose(A, np.tril(A)):</span>
<span id="cb12-38"><a href="#cb12-38"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Matrix A is not lower triangular"</span>)</span>
<span id="cb12-39"><a href="#cb12-39"></a></span>
<span id="cb12-40"><a href="#cb12-40"></a>    <span class="co"># create solution variable</span></span>
<span id="cb12-41"><a href="#cb12-41"></a>    x <span class="op">=</span> np.empty_like(b)</span>
<span id="cb12-42"><a href="#cb12-42"></a></span>
<span id="cb12-43"><a href="#cb12-43"></a>    <span class="co"># perform forwards solve</span></span>
<span id="cb12-44"><a href="#cb12-44"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb12-45"><a href="#cb12-45"></a>        partial_sum <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb12-46"><a href="#cb12-46"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, i):</span>
<span id="cb12-47"><a href="#cb12-47"></a>            partial_sum <span class="op">+=</span> A[i, j] <span class="op">*</span> x[j]</span>
<span id="cb12-48"><a href="#cb12-48"></a>        x[i] <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> A[i, i] <span class="op">*</span> (b[i] <span class="op">-</span> partial_sum)</span>
<span id="cb12-49"><a href="#cb12-49"></a></span>
<span id="cb12-50"><a href="#cb12-50"></a>    <span class="cf">return</span> x</span>
<span id="cb12-51"><a href="#cb12-51"></a></span>
<span id="cb12-52"><a href="#cb12-52"></a></span>
<span id="cb12-53"><a href="#cb12-53"></a><span class="kw">def</span> backward_substitution(A, b):</span>
<span id="cb12-54"><a href="#cb12-54"></a>    <span class="co">"""</span></span>
<span id="cb12-55"><a href="#cb12-55"></a><span class="co">    Solve an upper triangular system of linear equations using backward</span></span>
<span id="cb12-56"><a href="#cb12-56"></a><span class="co">    substitution.</span></span>
<span id="cb12-57"><a href="#cb12-57"></a></span>
<span id="cb12-58"><a href="#cb12-58"></a><span class="co">    This function solves the system of equations:</span></span>
<span id="cb12-59"><a href="#cb12-59"></a></span>
<span id="cb12-60"><a href="#cb12-60"></a><span class="co">    .. math::</span></span>
<span id="cb12-61"><a href="#cb12-61"></a><span class="co">        A x = b</span></span>
<span id="cb12-62"><a href="#cb12-62"></a></span>
<span id="cb12-63"><a href="#cb12-63"></a><span class="co">    where `A` is an **upper triangular matrix** (all elements below the main</span></span>
<span id="cb12-64"><a href="#cb12-64"></a><span class="co">    diagonal are zero). The solution vector `x` is computed starting from the</span></span>
<span id="cb12-65"><a href="#cb12-65"></a><span class="co">    last equation and proceeding backward.</span></span>
<span id="cb12-66"><a href="#cb12-66"></a></span>
<span id="cb12-67"><a href="#cb12-67"></a><span class="co">    Parameters</span></span>
<span id="cb12-68"><a href="#cb12-68"></a><span class="co">    ----------</span></span>
<span id="cb12-69"><a href="#cb12-69"></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb12-70"><a href="#cb12-70"></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the upper triangular</span></span>
<span id="cb12-71"><a href="#cb12-71"></a><span class="co">        coefficient matrix of the system.</span></span>
<span id="cb12-72"><a href="#cb12-72"></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb12-73"><a href="#cb12-73"></a><span class="co">        A 1D NumPy array of shape ``(n,)`` or a 2D NumPy array of shape</span></span>
<span id="cb12-74"><a href="#cb12-74"></a><span class="co">        ``(n, 1)`` representing the right-hand side vector.</span></span>
<span id="cb12-75"><a href="#cb12-75"></a></span>
<span id="cb12-76"><a href="#cb12-76"></a><span class="co">    Returns</span></span>
<span id="cb12-77"><a href="#cb12-77"></a><span class="co">    -------</span></span>
<span id="cb12-78"><a href="#cb12-78"></a><span class="co">    x : numpy.ndarray</span></span>
<span id="cb12-79"><a href="#cb12-79"></a><span class="co">        A NumPy array of shape ``(n,)`` containing the solution vector.</span></span>
<span id="cb12-80"><a href="#cb12-80"></a><span class="co">    """</span></span>
<span id="cb12-81"><a href="#cb12-81"></a>    <span class="co"># get size of system</span></span>
<span id="cb12-82"><a href="#cb12-82"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb12-83"><a href="#cb12-83"></a></span>
<span id="cb12-84"><a href="#cb12-84"></a>    <span class="co"># check is upper triangular</span></span>
<span id="cb12-85"><a href="#cb12-85"></a>    <span class="cf">assert</span> np.allclose(A, np.triu(A))</span>
<span id="cb12-86"><a href="#cb12-86"></a></span>
<span id="cb12-87"><a href="#cb12-87"></a>    <span class="co"># create solution variable</span></span>
<span id="cb12-88"><a href="#cb12-88"></a>    x <span class="op">=</span> np.empty_like(b)</span>
<span id="cb12-89"><a href="#cb12-89"></a></span>
<span id="cb12-90"><a href="#cb12-90"></a>    <span class="co"># perform backwards solve</span></span>
<span id="cb12-91"><a href="#cb12-91"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):  <span class="co"># iterate over rows backwards</span></span>
<span id="cb12-92"><a href="#cb12-92"></a>        partial_sum <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb12-93"><a href="#cb12-93"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb12-94"><a href="#cb12-94"></a>            partial_sum <span class="op">+=</span> A[i, j] <span class="op">*</span> x[j]</span>
<span id="cb12-95"><a href="#cb12-95"></a>        x[i] <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> A[i, i] <span class="op">*</span> (b[i] <span class="op">-</span> partial_sum)</span>
<span id="cb12-96"><a href="#cb12-96"></a></span>
<span id="cb12-97"><a href="#cb12-97"></a>    <span class="cf">return</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And we can then test it out!</p>
<div id="b1b26627" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>], [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">0.0</span>], [<span class="fl">2.0</span>, <span class="fl">4.0</span>, <span class="fl">6.0</span>]])</span>
<span id="cb13-2"><a href="#cb13-2"></a>b <span class="op">=</span> np.array([[<span class="fl">2.0</span>], [<span class="fl">7.0</span>], [<span class="fl">26.0</span>]])</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="bu">print</span>(<span class="st">"The system is given by:"</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>print_array(A)</span>
<span id="cb13-6"><a href="#cb13-6"></a>print_array(b)</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="bu">print</span>()</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="bu">print</span>(<span class="st">"Solving the system using forward substitution"</span>)</span>
<span id="cb13-10"><a href="#cb13-10"></a>x <span class="op">=</span> forward_substitution(A, b)</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="bu">print</span>()</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="bu">print</span>(<span class="st">"The solution using forward substitution is:"</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a>print_array(x)</span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="bu">print</span>()</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="bu">print</span>(<span class="st">"Does x really solve the system?"</span>, np.allclose(A <span class="op">@</span> x, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>The system is given by:
A = [  2.0,  0.0,  0.0 ]
    [  1.0,  2.0,  0.0 ]
    [  2.0,  4.0,  6.0 ]
b = [  2.0 ]
    [  7.0 ]
    [ 26.0 ]

Solving the system using forward substitution

The solution using forward substitution is:
x = [  1.0 ]
    [  3.0 ]
    [  2.0 ]

Does x really solve the system? True</code></pre>
</div>
</div>
<p>We can also do a backward substitution test:</p>
<div id="7dd6fc11" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">4.0</span>], [<span class="fl">0.0</span>, <span class="fl">1.5</span>, <span class="fl">0.0</span>], [<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">2.0</span>]])</span>
<span id="cb15-2"><a href="#cb15-2"></a>b <span class="op">=</span> np.array([[<span class="fl">12.0</span>], [<span class="fl">3.0</span>], [<span class="fl">4.0</span>]])</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="bu">print</span>(<span class="st">"The system is given by:"</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>print_array(A)</span>
<span id="cb15-6"><a href="#cb15-6"></a>print_array(b)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="bu">print</span>()</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="bu">print</span>(<span class="st">"Solving the system using backward substitution"</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="bu">print</span>()</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="bu">print</span>(<span class="st">"The solution using backward substitution is:"</span>)</span>
<span id="cb15-14"><a href="#cb15-14"></a>print_array(x)</span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="bu">print</span>()</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="bu">print</span>(<span class="st">"Does x really solve the system?"</span>, np.allclose(A <span class="op">@</span> x, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>The system is given by:
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  0.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [  4.0 ]

Solving the system using backward substitution

The solution using backward substitution is:
x = [  1.0 ]
    [  2.0 ]
    [  2.0 ]

Does x really solve the system? True</code></pre>
</div>
</div>
</section>
<section id="combining-gaussian-elimination-and-backward-substitution" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="combining-gaussian-elimination-and-backward-substitution"><span class="header-section-number">4.5</span> Combining Gaussian elimination and backward substitution</h2>
<p>Our grand strategy can now come together so we have a method to solve systems of linear equations:</p>
<p>Given a system of linear equations <span class="math inline">\(A\vec{x} = \vec{b}\)</span>;</p>
<ul>
<li>First perform Gaussian elimination to give an equivalent system of equations in upper triangular form;</li>
<li>Then use backward substitution to produce a solution <span class="math inline">\(\vec{x}\)</span></li>
</ul>
<p>We can use our code to test this:</p>
<div id="b2530be7" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">4.0</span>], [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>], [<span class="fl">2.0</span>, <span class="fl">4.0</span>, <span class="fl">6.0</span>]])</span>
<span id="cb17-2"><a href="#cb17-2"></a>b <span class="op">=</span> np.array([[<span class="fl">12.0</span>], [<span class="fl">9.0</span>], [<span class="fl">22.0</span>]])</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="bu">print</span>(<span class="st">"starting system:"</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a>print_array(A)</span>
<span id="cb17-6"><a href="#cb17-6"></a>print_array(b)</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="bu">print</span>()</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="bu">print</span>(<span class="st">"performing Gaussian Elimination"</span>)</span>
<span id="cb17-10"><a href="#cb17-10"></a>gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="bu">print</span>()</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="bu">print</span>(<span class="st">"upper triangular system:"</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a>print_array(A)</span>
<span id="cb17-15"><a href="#cb17-15"></a>print_array(b)</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="bu">print</span>()</span>
<span id="cb17-17"><a href="#cb17-17"></a></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="bu">print</span>(<span class="st">"Solving the system using backward substitution"</span>)</span>
<span id="cb17-19"><a href="#cb17-19"></a>x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="bu">print</span>()</span>
<span id="cb17-21"><a href="#cb17-21"></a></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="bu">print</span>(<span class="st">"solution using backward substitution:"</span>)</span>
<span id="cb17-23"><a href="#cb17-23"></a>print_array(x)</span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="bu">print</span>()</span>
<span id="cb17-25"><a href="#cb17-25"></a></span>
<span id="cb17-26"><a href="#cb17-26"></a>A <span class="op">=</span> np.array([[<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">4.0</span>], [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.0</span>], [<span class="fl">2.0</span>, <span class="fl">4.0</span>, <span class="fl">6.0</span>]])</span>
<span id="cb17-27"><a href="#cb17-27"></a>b <span class="op">=</span> np.array([[<span class="fl">12.0</span>], [<span class="fl">9.0</span>], [<span class="fl">22.0</span>]])</span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="bu">print</span>(<span class="st">"Does x really solve the original system?"</span>, np.allclose(A <span class="op">@</span> x, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting system:
A = [  2.0,  1.0,  4.0 ]
    [  1.0,  2.0,  2.0 ]
    [  2.0,  4.0,  6.0 ]
b = [ 12.0 ]
    [  9.0 ]
    [ 22.0 ]

performing Gaussian Elimination
eliminating column 0
  row 1 |-&gt; row 1 - 0.5 * row 0
  row 2 |-&gt; row 2 - 1.0 * row 0

new system
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  3.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [ 10.0 ]

eliminating column 1
  row 2 |-&gt; row 2 - 2.0 * row 1

new system
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  0.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [  4.0 ]


upper triangular system:
A = [  2.0,  1.0,  4.0 ]
    [  0.0,  1.5,  0.0 ]
    [  0.0,  0.0,  2.0 ]
b = [ 12.0 ]
    [  3.0 ]
    [  4.0 ]

Solving the system using backward substitution

solution using backward substitution:
x = [  1.0 ]
    [  2.0 ]
    [  2.0 ]

Does x really solve the original system? True</code></pre>
</div>
</div>
<div id="exr-ge2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4</strong></span> Use Gaussian elimination followed by backwards elimination to solve the system: <span class="math display">\[\begin{equation*}
\begin{pmatrix}
2 &amp; 1 &amp; -1 \\
4 &amp; 5 &amp; 7 \\
-8 &amp; -3 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
6 \\ 30 \\ -22
\end{pmatrix}.
\end{equation*}\]</span>. $$</p>
</div>
</section>
<section id="the-cost-of-gaussian-elimination" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="the-cost-of-gaussian-elimination"><span class="header-section-number">4.6</span> The cost of Gaussian Elimination</h2>
<p>Gaussian elimination (GE) is unnecessarily expensive when it is applied to many systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right-hand sides <span class="math inline">\(\vec{b}\)</span>.</p>
<ul>
<li>The forward elimination process is the most computationally expensive part at <span class="math inline">\(O(n^3)\)</span> but is exactly the same for any choice of <span class="math inline">\(\vec{b}\)</span>.</li>
<li>In contrast, the solution of the resulting upper triangular system only requires <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
<div id="d76781e6" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lec04_files/figure-html/cell-17-output-1.png" width="599" height="431" class="figure-img"></p>
<figcaption>Runtime cost of applying Gaussian elimination (GE) and backwards solution (BS).</figcaption>
</figure>
</div>
</div>
</div>
<p>We can use this information to improve the way in which we solve multiple systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right-hand sides <span class="math inline">\(\vec{b}\)</span>.</p>
</section>
<section id="sec-LU-factorisation" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="sec-LU-factorisation"><span class="header-section-number">4.7</span> LU factorisation</h2>
<p>Our next algorithm, called LU factorisation, is a way to try to speed up Gaussian elimination by reusing information. This can be used when we solve systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right hand sides <span class="math inline">\(\vec{b}\)</span> - this is more common than you would think!</p>
<p>Recall the elementary row operations (EROs) from above. Note that the EROs can be produced by left multiplication with a suitable matrix:</p>
<ul>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 0
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ g &amp; h &amp; i \\ d &amp; e &amp; f
\end{pmatrix}
\]</span></p></li>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c &amp; d \\ e &amp; f &amp; g &amp; h \\ i &amp; j &amp; k &amp; l \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c &amp; d \\ i &amp; j &amp; k &amp; l \\ e &amp; f &amp; g &amp; h \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
\]</span></p></li>
<li><p>Multiply row by <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
\alpha &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
\alpha a &amp; \alpha b &amp; \alpha c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
\]</span></p></li>
<li><p><span class="math inline">\(\alpha \times \text{row } p + \text{row } q\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ \alpha &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ \alpha a + g &amp; \alpha b + h &amp; \alpha c + i
\end{pmatrix}
\]</span></p></li>
</ul>
<p>Since Gaussian elimination (GE) is just a sequence of EROs and each ERO is just multiplication by a suitable matrix, say <span class="math inline">\(E_k\)</span>, forward elimination applied to the system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> can be expressed as <span class="math display">\[
(E_m \cdots E_1) A \vec{x} = (E_m \cdots E_1) \vec{b},
\]</span> here <span class="math inline">\(m\)</span> is the number of EROs required to reduce the upper triangular form.</p>
<p>Let <span class="math inline">\(U = (E_m \cdots E_1) A\)</span> and <span class="math inline">\(L = (E_m \cdots E_1)^{-1}\)</span>. Now the original system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> is equivalent to</p>
<p><span class="math display">\[\begin{equation}
\label{eq:LU}
L U \vec{x} = \vec{b}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(U\)</span> is <em>upper triangular</em> (by construction) and <span class="math inline">\(L\)</span> may be shown to be lower triangular (provided the EROs do not include any row swaps).</p>
<p>Once <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> are known it is easy to solve <span class="math inline">\(\eqref{eq:LU}\)</span></p>
<ul>
<li>Solve <span class="math inline">\(L \vec{z} = \vec{b}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
<li>Solve <span class="math inline">\(U \vec{x} = \vec{z}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
<p><span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> may be found in <span class="math inline">\(O(n^3)\)</span> operations by performing GE and saving the <span class="math inline">\(E_i\)</span> matrices: however, it is more convenient to find them directly (also <span class="math inline">\(O(n^3)\)</span> operations).</p>
<section id="computing-l-and-u" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="computing-l-and-u"><span class="header-section-number">4.7.1</span> Computing <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span></h3>
<p>Consider a general <span class="math inline">\(4 \times 4\)</span> matrix <span class="math inline">\(A\)</span> and its factorisation <span class="math inline">\(LU\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; a_{34} \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
l_{21} &amp; 1 &amp; 0 &amp; 0 \\
l_{31} &amp; l_{32} &amp; 1 &amp; 0 \\
l_{41} &amp; l_{42} &amp; l_{43} &amp; 1
\end{pmatrix}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} &amp; u_{14} \\
0 &amp; u_{22} &amp; u_{23} &amp; u_{24} \\
0 &amp; 0 &amp; u_{33} &amp; u_{34} \\
0 &amp; 0 &amp; 0 &amp; u_{44}
\end{pmatrix}
\]</span></p>
<p>For the first column,</p>
<p><span class="math display">\[
\begin{aligned}
a_{11} &amp; = (1, 0, 0, 0) (u_{11}, 0, 0, 0)^T &amp;&amp; = u_{11}
&amp; \rightarrow u_{11} &amp; = a_{11} \\
a_{21} &amp; = (l_{21}, 1, 0, 0)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{21} u_{11}
&amp; \rightarrow l_{21} &amp; = a_{21} / u_{11} \\
a_{31} &amp; = (l_{31}, l_{32}, 1, 0)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{31} u_{11}
&amp; \rightarrow l_{31} &amp; = a_{31} / u_{11} \\
a_{41} &amp; = (l_{41}, l_{42}, l_{43}, 1)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{41} u_{11}
&amp; \rightarrow l_{41} &amp; = a_{41} / u_{11}
\end{aligned}
\]</span></p>
<p>The second, third and fourth columns follow in a similar manner, giving all the entries in <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span>.</p>
<div id="rem-how-to-LU" class="proof remark">
<p><span class="proof-title"><em>Remark 4.2</em>. </span></p>
<ul>
<li><p><span class="math inline">\(L\)</span> is assumed to have 1’s on the diagonal, to ensure that the factorisation is unique.</p></li>
<li><p>The process involves division by the diagonal entries <span class="math inline">\(u_{11}, u_{22}\)</span>, etc., so they <strong>must</strong> be non-zero.</p></li>
<li><p>In general the factors <span class="math inline">\(l_{ij}\)</span> and <span class="math inline">\(u_{ij}\)</span> are calculated for each column <span class="math inline">\(j\)</span> in turn, i.e.,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb19-3"><a href="#cb19-3"></a>      <span class="co"># Compute factors u_{ij}</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>      ...</span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb19-6"><a href="#cb19-6"></a>      <span class="co"># Compute factors l_{ij}</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>      ...</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul>
</div>
<div id="exm-lu" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4</strong></span> Use <span class="math inline">\(LU\)</span> factorisation to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}.
\]</span></p>
<p>This can be rewritten in the form <span class="math inline">\(A = LU\)</span> where</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
l_{21} &amp; 1 &amp; 0 \\
l_{31} &amp; l_{32} &amp; 1
\end{pmatrix}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} \\
0 &amp; u_{22} &amp; u_{23} \\
0 &amp; 0 &amp; u_{33}
\end{pmatrix}.
\]</span></p>
<p>Column 1 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
2 &amp; = u_{11} &amp;&amp; \rightarrow &amp; u_{11} &amp; = 2 \\
1 &amp; = l_{21} u_{11} &amp;&amp; \rightarrow &amp; l_{21} &amp; = 0.5 \\
2 &amp; = l_{31} u_{11} &amp;&amp; \rightarrow &amp; l_{31} &amp; = 1.
\end{aligned}
\]</span></p>
<p>Column 2 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
1 &amp; = u_{12} &amp;&amp; \rightarrow &amp; u_{12} &amp; = 1 \\
2 &amp; = l_{21} u_{12} + u_{22} &amp;&amp; \rightarrow &amp; u_{22} &amp; = 1.5 \\
4 &amp; = l_{31} u_{12} + l_{32} u_{22} &amp;&amp; \rightarrow &amp; l_{32} &amp; = 2.
\end{aligned}
\]</span></p>
<p>Column 3 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
4 &amp; = u_{13} &amp;&amp; \rightarrow &amp; u_{13} &amp; = 4 \\
2 &amp; = l_{21} u_{13} + u_{23} &amp;&amp; \rightarrow &amp; u_{23} &amp; = 0 \\
6 &amp; = l_{31} u_{13} + l_{32} u_{23} + u_{33} &amp;&amp; \rightarrow &amp; u_{33} &amp; = 2.
\end{aligned}
\]</span></p>
<p>Solve the lower triangular system <span class="math inline">\(L \vec{z} = \vec{b}\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0.5 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 1
\end{pmatrix}
\begin{pmatrix}
z_1 \\ z_2 \\ z_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}
\rightarrow
\begin{pmatrix}
z_1 \\ z_2 \\ z_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 3 \\ 4
\end{pmatrix}
\]</span></p>
<p>Solve the upper triangular system <span class="math inline">\(U \vec{x} = \vec{z}\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
0 &amp; 1.5 &amp; 0 \\
0 &amp; 0 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
\begin{pmatrix}
12 \\ 3 \\ 4
\end{pmatrix}
\rightarrow
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
1 \\ 2 \\ 2
\end{pmatrix}.
\]</span></p>
</div>
<div id="exr-lu" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5</strong></span> Rewrite the matrix <span class="math inline">\(A\)</span> as the product of lower and upper triangular matrices where</p>
<p><span class="math display">\[
A =
\begin{pmatrix}
4 &amp; 2 &amp; 0 \\
2 &amp; 3 &amp; 1 \\
0 &amp; 1 &amp; 2.5
\end{pmatrix}.
\]</span></p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>The first example gives</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0.5 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 1
\end{pmatrix}
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
0 &amp; 1.5 &amp; 0 \\
0 &amp; 0 &amp; 2
\end{pmatrix}
\]</span></p>
<p>Note that</p>
<ul>
<li><p>the matrix <span class="math inline">\(U\)</span> is the same as the fully eliminated upper triangular form produced by Gaussian elimination;</p></li>
<li><p><span class="math inline">\(L\)</span> contains the multipliers that were used at each stage to eliminate the rows.</p></li>
</ul>
</div>
</section>
</section>
<section id="effects-of-finite-precision-arithmetic" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="effects-of-finite-precision-arithmetic"><span class="header-section-number">4.8</span> Effects of finite precision arithmetic</h2>
<div id="exm-finite-precision" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5</strong></span> Consider the following linear system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
0 &amp; 2 &amp; 1 \\
2 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 4 \\ 5
\end{pmatrix}
\]</span></p>
<p><em>Problem</em>. We cannot eliminate the first column by the diagonal by adding multiples of row 1 to rows 2 and 3, respectively.</p>
<p><em>Solution</em>. Swap the order of the equations!</p>
<ul>
<li><p>Swap rows 1 and 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
4 \\ 7 \\ 5
\end{pmatrix}
\]</span></p></li>
<li><p>Now apply Gaussian elimination</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 1.5 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ 3
\end{pmatrix} \\
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 0 &amp; -0.75
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ -2.25
\end{pmatrix}.
\end{align*}\]</span></p></li>
</ul>
</div>
<div id="exm-finite-precision2" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.6</strong></span> Consider another system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
4 &amp; 2 &amp; 1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ 5 \\ 2
\end{pmatrix}
\]</span></p>
<ul>
<li><p>Apply Gaussian elimination as usual:</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ 2
\end{pmatrix}
\\
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
0 &amp; 1 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\end{align*}\]</span></p></li>
<li><p><em>Problem</em>. We cannot eliminate the second column below the diagonal by adding a multiple of row 2 to row 3.</p></li>
<li><p>Again, this problem may be overcome simply by swapping the order of the equations – this time, swapping rows 2 and 3:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; -1 \\
0 &amp; 0 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\]</span></p></li>
<li><p>We can now continue the Gaussian elimination process as usual.</p></li>
</ul>
</div>
<p><em>In general</em>. Gaussian elimination requires row swaps to avoid breaking down when there is a zero in the “pivot” position. Avoiding zero-division might be a familiar aspect of Gaussian elimination, but there is an additional reason to apply pivoting when working with floating point numbers:</p>
<div id="exm-finite-precision3" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.7</strong></span> Consider using Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
1 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<ul>
<li><p>The true, unique solution is <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>If <span class="math inline">\(\varepsilon \neq 0\)</span>, Gaussian elimination gives</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
0 &amp; 1 - \frac{1}{\varepsilon}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3 - \frac{2 + \varepsilon}{\varepsilon}
\end{pmatrix}
\]</span></p></li>
<li><p>Problems occur not only when <span class="math inline">\(\varepsilon = 0\)</span> but also when it is very small, i.e.&nbsp;when <span class="math inline">\(\frac{1}{\varepsilon}\)</span> is very large, which will introduce very significant rounding errors into the computation.</p></li>
</ul>
<p>Use Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
\varepsilon &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<ul>
<li><p>The true solution is still <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>Gaussian elimination now gives</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1 - \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 - 2\varepsilon
\end{pmatrix}
\]</span></p></li>
<li><p>The problems due to small values of <span class="math inline">\(\varepsilon\)</span> have disappeared.</p></li>
</ul>
<p>This is a genuine problem we see in the code versions too!</p>
<div id="0d7209a6" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="bu">print</span>(<span class="st">"without row swapping:"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="cf">for</span> eps <span class="kw">in</span> [<span class="fl">1.0e-2</span>, <span class="fl">1.0e-4</span>, <span class="fl">1.0e-6</span>, <span class="fl">1.0e-8</span>, <span class="fl">1.0e-10</span>, <span class="fl">1.0e-12</span>, <span class="fl">1.0e-14</span>]:</span>
<span id="cb20-3"><a href="#cb20-3"></a>    A <span class="op">=</span> np.array([[eps, <span class="fl">1.0</span>], [<span class="fl">1.0</span>, <span class="fl">1.0</span>]])</span>
<span id="cb20-4"><a href="#cb20-4"></a>    b <span class="op">=</span> np.array([[<span class="fl">2.0</span> <span class="op">+</span> eps], [<span class="fl">3.0</span>]])</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>    gaussian_elimination(A, b)</span>
<span id="cb20-7"><a href="#cb20-7"></a>    x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>eps<span class="op">=</span><span class="sc">:.1e}</span><span class="ss">"</span>, end<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>    print_array(x.T, <span class="st">"x.T"</span>, end<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a>    A <span class="op">=</span> np.array([[eps, <span class="fl">1.0</span>], [<span class="fl">1.0</span>, <span class="fl">1.0</span>]])</span>
<span id="cb20-12"><a href="#cb20-12"></a>    b <span class="op">=</span> np.array([[<span class="fl">2.0</span> <span class="op">+</span> eps], [<span class="fl">3.0</span>]])</span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="bu">print</span>(<span class="st">"Solution?"</span>, np.allclose(A <span class="op">@</span> x, b))</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="bu">print</span>()</span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="bu">print</span>(<span class="st">"with row swapping:"</span>)</span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="cf">for</span> eps <span class="kw">in</span> [<span class="fl">1.0e-2</span>, <span class="fl">1.0e-4</span>, <span class="fl">1.0e-6</span>, <span class="fl">1.0e-8</span>, <span class="fl">1.0e-10</span>, <span class="fl">1.0e-12</span>, <span class="fl">1.0e-14</span>]:</span>
<span id="cb20-18"><a href="#cb20-18"></a>    A <span class="op">=</span> np.array([[<span class="fl">1.0</span>, <span class="fl">1.0</span>], [eps, <span class="fl">1.0</span>]])</span>
<span id="cb20-19"><a href="#cb20-19"></a>    b <span class="op">=</span> np.array([[<span class="fl">3.0</span>], [<span class="fl">2.0</span> <span class="op">+</span> eps]])</span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a>    gaussian_elimination(A, b)</span>
<span id="cb20-22"><a href="#cb20-22"></a>    x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb20-23"><a href="#cb20-23"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>eps<span class="op">=</span><span class="sc">:.1e}</span><span class="ss">"</span>, end<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb20-24"><a href="#cb20-24"></a>    print_array(x.T, <span class="st">"x.T"</span>, end<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb20-25"><a href="#cb20-25"></a></span>
<span id="cb20-26"><a href="#cb20-26"></a>    A <span class="op">=</span> np.array([[<span class="fl">1.0</span>, <span class="fl">1.0</span>], [eps, <span class="fl">1.0</span>]])</span>
<span id="cb20-27"><a href="#cb20-27"></a>    b <span class="op">=</span> np.array([[<span class="fl">3.0</span>], [<span class="fl">2.0</span> <span class="op">+</span> eps]])</span>
<span id="cb20-28"><a href="#cb20-28"></a>    <span class="bu">print</span>(<span class="st">"Solution?"</span>, np.allclose(A <span class="op">@</span> x, b))</span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>without row swapping:
eps=1.0e-02, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-04, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-06, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-08, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-10, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-12, x.T = [  1.00009,  2.00000 ], Solution? False
eps=1.0e-14, x.T = [  1.0214,  2.0000 ], Solution? False

with row swapping:
eps=1.0e-02, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-04, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-06, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-08, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-10, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-12, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-14, x.T = [  1.0,  2.0 ], Solution? True
</code></pre>
</div>
</div>
</div>
<div id="rem-finite-precision" class="proof remark">
<p><span class="proof-title"><em>Remark 4.3</em>. </span></p>
<ul>
<li><p>Writing the equations in a different order has removed the previous problem.</p></li>
<li><p>The diagonal entries are now always <em>relatively</em> larger.</p></li>
<li><p>The interchange of the order of equations is a simple example of <strong>row pivoting</strong>. This strategy avoids excessive rounding errors in the computations.</p></li>
</ul>
</div>
<section id="gaussian-elimination-with-pivoting" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="gaussian-elimination-with-pivoting"><span class="header-section-number">4.8.1</span> Gaussian elimination with pivoting</h3>
<p>Key idea:</p>
<ul>
<li><p>Before eliminating entries in column <span class="math inline">\(j\)</span>:</p>
<ul>
<li>find the entry in column <span class="math inline">\(j\)</span>, below the diagonal, of maximum magnitude;</li>
<li>if that entry is larger in magnitude than the diagonal entry then swap its row with row <span class="math inline">\(j\)</span>.</li>
</ul></li>
<li><p>Then eliminate column <span class="math inline">\(j\)</span> as before.</p></li>
</ul>
<p>This algorithm will always work when the matrix <span class="math inline">\(A\)</span> is non-singular. Conversely, if all of the possible pivot values are zero this implies that the matrix is singular and a unique solution does not exist. At each elimination step the row multiplies used are guaranteed to be at most one in magnitude so any errors in the representation of the system cannot be amplified by the elimination process. As always, solving <span class="math inline">\(A \vec{x} = \vec{b}\)</span> requires that the entries in <span class="math inline">\(\vec{b}\)</span> are also swapped in the appropriate way.</p>
<p>Pivoting can be applied in an equivalent way to LU factorisation. The sequence of pivots is independent of the vector <span class="math inline">\(\vec{b}\)</span> and can be recorded and reused. The constraint imposed on the row multipliers means that for LU factorisation every entry in <span class="math inline">\(L\)</span> satisfies <span class="math inline">\(| l_{ij} | \le 1\)</span>.</p>
<div id="exm-ge-pivot" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.8</strong></span> Consider the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
-3 &amp; 2.1 - \varepsilon &amp; 6 \\
5 &amp; -1 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 9.9 + \varepsilon \\ 11
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(0 \le \varepsilon \ll 1\)</span>, and solve it using</p>
<ol type="1">
<li><p>Gaussian elimination without pivoting</p></li>
<li><p>Gaussian elimination with pivoting.</p></li>
</ol>
<p>The exact solution is <span class="math inline">\(\vec{x} = (0, -1, 2)^T\)</span> for any <span class="math inline">\(\varepsilon\)</span> in the given range.</p>
<p><strong>1. Solve the system using Gaussian elimination with no pivoting.</strong></p>
<p>Eliminating the first column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>and then the second column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 0 &amp; 5 + 15/\varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5 + 2.5(12 + \varepsilon)/\varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to</p>
<p><span class="math display">\[
x_3 = \frac{3 + \frac{12 + \varepsilon}{\varepsilon}}{2 + \frac{6}{\varepsilon}}
\qquad
x_2 = \frac{(12 + \varepsilon) - 6x_3}{-\varepsilon} \qquad
x_1 = \frac{7+ 7x_2}{10}.
\]</span></p>
<p>There are many divisions by <span class="math inline">\(\varepsilon\)</span>, so we will have problems if <span class="math inline">\(\varepsilon\)</span> is (very) small.</p>
<p><strong>2. Solve the system using Gaussian elimination with pivoting.</strong></p>
<p>The first stage is identical (because <span class="math inline">\(a_{11} = 10\)</span> is largest).</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>but now <span class="math inline">\(|a_{22}| = \varepsilon\)</span> and <span class="math inline">\(|a_{32}| = 2.5\)</span> so we swap rows 2 and 3 to give</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; -\varepsilon &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>Now we may eliminate column 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; 0 &amp; 6 + 2 \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + 4 \varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to the exact answer:</p>
<p><span class="math display">\[
x_3 = \frac{12 + 4\varepsilon}{6 + 2 \varepsilon} = 2 \qquad
x_2 = \frac{7.5 - 5x_3}{2.5} = -1 \qquad
x_1 = \frac{7 + 7 x_2}{10} = 0.
\]</span></p>
</div>
</section>
<section id="python-code-for-gaussian-elimination-with-pivoting" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="python-code-for-gaussian-elimination-with-pivoting"><span class="header-section-number">4.8.2</span> Python code for Gaussian elimination with pivoting</h3>
<div id="1dde2d5f" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">def</span> gaussian_elimination_with_pivoting(A, b, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="co">"""</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">    perform Gaussian elimnation with pivoting to reduce the system of linear</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">    equations Ax=b to upper triangular form.</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">    use verbose to print out intermediate representations</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">    """</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>    <span class="co"># find shape of system</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="co"># perform forwards elimination</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb22-12"><a href="#cb22-12"></a>        <span class="co"># eliminate column i</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb22-14"><a href="#cb22-14"></a>            <span class="bu">print</span>(<span class="ss">f"eliminating column </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a>        <span class="co"># find largest entry in column i</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>        largest <span class="op">=</span> <span class="bu">abs</span>(A[i, i])</span>
<span id="cb22-18"><a href="#cb22-18"></a>        j_max <span class="op">=</span> i</span>
<span id="cb22-19"><a href="#cb22-19"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb22-20"><a href="#cb22-20"></a>            <span class="cf">if</span> <span class="bu">abs</span>(A[j, i]) <span class="op">&gt;</span> largest:</span>
<span id="cb22-21"><a href="#cb22-21"></a>                largest, j_max <span class="op">=</span> <span class="bu">abs</span>(A[j, i]), j</span>
<span id="cb22-22"><a href="#cb22-22"></a></span>
<span id="cb22-23"><a href="#cb22-23"></a>        <span class="co"># swap rows j_max and i</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>        row_swap(A, b, i, j_max)</span>
<span id="cb22-25"><a href="#cb22-25"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb22-26"><a href="#cb22-26"></a>            <span class="bu">print</span>(<span class="ss">f"swapped system (</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> &lt;-&gt; </span><span class="sc">{</span>j_max<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb22-27"><a href="#cb22-27"></a>            print_array(A)</span>
<span id="cb22-28"><a href="#cb22-28"></a>            print_array(b)</span>
<span id="cb22-29"><a href="#cb22-29"></a>            <span class="bu">print</span>()</span>
<span id="cb22-30"><a href="#cb22-30"></a></span>
<span id="cb22-31"><a href="#cb22-31"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb22-32"><a href="#cb22-32"></a>            <span class="co"># row j</span></span>
<span id="cb22-33"><a href="#cb22-33"></a>            factor <span class="op">=</span> A[j, i] <span class="op">/</span> A[i, i]</span>
<span id="cb22-34"><a href="#cb22-34"></a>            <span class="cf">if</span> verbose:</span>
<span id="cb22-35"><a href="#cb22-35"></a>                <span class="bu">print</span>(<span class="ss">f"row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> |-&gt; row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss"> * row </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-36"><a href="#cb22-36"></a>            row_add(A, b, j, <span class="op">-</span>factor, i)</span>
<span id="cb22-37"><a href="#cb22-37"></a></span>
<span id="cb22-38"><a href="#cb22-38"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb22-39"><a href="#cb22-39"></a>            <span class="bu">print</span>(<span class="st">"new system"</span>)</span>
<span id="cb22-40"><a href="#cb22-40"></a>            print_array(A)</span>
<span id="cb22-41"><a href="#cb22-41"></a>            print_array(b)</span>
<span id="cb22-42"><a href="#cb22-42"></a>            <span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Gaussian elimination without pivoting following by back subsitution:</p>
<div id="36990885" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>eps <span class="op">=</span> <span class="fl">1.0e-14</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>A <span class="op">=</span> np.array([[<span class="fl">10.0</span>, <span class="op">-</span><span class="fl">7.0</span>, <span class="fl">0.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.1</span> <span class="op">-</span> eps, <span class="fl">6.0</span>], [<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">5.0</span>]])</span>
<span id="cb23-3"><a href="#cb23-3"></a>b <span class="op">=</span> np.array([[<span class="fl">7.0</span>], [<span class="fl">9.9</span> <span class="op">+</span> eps], [<span class="fl">11.0</span>]])</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="bu">print</span>(<span class="st">"starting system:"</span>)</span>
<span id="cb23-6"><a href="#cb23-6"></a>print_array(A)</span>
<span id="cb23-7"><a href="#cb23-7"></a>print_array(b)</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="bu">print</span>()</span>
<span id="cb23-9"><a href="#cb23-9"></a></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="bu">print</span>(<span class="st">"performing Gaussian elimination without pivoting"</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a>gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="bu">print</span>()</span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="bu">print</span>(<span class="st">"upper triangular system:"</span>)</span>
<span id="cb23-15"><a href="#cb23-15"></a>print_array(A)</span>
<span id="cb23-16"><a href="#cb23-16"></a>print_array(b)</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="bu">print</span>()</span>
<span id="cb23-18"><a href="#cb23-18"></a></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="bu">print</span>(<span class="st">"performing backward substitution"</span>)</span>
<span id="cb23-20"><a href="#cb23-20"></a>x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="bu">print</span>()</span>
<span id="cb23-22"><a href="#cb23-22"></a></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="bu">print</span>(<span class="st">"solution using backward substitution:"</span>)</span>
<span id="cb23-24"><a href="#cb23-24"></a>print_array(x)</span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="bu">print</span>()</span>
<span id="cb23-26"><a href="#cb23-26"></a></span>
<span id="cb23-27"><a href="#cb23-27"></a>A <span class="op">=</span> np.array([[<span class="fl">10.0</span>, <span class="op">-</span><span class="fl">7.0</span>, <span class="fl">0.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.1</span> <span class="op">-</span> eps, <span class="fl">6.0</span>], [<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">5.0</span>]])</span>
<span id="cb23-28"><a href="#cb23-28"></a>b <span class="op">=</span> np.array([[<span class="fl">7.0</span>], [<span class="fl">9.9</span> <span class="op">+</span> eps], [<span class="fl">11.0</span>]])</span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="bu">print</span>(<span class="st">"Does x solve the original system?"</span>, np.allclose(A <span class="op">@</span> x, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting system:
A = [ 10.0, -7.0,  0.0 ]
    [ -3.0,  2.1,  6.0 ]
    [  5.0, -1.0,  5.0 ]
b = [  7.0 ]
    [  9.9 ]
    [ 11.0 ]

performing Gaussian elimination without pivoting
eliminating column 0
  row 1 |-&gt; row 1 - -0.3 * row 0
  row 2 |-&gt; row 2 - 0.5 * row 0

new system
A = [ 10.0, -7.0,  0.0 ]
    [  0.0, -0.0,  6.0 ]
    [  0.0,  2.5,  5.0 ]
b = [  7.0 ]
    [ 12.0 ]
    [  7.5 ]

eliminating column 1
  row 2 |-&gt; row 2 - -244760849313613.9 * row 1

new system
A = [ 10.0, -7.0,  0.0 ]
    [  0.0, -0.0,  6.0 ]
    [  0.0,  0.0, 1468565095881688.5 ]
b = [  7.0 ]
    [ 12.0 ]
    [ 2937130191763377.0 ]


upper triangular system:
A = [ 10.0, -7.0,  0.0 ]
    [  0.0, -0.0,  6.0 ]
    [  0.0,  0.0, 1468565095881688.5 ]
b = [  7.0 ]
    [ 12.0 ]
    [ 2937130191763377.0 ]

performing backward substitution

solution using backward substitution:
x = [ -0.030435 ]
    [ -1.043478 ]
    [  2.000000 ]

Does x solve the original system? False</code></pre>
</div>
</div>
<p>Gaussian elimination with pivoting following by back subsitution:</p>
<div id="86097af3" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>eps <span class="op">=</span> <span class="fl">1.0e-14</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>A <span class="op">=</span> np.array([[<span class="fl">10.0</span>, <span class="op">-</span><span class="fl">7.0</span>, <span class="fl">0.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.1</span> <span class="op">-</span> eps, <span class="fl">6.0</span>], [<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">5.0</span>]])</span>
<span id="cb25-3"><a href="#cb25-3"></a>b <span class="op">=</span> np.array([[<span class="fl">7.0</span>], [<span class="fl">9.9</span> <span class="op">+</span> eps], [<span class="fl">11.0</span>]])</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="bu">print</span>(<span class="st">"starting system:"</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>print_array(A)</span>
<span id="cb25-7"><a href="#cb25-7"></a>print_array(b)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="bu">print</span>()</span>
<span id="cb25-9"><a href="#cb25-9"></a></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="bu">print</span>(<span class="st">"performing Gaussian elimination with pivoting"</span>)</span>
<span id="cb25-11"><a href="#cb25-11"></a>gaussian_elimination_with_pivoting(A, b, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="bu">print</span>()</span>
<span id="cb25-13"><a href="#cb25-13"></a></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="bu">print</span>(<span class="st">"upper triangular system:"</span>)</span>
<span id="cb25-15"><a href="#cb25-15"></a>print_array(A)</span>
<span id="cb25-16"><a href="#cb25-16"></a>print_array(b)</span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="bu">print</span>()</span>
<span id="cb25-18"><a href="#cb25-18"></a></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="bu">print</span>(<span class="st">"performing backward substitution"</span>)</span>
<span id="cb25-20"><a href="#cb25-20"></a>x <span class="op">=</span> backward_substitution(A, b)</span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="bu">print</span>()</span>
<span id="cb25-22"><a href="#cb25-22"></a></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="bu">print</span>(<span class="st">"solution using backward substitution:"</span>)</span>
<span id="cb25-24"><a href="#cb25-24"></a>print_array(x)</span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="bu">print</span>()</span>
<span id="cb25-26"><a href="#cb25-26"></a></span>
<span id="cb25-27"><a href="#cb25-27"></a>A <span class="op">=</span> np.array([[<span class="fl">10.0</span>, <span class="op">-</span><span class="fl">7.0</span>, <span class="fl">0.0</span>], [<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">2.1</span> <span class="op">-</span> eps, <span class="fl">6.0</span>], [<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">5.0</span>]])</span>
<span id="cb25-28"><a href="#cb25-28"></a>b <span class="op">=</span> np.array([[<span class="fl">7.0</span>], [<span class="fl">9.9</span> <span class="op">+</span> eps], [<span class="fl">11.0</span>]])</span>
<span id="cb25-29"><a href="#cb25-29"></a><span class="bu">print</span>(<span class="st">"Does x solve the original system?"</span>, np.allclose(A <span class="op">@</span> x, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>starting system:
A = [ 10.0, -7.0,  0.0 ]
    [ -3.0,  2.1,  6.0 ]
    [  5.0, -1.0,  5.0 ]
b = [  7.0 ]
    [  9.9 ]
    [ 11.0 ]

performing Gaussian elimination with pivoting
eliminating column 0
swapped system (0 &lt;-&gt; 0)
A = [ 10.0, -7.0,  0.0 ]
    [ -3.0,  2.1,  6.0 ]
    [  5.0, -1.0,  5.0 ]
b = [  7.0 ]
    [  9.9 ]
    [ 11.0 ]

row 1 |-&gt; row 1 - -0.3 * row 0
row 2 |-&gt; row 2 - 0.5 * row 0
new system
A = [ 10.0, -7.0,  0.0 ]
    [  0.0, -0.0,  6.0 ]
    [  0.0,  2.5,  5.0 ]
b = [  7.0 ]
    [ 12.0 ]
    [  7.5 ]

eliminating column 1
swapped system (1 &lt;-&gt; 2)
A = [ 10.0, -7.0,  0.0 ]
    [  0.0,  2.5,  5.0 ]
    [  0.0, -0.0,  6.0 ]
b = [  7.0 ]
    [  7.5 ]
    [ 12.0 ]

row 2 |-&gt; row 2 - -4.085620730620576e-15 * row 1
new system
A = [ 10.0, -7.0,  0.0 ]
    [  0.0,  2.5,  5.0 ]
    [  0.0,  0.0,  6.0 ]
b = [  7.0 ]
    [  7.5 ]
    [ 12.0 ]


upper triangular system:
A = [ 10.0, -7.0,  0.0 ]
    [  0.0,  2.5,  5.0 ]
    [  0.0,  0.0,  6.0 ]
b = [  7.0 ]
    [  7.5 ]
    [ 12.0 ]

performing backward substitution

solution using backward substitution:
x = [  0.0 ]
    [ -1.0 ]
    [  2.0 ]

Does x solve the original system? True</code></pre>
</div>
</div>
</section>
</section>
<section id="further-reading" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">4.9</span> Further reading</h2>
<p>Some basic reading:</p>
<ul>
<li>Joseph F. Grcar. <a href="https://doi.org/10.1016/j.hm.2010.06.003">How ordinary elimination became Gaussian elimination</a>. Historia Mathematica. Volume 38, Issue 2, May 2011. (More history)</li>
</ul>
<p>Some implementations:</p>
<ul>
<li>Numpy <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html"><code>numpy.linalg.solve</code></a></li>
<li>Scipy <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lu.html"><code>scipy.linalg.lu</code></a></li>
<li>LAPACK Gaussian elimination (uses LU factorisation): <a href="https://netlib.org/lapack/explore-html-3.6.1/d7/d3b/group__double_g_esolve_ga5ee879032a8365897c3ba91e3dc8d512.html"><code>dgesv()</code></a></li>
<li>LAPACK LU Factorisation: <a href="http://www.netlib.org/lapack/explore-html/dd/d9a/group__double_g_ecomputational_ga0019443faea08275ca60a734d0593e60.html"><code>dgetrf()</code></a>.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/comp2870-2526\.github\.io\/linear-algebra-notes\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../src/lec03.html" class="pagination-link" aria-label="Introduction to systems of linear equations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to systems of linear equations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../src/lec05.html" class="pagination-link" aria-label="Iterative solutions of linear equations">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Iterative solutions of linear equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024-2025, Thomas Ranner and University of Leeds, licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="width:1em;height:1em"> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="width:1em;height:1em">.</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/edit/main/src/lec04.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/blob/main/src/lec04.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/COMP2870-2526/linear-algebra-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>