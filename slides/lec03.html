<!DOCTYPE html>
<html lang="en"><head>
<script src="lec03_files/libs/clipboard/clipboard.min.js"></script>
<script src="lec03_files/libs/quarto-html/tabby.min.js"></script>
<script src="lec03_files/libs/quarto-html/popper.min.js"></script>
<script src="lec03_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lec03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lec03_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lec03_files/libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lec03_files/libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="lec03_files/libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Dr.&nbsp;Thomas Ranner (Tom)">
  <title>COMP2870 Theoretical Foundations of Computer Science II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/theme/quarto-327cab17de08e4a17faa7d61f48ae591.css">
  <link href="lec03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script>
    MathJax = {
      tex: {
        tags: 'ams'  // should be 'ams', 'none', or 'all'
      }
    };
  </script>
  <script type="module" src="lec03_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
  <link href="lec03_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">COMP2870 Theoretical Foundations of Computer Science II</h1>
  <p class="subtitle">Introduction to systems of linear equations</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Thomas Ranner (Tom) 
</div>
<div class="quarto-title-author-email">
<a href="mailto:T.Ranner@leeds.ac.uk">T.Ranner@leeds.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            School of Computer Science, University of Leeds
          </p>
    </div>
</div>

</section>
<section>
<section id="direct-solvers-for-systems-of-linear-equations" class="title-slide slide level1 center">
<h1>Direct solvers for systems of linear equations</h1>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Module learning objective</strong></p>
</div>
<div class="callout-content">
<p>Apply <strong>direct</strong> and iterative solvers to solve systems of linear equations; implement methods using floating point numbers and investigate computational cost using computer experiments.</p>
</div>
</div>
</div>
<p>Chapter 4</p>
</section>
<section id="reminder-of-the-problem" class="title-slide slide level2 center">
<h2>Reminder of the problem</h2>
<p>Recall the problem is to solve a set of <span class="math inline">\(n\)</span> <strong>linear</strong> equations for <span class="math inline">\(n\)</span> unknown values <span class="math inline">\(x_j\)</span>, for <span class="math inline">\(j=1, 2, \ldots, n\)</span>.</p>
<p><strong>Notation</strong>:</p>
<p><span class="math display">\[\begin{align*}
\text{Equation } 1:
&amp;&amp; a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n &amp; = b_1 \\
\text{Equation } 2:
&amp;&amp; a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n &amp; = b_2 \\
\vdots \\
\text{Equation } i:
&amp;&amp; a_{i1} x_1 + a_{i2} x_2 + a_{i3} x_3 + \cdots + a_{in} x_n &amp; = b_i \\
\vdots \\
\text{Equation } n:
&amp;&amp; a_{n1} x_1 + a_{n2} x_2 + a_{n3} x_3 + \cdots + a_{nn} x_n &amp; = b_n.
\end{align*}\]</span></p>
</section>
<section id="general-matrix-vector-form" class="slide level3">
<h3>General matrix vector form</h3>
<p>We can also write the system of linear equations in <em>general matrix-vector</em> form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
</section>
<section id="the-big-plan" class="slide level3">
<h3>The big plan!</h3>
<p>Recall that the <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> represents the coefficients that multiply the unknowns in each equation (row), while the <span class="math inline">\(n\)</span>-vector <span class="math inline">\(\vec{b}\)</span> represents the right-hand-side values.</p>
<blockquote>
<p>Our strategy will be to reduce the system to a triangular system of matrices, which is then easy to solve!</p>
</blockquote>
</section>

<section id="elementary-row-operations" class="title-slide slide level2 center">
<h2>Elementary row operations</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<p>Note three things…</p>
</section>

<section id="elementary-row-operations-ii" class="title-slide slide level2 center">
<h2>Elementary row operations ii</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li>The order in which we choose to write the <span class="math inline">\(n\)</span> equations is irrelevant</li>
</ul>
</section>

<section id="elementary-row-operations-iii" class="title-slide slide level2 center">
<h2>Elementary row operations iii</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li><p>We can multiply any equation by an arbitrary real number (<span class="math inline">\(k \neq 0\)</span> say):</p>
<p><span class="math display">\[
k a_{p1} x_1 + k a_{p2} x_2 + k a_{p3} x_3 + \cdots + k a_{pn} x_n = k b_p.
\]</span></p></li>
</ul>
</section>

<section id="elementary-row-operations-iv" class="title-slide slide level2 center">
<h2>Elementary row operations iv</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li>We can add any two equations:</li>
</ul>
<p><span class="math display">\[
(a_{p1} + a_{q1}) x_1 + (a_{p2} + a_{q2}) x_2 + \cdots + (a_{pn} +
a_{qn}) x_n = b_p + b_q.
\]</span></p>
</section>
<section id="example" class="slide level3">
<h3>Example</h3>
<p>Consider the system <span class="math display">\[\begin{align}
2 x_1 + 3 x_2 &amp; = 4  \label{eq:eg1a} \\
-3 x_1 + 2 x_2 &amp; = 7 \label{eq:eg1b}.
\end{align}\]</span></p>
<aside class="notes">
<p>Then we have: <span class="math display">\[\begin{align*}
4 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp; 8 x_1 + 12 x_2 &amp; = 16 \\
-15. \times \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp; 4.5 x_2 - 3 x_2 &amp; = -10.5 \\
\text{\eqref{eq:eg1a}} + \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp;
-x_1 + 5 x_2 &amp; = 11 \\
\text{\eqref{eq:eg1b}} + 1.5 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp;
0 + 6.5 x_2 &amp; = 13.
\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise" class="slide level3">
<h3>Exercise</h3>
<p>Consider the system <span class="math display">\[\begin{align}
x_1 + 2 x_2 &amp; = 1 \label{eq:eg2a} \\
4 x_1 + x_2 &amp; = -3 \label{eq:eg2b}.
\end{align}\]</span> Work out the result of these elementary row operations: <span class="math display">\[\begin{align*}
2 \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
0.25 \times \text{\eqref{eq:eg2b}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-1) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-4) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow
\end{align*}\]</span></p>
<aside class="notes">
<p>For a system written in matrix form our three observations mean the following:</p>
<ul>
<li><p>We can swap any two rows of the matrix (and corresponding right-hand side entries). For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
-3 &amp; 2\\ 2 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
7 \\ 4
\end{pmatrix}
\]</span></p></li>
<li><p>We can multiply any row of the matrix (and corresponding right-hand side entry) by a scalar. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; \frac{3}{2} \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7
\end{pmatrix}
\]</span></p></li>
<li><p>We can replace row <span class="math inline">\(q\)</span> by row <span class="math inline">\(q + k \times\)</span> row <span class="math inline">\(p\)</span>. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
2 &amp; 3 \\ 0 &amp; 6.5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 13
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(w\)</span> by row <span class="math inline">\(2 + 1.5 \times\)</span> row <span class="math inline">\(1\)</span>)</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2 \\ 4 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -3
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; 2 \\ 0 &amp; -7
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -7
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(2\)</span> by row <span class="math inline">\(2 + (-4) \times\)</span> row <span class="math inline">\(1\)</span>)</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="our-grant-plan---refined" class="slide level3">
<h3>Our grant plan - refined</h3>
<p>Our strategy for solving systems of linear equations using Gaussian elimination is based on the following ideas:</p>
<ul>
<li><p>The three types of operation described above are called <strong>elementary row operations</strong> (ERO).</p></li>
<li><p>We will apply a sequence of ERO to reduce an arbitrary system to a triangular form, which, we will see, can be easily solved.</p></li>
<li><p>The algorithm for reducing a general matrix to upper triangular form is known as <strong>forward elimination</strong> or (more commonly) as <strong>Gaussian elimination</strong>.</p></li>
</ul>
</section>

<section id="gaussian-elimination" class="title-slide slide level2 center">
<h2>Gaussian elimination</h2>
<p>The method is so old, in fact we have evidence of Chinese mathematicians using Gaussian elimination in 179CE (From <a href="https://en.wikipedia.org/wiki/Gaussian_elimination">Wikipedia</a>):</p>
<blockquote>
<p>The method of Gaussian elimination appears in the Chinese mathematical text Chapter Eight: Rectangular Arrays of The Nine Chapters on the Mathematical Art. Its use is illustrated in eighteen problems, with two to five equations. The first reference to the book by this title is dated to 179 CE, but parts of it were written as early as approximately 150 BCE. It was commented on by Liu Hui in the 3rd century.</p>
</blockquote>
</section>
<section id="the-algorithm" class="slide level3">
<h3>The algorithm</h3>
<p>The following algorithm systematically introduces zeros into the system of equations, below the diagonal.</p>
<ol type="1">
<li>Subtract multiples of row 1 from the rows below it to eliminate (make zero) non-zero entries in column 1.</li>
<li>Subtract multiples of the new row 2 from the rows below it to eliminate non-zero entries in column 2.</li>
<li>Repeat for row <span class="math inline">\(3, 4, \ldots, n-1\)</span>.</li>
</ol>
<p>After row <span class="math inline">\(n-1\)</span> all entities below the diagonal have been eliminated, so <span class="math inline">\(A\)</span> is now upper triangular and the resulting system can be solved by backward substitution.</p>
</section>
<section id="example-1" class="slide level3">
<h3>Example</h3>
<p>Use Gaussian elimination to reduce the following system of equations to upper triangular form:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\ 1 &amp; 2 &amp; 2 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}.
\]</span></p>
<aside class="notes">
<p>First, use the first row to eliminate the first column below the diagonal:</p>
<ul>
<li><p>(row 2) <span class="math inline">\(- 0.5 \times\)</span> (row 1) gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 22
\end{pmatrix}
\]</span></p></li>
<li><p>(row 3) <span class="math inline">\(-\)</span> (row 1) then gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; 3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 10
\end{pmatrix}
\]</span></p></li>
</ul>
<p>Now use the second row to eliminate the second column below the diagonal.</p>
<ul>
<li><p>(row 3) <span class="math inline">\(- 2 \times\)</span> (row 2) gives</p>
<p><span class="math display">\[
  \begin{pmatrix}
   2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; \mathbf{0} &amp; 2
  \end{pmatrix}
  \begin{pmatrix}
  x_1 \\ x_2 \\ x_3
  \end{pmatrix} =
  \begin{pmatrix}
  12 \\ 3 \\ 4
  \end{pmatrix}
  \]</span></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-1" class="slide level3">
<h3>Exercise</h3>
<p>Use Gaussian elimination to reduce the following system of linear equations to upper triangular form.</p>
<p><span class="math display">\[
\begin{pmatrix}
4 &amp; -1 &amp; -1 \\ 2 &amp; 4 &amp; 2 \\ 1 &amp; 2 &amp; 4
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
9 \\ -6 \\ 3
\end{pmatrix}.
\]</span></p>
</section>
<section id="key-idea" class="slide level3">
<h3>Key idea</h3>
<p>The key idea is that:</p>
<ul>
<li><p>Each row <span class="math inline">\(i\)</span> is used to eliminate the entries in column <span class="math inline">\(i\)</span> below <span class="math inline">\(a_{ii}\)</span>, i.e.&nbsp;it forces <span class="math inline">\(a_{ji} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span>.</p></li>
<li><p>The elimination is done by subtracting a multiple of row <span class="math inline">\(i\)</span> from row <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[
  (\text{row } j) \leftarrow (\text{row } j) - \frac{a_{ji}}{a_{ii}}
  (\text{row } i).
  \]</span></p></li>
</ul>
<aside class="notes">
<ul>
<li><p>Our update formula guarantees that <span class="math inline">\(a_{ji}\)</span> becomes zero because</p>
<p><span class="math display">\[
  a_{ji} \leftarrow a_{ji} - \frac{a_{ji}}{a_{ii}} a_{ii} = a_{ji} - a_{ji} =
  0.
  \]</span></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="python-version" class="slide level3">
<h3>Python version</h3>
<p>We start with some helper code which determines the size of the system we are working with:</p>
<div>
<div id="pyodide-1" class="exercise-cell">

</div>
<script type="pyodide-1-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZSwiaW5jbHVkZSI6ZmFsc2UsIm91dHB1dCI6ZmFsc2V9LCJjb2RlIjoiXG5pbXBvcnQgaW5zcGVjdFxuXG5pbXBvcnQgbnVtcHkgYXMgbnBcblxuZGVmIHN5c3RlbV9zaXplKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFZhbGlkYXRlIHRoZSBkaW1lbnNpb25zIG9mIGEgbGluZWFyIHN5c3RlbSBhbmQgcmV0dXJuIGl0cyBzaXplLlxuXG4gICAgVGhpcyBmdW5jdGlvbiBjaGVja3Mgd2hldGhlciB0aGUgZ2l2ZW4gY29lZmZpY2llbnQgbWF0cml4IGBBYCBpcyBzcXVhcmVcbiAgICBhbmQgd2hldGhlciBpdHMgZGltZW5zaW9ucyBhcmUgY29tcGF0aWJsZSB3aXRoIHRoZSByaWdodC1oYW5kIHNpZGUgdmVjdG9yXG4gICAgYGJgLiBJZiB0aGUgZGltZW5zaW9ucyBhcmUgdmFsaWQsIGl0IHJldHVybnMgdGhlIHNpemUgb2YgdGhlIHN5c3RlbS5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgQSA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAyRCBhcnJheSBvZiBzaGFwZSBgYChuLCBuKWBgIHJlcHJlc2VudGluZyB0aGUgY29lZmZpY2llbnQgbWF0cml4IG9mXG4gICAgICAgIHRoZSBsaW5lYXIgc3lzdGVtLlxuICAgIGIgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgYXJyYXkgb2Ygc2hhcGUgYGAobiwgbylgYCByZXByZXNlbnRpbmcgdGhlIHJpZ2h0LWhhbmQgc2lkZSB2ZWN0b3IuXG5cbiAgICBSZXR1cm5zXG4gICAgLS0tLS0tLVxuICAgIGludFxuICAgICAgICBUaGUgc2l6ZSBvZiB0aGUgc3lzdGVtLCBpLmUuLCB0aGUgbnVtYmVyIG9mIHZhcmlhYmxlcyBgbmAuXG5cbiAgICBSYWlzZXNcbiAgICAtLS0tLS1cbiAgICBWYWx1ZUVycm9yXG4gICAgICAgIElmIGBBYCBpcyBub3Qgc3F1YXJlIG9yIGlmIHRoZSBzaXplIG9mIGBiYCBkb2VzIG5vdCBtYXRjaCB0aGUgbnVtYmVyIG9mXG4gICAgICAgIHJvd3MgaW4gYEFgLlxuICAgIFwiXCJcIlxuXG4gICAgIyBWYWxpZGF0ZSB0aGF0IEEgaXMgYSAyRCBzcXVhcmUgbWF0cml4XG4gICAgaWYgQS5uZGltICE9IDI6XG4gICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZlwiTWF0cml4IEEgbXVzdCBiZSAyRCwgYnV0IGdvdCB7QS5uZGltfUQgYXJyYXlcIilcblxuICAgIG4sIG0gPSBBLnNoYXBlXG4gICAgaWYgbiAhPSBtOlxuICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGZcIk1hdHJpeCBBIG11c3QgYmUgc3F1YXJlLCBidXQgZ290IEEuc2hhcGU9e0Euc2hhcGV9XCIpXG5cbiAgICBpZiBiLnNoYXBlWzBdICE9IG46XG4gICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoXG4gICAgICAgICAgICBmXCJTeXN0ZW0gc2hhcGVzIGFyZSBub3QgY29tcGF0aWJsZTogQS5zaGFwZT17QS5zaGFwZX0sIFwiXG4gICAgICAgICAgICBmXCJiLnNoYXBlPXtiLnNoYXBlfVwiXG4gICAgICAgIClcblxuICAgIHJldHVybiBuXG5cblxuZGVmIHByaW50X2FycmF5KGFycmF5LCBhcnJheV9uYW1lPU5vbmUsIGVuZD1Ob25lKTpcbiAgICBcIlwiXCJcbiAgICBOaWNlbHkgcHJpbnQgYSAyRCBOdW1QeSBhcnJheSB3aXRoIGR5bmFtaWMgcHJlY2lzaW9uIGZvcm1hdHRpbmcuXG5cbiAgICBUaGlzIGZ1bmN0aW9uIHByaW50cyBhIDJEIGFycmF5IGluIGEgcmVhZGFibGUsIGZvcm1hdHRlZCBzdHlsZS4gSXRcbiAgICBhdXRvbWF0aWNhbGx5IGRldGVybWluZXMgdGhlIHJlcXVpcmVkIHByZWNpc2lvbiB0byBhY2N1cmF0ZWx5IHJlcHJlc2VudCB0aGVcbiAgICBhcnJheSB2YWx1ZXMsIHVwIHRvIGEgbWF4aW11bSBvZiAxNSBkZWNpbWFsIHBsYWNlcy4gVGhlIHByaW50ZWQgb3V0cHV0XG4gICAgaW5jbHVkZXMgdGhlIGFycmF5IG5hbWUgaWYgcHJvdmlkZWQ7IG90aGVyd2lzZSwgdGhlIGZ1bmN0aW9uIGF0dGVtcHRzIHRvXG4gICAgaW5mZXIgdGhlIHZhcmlhYmxlIG5hbWUgZnJvbSB0aGUgY2FsbGluZyBzY29wZS5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgYXJyYXkgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMkQgTnVtUHkgYXJyYXkgdG8gcHJpbnQuXG4gICAgYXJyYXlfbmFtZSA6IHN0ciwgb3B0aW9uYWxcbiAgICAgICAgVGhlIG5hbWUgdG8gZGlzcGxheSBmb3IgdGhlIGFycmF5IGluIHRoZSBvdXRwdXQuIElmIGBgTm9uZWBgIChkZWZhdWx0KSxcbiAgICAgICAgdGhlIGZ1bmN0aW9uIGF0dGVtcHRzIHRvIGluZmVyIHRoZSB2YXJpYWJsZSBuYW1lIGZyb20gdGhlIGNhbGxlcidzIGxvY2FsXG4gICAgICAgIHZhcmlhYmxlcy4gSWYgaXQgY2Fubm90IGJlIGluZmVycmVkLCBkZWZhdWx0cyB0byBgYFwiYXJyYXlcImBgLlxuICAgIGVuZCA6IHN0ciwgb3B0aW9uYWxcbiAgICAgICAgU3RyaW5nIGFwcGVuZGVkIGFmdGVyIHRoZSBsYXN0IHZhbHVlIGluIGVhY2ggcm93LCBzaW1pbGFyIHRvIHRoZSBgZW5kYFxuICAgICAgICBwYXJhbWV0ZXIgaW4gUHl0aG9uJ3MgYnVpbHQtaW4gYGBwcmludGBgIGZ1bmN0aW9uLiBEZWZhdWx0IGlzIGBgTm9uZWBgLFxuICAgICAgICB3aGljaCBhZGRzIGEgbmV3bGluZS5cbiAgICBcIlwiXCJcbiAgICAjIGZpbmQgYXJyYXlfbmFtZVxuICAgIGlmIGFycmF5X25hbWUgaXMgTm9uZTpcbiAgICAgICAgZnJhbWUgPSBpbnNwZWN0LmN1cnJlbnRmcmFtZSgpLmZfYmFja1xuICAgICAgICBmb3IgbmFtZSwgdmFsdWUgaW4gZnJhbWUuZl9sb2NhbHMuaXRlbXMoKTpcbiAgICAgICAgICAgIGlmIHZhbHVlIGlzIGFycmF5OlxuICAgICAgICAgICAgICAgIGFycmF5X25hbWUgPSBuYW1lXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICBpZiBhcnJheV9uYW1lIGlzIE5vbmU6XG4gICAgICAgIGFycmF5X25hbWUgPSBcImFycmF5XCJcblxuICAgICMgZGV0ZXJtaW5lIHByZWNpc2lvblxuICAgIHByZWNpc2lvbiA9IDFcbiAgICB3aGlsZSBub3QgbnAuYWxsY2xvc2UoYXJyYXksIG5wLnJvdW5kKGFycmF5LCBwcmVjaXNpb24pKTpcbiAgICAgICAgcHJlY2lzaW9uID0gcHJlY2lzaW9uICsgMVxuICAgICAgICBpZiBwcmVjaXNpb24gPT0gMTY6XG4gICAgICAgICAgICBicmVha1xuICAgIGZvcm1hdF9zdHIgPSBmXCJ7ezp7cHJlY2lzaW9uICsgM30ue3ByZWNpc2lvbn1mfX1cIlxuXG4gICAgbiwgbSA9IGFycmF5LnNoYXBlXG5cbiAgICBmb3IgaSBpbiByYW5nZShuKTpcbiAgICAgICAgaWYgaSA9PSAwOlxuICAgICAgICAgICAgcHJpbnQoZlwie2FycmF5X25hbWV9ID0gWyBcIiwgZW5kPVwiXCIpXG4gICAgICAgIGVsc2U6XG4gICAgICAgICAgICBwcmludChcIiBcIiAqIGxlbihhcnJheV9uYW1lKSArIFwiICAgWyBcIiwgZW5kPVwiXCIpXG5cbiAgICAgICAgcHJpbnQoXCIsIFwiLmpvaW4oW2Zvcm1hdF9zdHIuZm9ybWF0KHYpIGZvciB2IGluIGFycmF5W2ldXSksIGVuZD1cIiBdXCIpXG4gICAgICAgIHByaW50KGVuZD1lbmQpXG4ifQ==
</script>
</div>
<div>
<div id="pyodide-2" class="exercise-cell">

</div>
<script type="pyodide-2-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5BID0gbnAuYXJyYXkoW1syLjAsIDMuMF0sIFstMy4wLCAyLjBdXSlcblxucHJpbnRfYXJyYXkoQSlcbnByaW50KHN5c3RlbV9zaXplKEEpKSJ9
</script>
</div>
</section>
<section id="row-swap" class="slide level3">
<h3>Row swap</h3>
<div>
<div id="pyodide-3" class="exercise-cell">

</div>
<script type="pyodide-3-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19zd2FwKEEsIGIsIHAsIHEpOlxuICAgIFwiXCJcIlxuICAgIFN3YXAgdHdvIHJvd3MgKHAgYW5kIHEpIGluIGEgbGluZWFyIHN5c3RlbSBvZiBlcXVhdGlvbnMgaW4gcGxhY2UuXG4gICAgXCJcIlwiXG4gICAgLi4uIn0=
</script>
</div>
</section>
<section id="row-scaling" class="slide level3">
<h3>Row scaling</h3>
<div>
<div id="pyodide-4" class="exercise-cell">

</div>
<script type="pyodide-4-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19zY2FsZShBLCBiLCBwLCBrKTpcbiAgICBcIlwiXCJcbiAgICBTY2FsZSBhIHJvdyAocCkgb2YgYSBsaW5lYXIgc3lzdGVtIGJ5IGEgY29uc3RhbnQgZmFjdG9yIChrKSBpbiBwbGFjZS5cbiAgICBcIlwiXCJcbiAgICAuLi4ifQ==
</script>
</div>
</section>
<section id="row-adding" class="slide level3">
<h3>Row adding</h3>
<div>
<div id="pyodide-5" class="exercise-cell">

</div>
<script type="pyodide-5-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19hZGQoQSwgYiwgcCwgaywgcSk6XG4gICAgXCJcIlwiXG4gICAgUGVyZm9ybSBhbiBpbi1wbGFjZSByb3cgYWRkaXRpb24gb3BlcmF0aW9uIG9uIGEgbGluZWFyIHN5c3RlbS5cbiAgICByb3dfcCDihpAgcm93X3AgKyBrICogcm93X3FcbiAgICBcIlwiXCIifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="kw">def</span> row_swap(A, b, p, q):</span>
<span id="cb1-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb1-3"><a href=""></a><span class="co">    Swap two rows in a linear system of equations in place.</span></span>
<span id="cb1-4"><a href=""></a></span>
<span id="cb1-5"><a href=""></a><span class="co">    This function swaps the rows `p` and `q` of the coefficient matrix `A`</span></span>
<span id="cb1-6"><a href=""></a><span class="co">    and the right-hand side vector `b` for a linear system of equations</span></span>
<span id="cb1-7"><a href=""></a><span class="co">    of the form ``Ax = b``. The operation is performed **in place**, modifying</span></span>
<span id="cb1-8"><a href=""></a><span class="co">    the input arrays directly.</span></span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb1-11"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb1-12"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb1-13"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb1-14"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb1-15"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb1-16"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb1-17"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb1-18"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb1-19"><a href=""></a><span class="co">        The index of the first row to swap. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb1-20"><a href=""></a><span class="co">    q : int</span></span>
<span id="cb1-21"><a href=""></a><span class="co">        The index of the second row to swap. Must satisfy ``0 &lt;= q &lt; n``.</span></span>
<span id="cb1-22"><a href=""></a></span>
<span id="cb1-23"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb1-24"><a href=""></a><span class="co">    -------</span></span>
<span id="cb1-25"><a href=""></a><span class="co">    None</span></span>
<span id="cb1-26"><a href=""></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb1-27"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb1-28"><a href=""></a><span class="co">    """</span></span>
<span id="cb1-29"><a href=""></a>    <span class="co"># get system size</span></span>
<span id="cb1-30"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb1-31"><a href=""></a>    <span class="co"># swap rows of A</span></span>
<span id="cb1-32"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-33"><a href=""></a>        A[p, j], A[q, j] <span class="op">=</span> A[q, j], A[p, j]</span>
<span id="cb1-34"><a href=""></a>    <span class="co"># swap rows of b</span></span>
<span id="cb1-35"><a href=""></a>    b[p, <span class="dv">0</span>], b[q, <span class="dv">0</span>] <span class="op">=</span> b[q, <span class="dv">0</span>], b[p, <span class="dv">0</span>]</span>
<span id="cb1-36"><a href=""></a></span>
<span id="cb1-37"><a href=""></a></span>
<span id="cb1-38"><a href=""></a><span class="kw">def</span> row_scale(A, b, p, k):</span>
<span id="cb1-39"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb1-40"><a href=""></a><span class="co">    Scale a row of a linear system by a constant factor in place.</span></span>
<span id="cb1-41"><a href=""></a></span>
<span id="cb1-42"><a href=""></a><span class="co">    This function multiplies all entries in row `p` of the coefficient matrix</span></span>
<span id="cb1-43"><a href=""></a><span class="co">    `A` and the corresponding entry in the right-hand side vector `b` by a</span></span>
<span id="cb1-44"><a href=""></a><span class="co">    scalar `k`. The operation is performed **in place**, modifying the input</span></span>
<span id="cb1-45"><a href=""></a><span class="co">    arrays directly.</span></span>
<span id="cb1-46"><a href=""></a></span>
<span id="cb1-47"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb1-48"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb1-49"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb1-50"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb1-51"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb1-52"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb1-53"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb1-54"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb1-55"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb1-56"><a href=""></a><span class="co">        The index of the row to scale. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb1-57"><a href=""></a><span class="co">    k : float</span></span>
<span id="cb1-58"><a href=""></a><span class="co">        The scalar multiplier applied to the entire row.</span></span>
<span id="cb1-59"><a href=""></a></span>
<span id="cb1-60"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb1-61"><a href=""></a><span class="co">    -------</span></span>
<span id="cb1-62"><a href=""></a><span class="co">    None</span></span>
<span id="cb1-63"><a href=""></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb1-64"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb1-65"><a href=""></a><span class="co">    """</span></span>
<span id="cb1-66"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb1-67"><a href=""></a></span>
<span id="cb1-68"><a href=""></a>    <span class="co"># scale row p of A</span></span>
<span id="cb1-69"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-70"><a href=""></a>        A[p, j] <span class="op">=</span> k <span class="op">*</span> A[p, j]</span>
<span id="cb1-71"><a href=""></a>    <span class="co"># scale row p of b</span></span>
<span id="cb1-72"><a href=""></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">*</span> k</span>
<span id="cb1-73"><a href=""></a></span>
<span id="cb1-74"><a href=""></a></span>
<span id="cb1-75"><a href=""></a><span class="kw">def</span> row_add(A, b, p, k, q):</span>
<span id="cb1-76"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb1-77"><a href=""></a><span class="co">    Perform an in-place row addition operation on a linear system.</span></span>
<span id="cb1-78"><a href=""></a></span>
<span id="cb1-79"><a href=""></a><span class="co">    This function applies the elementary row operation:</span></span>
<span id="cb1-80"><a href=""></a></span>
<span id="cb1-81"><a href=""></a><span class="co">    ``row_p ← row_p + k * row_q``</span></span>
<span id="cb1-82"><a href=""></a></span>
<span id="cb1-83"><a href=""></a><span class="co">    where `row_p` and `row_q` are rows in the coefficient matrix `A` and the</span></span>
<span id="cb1-84"><a href=""></a><span class="co">    right-hand side vector `b`. It updates the entries of `A` and `b`</span></span>
<span id="cb1-85"><a href=""></a><span class="co">    **in place**, directly modifying the original data.</span></span>
<span id="cb1-86"><a href=""></a></span>
<span id="cb1-87"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb1-88"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb1-89"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb1-90"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb1-91"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb1-92"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb1-93"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb1-94"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb1-95"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb1-96"><a href=""></a><span class="co">        The index of the row to be updated (destination row). Must satisfy</span></span>
<span id="cb1-97"><a href=""></a><span class="co">        ``0 &lt;= p &lt; n``.</span></span>
<span id="cb1-98"><a href=""></a><span class="co">    k : float</span></span>
<span id="cb1-99"><a href=""></a><span class="co">        The scalar multiplier applied to `row_q` before adding it to `row_p`.</span></span>
<span id="cb1-100"><a href=""></a><span class="co">    q : int</span></span>
<span id="cb1-101"><a href=""></a><span class="co">        The index of the source row to be scaled and added. Must satisfy</span></span>
<span id="cb1-102"><a href=""></a><span class="co">        ``0 &lt;= q &lt; n``.</span></span>
<span id="cb1-103"><a href=""></a><span class="co">    """</span></span>
<span id="cb1-104"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb1-105"><a href=""></a></span>
<span id="cb1-106"><a href=""></a>    <span class="co"># Perform the row operation</span></span>
<span id="cb1-107"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-108"><a href=""></a>        A[p, j] <span class="op">=</span> A[p, j] <span class="op">+</span> k <span class="op">*</span> A[q, j]</span>
<span id="cb1-109"><a href=""></a></span>
<span id="cb1-110"><a href=""></a>    <span class="co"># Update the corresponding value in b</span></span>
<span id="cb1-111"><a href=""></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">+</span> k <span class="op">*</span> b[q, <span class="dv">0</span>]</span>
<span id="cb1-112"><a href=""></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="row-swap-test" class="slide level3">
<h3>Row swap test</h3>
<div>
<div id="pyodide-6" class="exercise-cell">

</div>
<script type="pyodide-6-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwic3dhcHBpbmcgcm93cyAwIGFuZCAxXCIpXG5yb3dfc3dhcChBLCBiLCAwLCAxKSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRpbmcgZnJvbSB6ZXJvIVxucHJpbnQoKVxuXG5wcmludChcIm5ldyBhcnJheXM6XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KCkifQ==
</script>
</div>
</section>
<section id="row-scale-test" class="slide level3">
<h3>Row scale test</h3>
<div>
<div id="pyodide-7" class="exercise-cell">

</div>
<script type="pyodide-7-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicm93IDAgfC0+IDAuNSAqIHJvdyAwXCIpXG5yb3dfc2NhbGUoQSwgYiwgMCwgMC41KSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRlZCBmcm9tIHplcm8hXG5wcmludCgpXG5cbnByaW50KFwibmV3IGFycmF5czpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKSJ9
</script>
</div>
</section>
<section id="row-adding-test" class="slide level3">
<h3>Row adding test</h3>
<div>
<div id="pyodide-8" class="exercise-cell">

</div>
<script type="pyodide-8-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicm93IDEgfC0+IHJvdyAxICsgMS41ICogcm93IDBcIilcbnJvd19hZGQoQSwgYiwgMSwgMS41LCAwKSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRlZCBmcm9tIHplcm8hXG5wcmludCgpXG5cbnByaW50KFwibmV3IGFycmF5czpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKVxuIn0=
</script>
</div>
</section>
<section id="gaussian-elimination-definition" class="slide level3">
<h3>Gaussian elimination definition</h3>
<p>Now we can define our Gaussian elimination function. We update the values in-place to avoid extra memory allocations.</p>
<div>
<div id="pyodide-9" class="exercise-cell">

</div>
<script type="pyodide-9-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGdhdXNzaWFuX2VsaW1pbmF0aW9uKEEsIGIsIHZlcmJvc2U9RmFsc2UpOlxuICAgIFwiXCJcIlxuICAgIFBlcmZvcm0gR2F1c3NpYW4gZWxpbWluYXRpb24gdG8gcmVkdWNlIGEgbGluZWFyIHN5c3RlbSB0byB1cHBlciB0cmlhbmd1bGFyXG4gICAgZm9ybS5cbiAgICBcIlwiXCJcbiAgICAuLi4ifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="kw">def</span> gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb2-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href=""></a><span class="co">    Perform Gaussian elimination to reduce a linear system to upper triangular</span></span>
<span id="cb2-4"><a href=""></a><span class="co">    form.</span></span>
<span id="cb2-5"><a href=""></a></span>
<span id="cb2-6"><a href=""></a><span class="co">    This function performs **forward elimination** to transform the coefficient</span></span>
<span id="cb2-7"><a href=""></a><span class="co">    matrix `A` into an upper triangular matrix, while applying the same</span></span>
<span id="cb2-8"><a href=""></a><span class="co">    operations to the right-hand side vector `b`. This is the first step in</span></span>
<span id="cb2-9"><a href=""></a><span class="co">    solving a linear system of equations of the form ``Ax = b`` using Gaussian</span></span>
<span id="cb2-10"><a href=""></a><span class="co">    elimination.</span></span>
<span id="cb2-11"><a href=""></a></span>
<span id="cb2-12"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb2-13"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb2-14"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb2-15"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb2-16"><a href=""></a><span class="co">        of the system.</span></span>
<span id="cb2-17"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb2-18"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb2-19"><a href=""></a><span class="co">        vector.</span></span>
<span id="cb2-20"><a href=""></a><span class="co">    verbose : bool, optional</span></span>
<span id="cb2-21"><a href=""></a><span class="co">        If ``True``, prints detailed information about each elimination step,</span></span>
<span id="cb2-22"><a href=""></a><span class="co">        including the row operations performed and the intermediate forms of</span></span>
<span id="cb2-23"><a href=""></a><span class="co">        `A` and `b`. Default is ``False``.</span></span>
<span id="cb2-24"><a href=""></a></span>
<span id="cb2-25"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb2-26"><a href=""></a><span class="co">    -------</span></span>
<span id="cb2-27"><a href=""></a><span class="co">    None</span></span>
<span id="cb2-28"><a href=""></a><span class="co">        This function modifies `A` and `b` **in place** and does not return</span></span>
<span id="cb2-29"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb2-30"><a href=""></a><span class="co">    """</span></span>
<span id="cb2-31"><a href=""></a>    <span class="co"># find shape of system</span></span>
<span id="cb2-32"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb2-33"><a href=""></a></span>
<span id="cb2-34"><a href=""></a>    <span class="co"># perform forwards elimination</span></span>
<span id="cb2-35"><a href=""></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb2-36"><a href=""></a>        <span class="co"># eliminate column i</span></span>
<span id="cb2-37"><a href=""></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-38"><a href=""></a>            <span class="bu">print</span>(<span class="ss">f"eliminating column </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-39"><a href=""></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb2-40"><a href=""></a>            <span class="co"># row j</span></span>
<span id="cb2-41"><a href=""></a>            factor <span class="op">=</span> A[j, i] <span class="op">/</span> A[i, i]</span>
<span id="cb2-42"><a href=""></a>            <span class="cf">if</span> verbose:</span>
<span id="cb2-43"><a href=""></a>                <span class="bu">print</span>(<span class="ss">f"  row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> |-&gt; row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss"> * row </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-44"><a href=""></a>            row_add(A, b, j, <span class="op">-</span>factor, i)</span>
<span id="cb2-45"><a href=""></a></span>
<span id="cb2-46"><a href=""></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-47"><a href=""></a>            <span class="bu">print</span>()</span>
<span id="cb2-48"><a href=""></a>            <span class="bu">print</span>(<span class="st">"new system"</span>)</span>
<span id="cb2-49"><a href=""></a>            print_array(A)</span>
<span id="cb2-50"><a href=""></a>            print_array(b)</span>
<span id="cb2-51"><a href=""></a>            <span class="bu">print</span>()</span>
<span id="cb2-52"><a href=""></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p>We can try our code on Example 1:</p>
<div>
<div id="pyodide-10" class="exercise-cell">

</div>
<script type="pyodide-10-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIEVsaW1pbmF0aW9uXCIpXG5nYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiLCB2ZXJib3NlPVRydWUpXG5wcmludCgpXG5cbnByaW50KFwiZmluYWwgc3lzdGVtOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbiMgdGVzdCB0aGF0IEEgaXMgcmVhbGx5IHVwcGVyIHRyaWFuZ3VsYXJcbnByaW50KFwiSXMgQSByZWFsbHkgdXBwZXIgdHJpYW5ndWxhcj9cIiwgbnAuYWxsY2xvc2UoQSwgbnAudHJpdShBKSkpXG4ifQ==
</script>
</div>
</section>

<section id="solving-triangular-systems-of-equations" class="title-slide slide level2 center">
<h2>Solving triangular systems of equations</h2>
<p>A general <em>lower triangular</em> system of equations has <span class="math inline">\(a_{ij} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span> and takes the form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; \cdots &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
<p>Note that first equation is</p>
<p><span class="math display">\[
a_{11} x_1 = b_1.
\]</span></p>
<p>Then <span class="math inline">\(x_i\)</span> can be found by calculating</p>
<p><span class="math display">\[
x_i = \frac{1}{a_{ii}} \left(b_i - \sum_{j=1}^{i-1} a_{ij} x_j \right)
\]</span></p>
<p>for each row <span class="math inline">\(i = 1, 2, \ldots, n\)</span> in turn.</p>
<ul>
<li>Each calculation requires only previously computed values <span class="math inline">\(x_j\)</span> (and the sum gives a loop for <span class="math inline">\(j &lt; i\)</span>.</li>
<li>The matrix <span class="math inline">\(A\)</span> <strong>must</strong> have non-zero diagonal entries<br>
i.e.&nbsp;<span class="math inline">\(a_{ii} \neq 0\)</span> for <span class="math inline">\(i = 1, 2, \ldots, n\)</span>.</li>
<li><strong>Upper triangular</strong> systems of equations can be solved in similarly.</li>
</ul>
<div id="exm-fs" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> Solve the lower triangular system of equations given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;&amp; &amp;&amp; &amp;= 2 \\
x_1 &amp;+&amp; 2 x_2 &amp;&amp; &amp;= 7 \\
2 x_1 &amp;+&amp; 4 x_2 &amp;+&amp; 6 x_3 &amp;= 26
\end{aligned}
\]</span></p>
<p>or, equivalently,</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 0 &amp; 0 \\
1 &amp; 2 &amp; 0 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7 \\ 26
\end{pmatrix}.
\]</span></p>
<p>The solution can be calculated systematically from</p>
<p><span class="math display">\[
\begin{aligned}
x_1 &amp;= \frac{b_1}{a_{11}} = \frac{2}{2} = 1 \\
x_2 &amp;= \frac{b_2 - a_{21} x_1}{a_{22}}
= \frac{7 - 1 \times 1}{2} = \frac{6}{2} = 3 \\
x_3 &amp;= \frac{b_3 - a_{31} x_1 - a_{32} x_2}{a_33}
= \frac{26 - 2 \times 1 - 4 \times 3}{6}  = \frac{12}{6}
= 2
\end{aligned}
\]</span></p>
<p>which gives the solution <span class="math inline">\(\vec{x} = (1, 3, 2)^T\)</span>.</p>
</div>
<div id="exr-fs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Solve the upper triangular linear system given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;+&amp; x_2 &amp;+&amp; 4 x_3 &amp;=&amp; 12 \\
&amp;&amp; 1.5 x_2 &amp;&amp; &amp;=&amp; 3 \\
&amp;&amp; &amp;&amp; 2 x_3 &amp;=&amp; 4
\end{aligned}.
\]</span></p>
</div>
<div id="rem-triangular" class="proof remark">
<p><span class="proof-title"><em>Remark 1</em>. </span></p>
<ul>
<li><p>It is simple to solve a lower (upper) triangular system of equations (provided the diagonal is non-zero).</p></li>
<li><p>This process is often referred to as <strong>forward</strong> (<strong>backwards</strong>) <strong>substitution</strong>.</p></li>
<li><p>A general system of equations (i.e.&nbsp;a full matrix <span class="math inline">\(A\)</span>) can be solved rapidly once it has been reduced to upper triangular form. The entire process is called Gaussian elimination with backward substitution.</p></li>
</ul>
</div>
<p>We can define functions to solve both upper and lower triangular form systems of linear equations:</p>
<div>
<div id="pyodide-11" class="exercise-cell">

</div>
<script type="pyodide-11-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGZvcndhcmRfc3Vic3RpdHV0aW9uKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFNvbHZlIGEgbG93ZXIgdHJpYW5ndWxhciBzeXN0ZW0gb2YgbGluZWFyIGVxdWF0aW9ucyB1c2luZyBmb3J3YXJkXG4gICAgc3Vic3RpdHV0aW9uLlxuXG4gICAgVGhpcyBmdW5jdGlvbiBzb2x2ZXMgdGhlIHN5c3RlbSBvZiBlcXVhdGlvbnM6XG5cbiAgICAuLiBtYXRoOjpcbiAgICAgICAgQSB4ID0gYlxuXG4gICAgd2hlcmUgYEFgIGlzIGEgKipsb3dlciB0cmlhbmd1bGFyIG1hdHJpeCoqIChhbGwgZWxlbWVudHMgYWJvdmUgdGhlIG1haW5cbiAgICBkaWFnb25hbCBhcmUgemVybykuIFRoZSBzb2x1dGlvbiB2ZWN0b3IgYHhgIGlzIGNvbXB1dGVkIHNlcXVlbnRpYWxseSBieVxuICAgIHNvbHZpbmcgZWFjaCBlcXVhdGlvbiBzdGFydGluZyBmcm9tIHRoZSBmaXJzdCByb3cuXG5cbiAgICBQYXJhbWV0ZXJzXG4gICAgLS0tLS0tLS0tLVxuICAgIEEgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMkQgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwgbilgYCByZXByZXNlbnRpbmcgdGhlIGxvd2VyIHRyaWFuZ3VsYXJcbiAgICAgICAgY29lZmZpY2llbnQgbWF0cml4IG9mIHRoZSBzeXN0ZW0uXG4gICAgYiA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAxRCBOdW1QeSBhcnJheSBvZiBzaGFwZSBgYChuLClgYCBvciBhIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlXG4gICAgICAgIGBgKG4sIDEpYGAgcmVwcmVzZW50aW5nIHRoZSByaWdodC1oYW5kIHNpZGUgdmVjdG9yLlxuXG4gICAgUmV0dXJuc1xuICAgIC0tLS0tLS1cbiAgICB4IDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sKWBgIGNvbnRhaW5pbmcgdGhlIHNvbHV0aW9uIHZlY3Rvci5cbiAgICBcIlwiXCJcbiAgICBcIlwiXCJcbiAgICBzb2x2ZXMgdGhlIHN5c3RlbSBvZiBsaW5lYXIgZXF1YXRpb25hIEF4ID0gYiBhc3N1bWluZyB0aGF0IEEgaXMgbG93ZXJcbiAgICB0cmlhbmd1bGFyLiByZXR1cm5zIHRoZSBzb2x1dGlvbiB4XG4gICAgXCJcIlwiXG4gICAgIyBnZXQgc2l6ZSBvZiBzeXN0ZW1cbiAgICBuID0gc3lzdGVtX3NpemUoQSwgYilcblxuICAgICMgY2hlY2sgaXMgbG93ZXIgdHJpYW5ndWxhclxuICAgIGlmIG5vdCBucC5hbGxjbG9zZShBLCBucC50cmlsKEEpKTpcbiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihcIk1hdHJpeCBBIGlzIG5vdCBsb3dlciB0cmlhbmd1bGFyXCIpXG5cbiAgICAjIGNyZWF0ZSBzb2x1dGlvbiB2YXJpYWJsZVxuICAgIHggPSBucC5lbXB0eV9saWtlKGIpXG5cbiAgICAjIHBlcmZvcm0gZm9yd2FyZHMgc29sdmVcbiAgICBmb3IgaSBpbiByYW5nZShuKTpcbiAgICAgICAgcGFydGlhbF9zdW0gPSAwLjBcbiAgICAgICAgZm9yIGogaW4gcmFuZ2UoMCwgaSk6XG4gICAgICAgICAgICBwYXJ0aWFsX3N1bSArPSBBW2ksIGpdICogeFtqXVxuICAgICAgICB4W2ldID0gMS4wIC8gQVtpLCBpXSAqIChiW2ldIC0gcGFydGlhbF9zdW0pXG5cbiAgICByZXR1cm4geFxuXG5cbmRlZiBiYWNrd2FyZF9zdWJzdGl0dXRpb24oQSwgYik6XG4gICAgXCJcIlwiXG4gICAgU29sdmUgYW4gdXBwZXIgdHJpYW5ndWxhciBzeXN0ZW0gb2YgbGluZWFyIGVxdWF0aW9ucyB1c2luZyBiYWNrd2FyZFxuICAgIHN1YnN0aXR1dGlvbi5cblxuICAgIFRoaXMgZnVuY3Rpb24gc29sdmVzIHRoZSBzeXN0ZW0gb2YgZXF1YXRpb25zOlxuXG4gICAgLi4gbWF0aDo6XG4gICAgICAgIEEgeCA9IGJcblxuICAgIHdoZXJlIGBBYCBpcyBhbiAqKnVwcGVyIHRyaWFuZ3VsYXIgbWF0cml4KiogKGFsbCBlbGVtZW50cyBiZWxvdyB0aGUgbWFpblxuICAgIGRpYWdvbmFsIGFyZSB6ZXJvKS4gVGhlIHNvbHV0aW9uIHZlY3RvciBgeGAgaXMgY29tcHV0ZWQgc3RhcnRpbmcgZnJvbSB0aGVcbiAgICBsYXN0IGVxdWF0aW9uIGFuZCBwcm9jZWVkaW5nIGJhY2t3YXJkLlxuXG4gICAgUGFyYW1ldGVyc1xuICAgIC0tLS0tLS0tLS1cbiAgICBBIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIG4pYGAgcmVwcmVzZW50aW5nIHRoZSB1cHBlciB0cmlhbmd1bGFyXG4gICAgICAgIGNvZWZmaWNpZW50IG1hdHJpeCBvZiB0aGUgc3lzdGVtLlxuICAgIGIgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMUQgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwpYGAgb3IgYSAyRCBOdW1QeSBhcnJheSBvZiBzaGFwZVxuICAgICAgICBgYChuLCAxKWBgIHJlcHJlc2VudGluZyB0aGUgcmlnaHQtaGFuZCBzaWRlIHZlY3Rvci5cblxuICAgIFJldHVybnNcbiAgICAtLS0tLS0tXG4gICAgeCA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSBOdW1QeSBhcnJheSBvZiBzaGFwZSBgYChuLClgYCBjb250YWluaW5nIHRoZSBzb2x1dGlvbiB2ZWN0b3IuXG4gICAgXCJcIlwiXG4gICAgIyBnZXQgc2l6ZSBvZiBzeXN0ZW1cbiAgICBuID0gc3lzdGVtX3NpemUoQSwgYilcblxuICAgICMgY2hlY2sgaXMgdXBwZXIgdHJpYW5ndWxhclxuICAgIGFzc2VydCBucC5hbGxjbG9zZShBLCBucC50cml1KEEpKVxuXG4gICAgIyBjcmVhdGUgc29sdXRpb24gdmFyaWFibGVcbiAgICB4ID0gbnAuZW1wdHlfbGlrZShiKVxuXG4gICAgIyBwZXJmb3JtIGJhY2t3YXJkcyBzb2x2ZVxuICAgIGZvciBpIGluIHJhbmdlKG4gLSAxLCAtMSwgLTEpOiAgIyBpdGVyYXRlIG92ZXIgcm93cyBiYWNrd2FyZHNcbiAgICAgICAgcGFydGlhbF9zdW0gPSAwLjBcbiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSArIDEsIG4pOlxuICAgICAgICAgICAgcGFydGlhbF9zdW0gKz0gQVtpLCBqXSAqIHhbal1cbiAgICAgICAgeFtpXSA9IDEuMCAvIEFbaSwgaV0gKiAoYltpXSAtIHBhcnRpYWxfc3VtKVxuXG4gICAgcmV0dXJuIHhcbiJ9
</script>
</div>
<p>And we can then test it out!</p>
<div>
<div id="pyodide-12" class="exercise-cell">

</div>
<script type="pyodide-12-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAwLjAsIDAuMF0sIFsxLjAsIDIuMCwgMC4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzIuMF0sIFs3LjBdLCBbMjYuMF1dKVxuXG5wcmludChcIlRoZSBzeXN0ZW0gaXMgZ2l2ZW4gYnk6XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJTb2x2aW5nIHRoZSBzeXN0ZW0gdXNpbmcgZm9yd2FyZCBzdWJzdGl0dXRpb25cIilcbnggPSBmb3J3YXJkX3N1YnN0aXR1dGlvbihBLCBiKVxucHJpbnQoKVxuXG5wcmludChcIlRoZSBzb2x1dGlvbiB1c2luZyBmb3J3YXJkIHN1YnN0aXR1dGlvbiBpczpcIilcbnByaW50X2FycmF5KHgpXG5wcmludCgpXG5cbnByaW50KFwiRG9lcyB4IHJlYWxseSBzb2x2ZSB0aGUgc3lzdGVtP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpIn0=
</script>
</div>
<p>We can also do a backward substitution test:</p>
<div>
<div id="pyodide-13" class="exercise-cell">

</div>
<script type="pyodide-13-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFswLjAsIDEuNSwgMC4wXSwgWzAuMCwgMC4wLCAyLjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbMy4wXSwgWzQuMF1dKVxuXG5wcmludChcIlRoZSBzeXN0ZW0gaXMgZ2l2ZW4gYnk6XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJTb2x2aW5nIHRoZSBzeXN0ZW0gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uXCIpXG54ID0gYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpXG5wcmludCgpXG5cbnByaW50KFwiVGhlIHNvbHV0aW9uIHVzaW5nIGJhY2t3YXJkIHN1YnN0aXR1dGlvbiBpczpcIilcbnByaW50X2FycmF5KHgpXG5wcmludCgpXG5cbnByaW50KFwiRG9lcyB4IHJlYWxseSBzb2x2ZSB0aGUgc3lzdGVtP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpIn0=
</script>
</div>
</section>

<section id="combining-gaussian-elimination-and-backward-substitution" class="title-slide slide level2 center">
<h2>Combining Gaussian elimination and backward substitution</h2>
<p>Our grand strategy can now come together so we have a method to solve systems of linear equations:</p>
<p>Given a system of linear equations <span class="math inline">\(A\vec{x} = \vec{b}\)</span>;</p>
<ul>
<li>First perform Gaussian elimination to give an equivalent system of equations in upper triangular form;</li>
<li>Then use backward substitution to produce a solution <span class="math inline">\(\vec{x}\)</span></li>
</ul>
<p>We can use our code to test this:</p>
<div>
<div id="pyodide-14" class="exercise-cell">

</div>
<script type="pyodide-14-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIEVsaW1pbmF0aW9uXCIpXG5nYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiLCB2ZXJib3NlPVRydWUpXG5wcmludCgpXG5cbnByaW50KFwidXBwZXIgdHJpYW5ndWxhciBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJTb2x2aW5nIHRoZSBzeXN0ZW0gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uXCIpXG54ID0gYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpXG5wcmludCgpXG5cbnByaW50KFwic29sdXRpb24gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uOlwiKVxucHJpbnRfYXJyYXkoeClcbnByaW50KClcblxuQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcbnByaW50KFwiRG9lcyB4IHJlYWxseSBzb2x2ZSB0aGUgb3JpZ2luYWwgc3lzdGVtP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpIn0=
</script>
</div>
<div id="exr-ge2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Use Gaussian elimination followed by backwards elimination to solve the system: <span class="math display">\[\begin{equation*}
\begin{pmatrix}
2 &amp; 1 &amp; -1 \\
4 &amp; 5 &amp; 7 \\
-8 &amp; -3 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
6 \\ 30 \\ -22
\end{pmatrix}.
\end{equation*}\]</span>. $$</p>
</div>
</section>

<section id="the-cost-of-gaussian-elimination" class="title-slide slide level2 center">
<h2>The cost of Gaussian Elimination</h2>
<p>Gaussian elimination (GE) is unnecessarily expensive when it is applied to many systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right-hand sides <span class="math inline">\(\vec{b}\)</span>.</p>
<ul>
<li>The forward elimination process is the most computationally expensive part at <span class="math inline">\(O(n^3)\)</span> but is exactly the same for any choice of <span class="math inline">\(\vec{b}\)</span>.</li>
<li>In contrast, the solution of the resulting upper triangular system only requires <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
<div>
<div id="pyodide-15" class="exercise-cell">

</div>
<script type="pyodide-15-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiIyB8IGVjaG86IGZhbHNlXG5cbnNpemVzID0gWzIqKmogZm9yIGogaW4gcmFuZ2UoMSwgMTApXVxudGltZXNfR0UsIHRpbWVzX0JTID0gW10sIFtdXG5cbmZvciBuIGluIHNpemVzOlxuICAgIEFfcGFydCA9IG5wLnJhbmRvbS5yYW5kKG4sIG4pXG4gICAgQSA9IG5wLmRvdChBX3BhcnQsIEFfcGFydC5UKVxuICAgIGIgPSBucC5yYW5kb20ucmFuZChuLCAxKVxuXG4gICAgIyBwZXJmb3JtIEdhdXNzaWFuIGVsaW1pbmF0aW9uXG4gICAgc3RhcnRfdGltZSA9IHRpbWUucGVyZl9jb3VudGVyKClcbiAgICBnYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiKVxuICAgIGVuZF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKVxuICAgIHRpbWVzX0dFLmFwcGVuZChlbmRfdGltZSAtIHN0YXJ0X3RpbWUpXG5cbiAgICAjIHBlcmZvcm0gYmFja3dhcmQgc3Vic2l0dXRpb25cbiAgICBzdGFydF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKVxuICAgIGJhY2t3YXJkX3N1YnN0aXR1dGlvbihBLCBiKVxuICAgIGVuZF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKVxuICAgIHRpbWVzX0JTLmFwcGVuZChlbmRfdGltZSAtIHN0YXJ0X3RpbWUpIn0=
</script>
</div>
<div>
<div id="pyodide-16" class="exercise-cell">

</div>
<script type="pyodide-16-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiIyB8IGVjaG86IGZhbHNlXG4jIHwgZmlnLWNhcDogXCJSdW50aW1lIGNvc3Qgb2YgYXBwbHlpbmcgR2F1c3NpYW4gZWxpbWluYXRpb24gKEdFKSBhbmQgYmFja3dhcmRzXG4jIHwgc29sdXRpb24gKEJTKS5cIlxuXG5wbHQubG9nbG9nKHNpemVzLCB0aW1lc19HRSwgXCJDMG9cIiwgbGFiZWw9XCJHRVwiKVxucGx0LmxvZ2xvZyhzaXplcywgdGltZXNfQlMsIFwiQzFvXCIsIGxhYmVsPVwiQlNcIilcblxuY29lZmZpY2llbnRzX0dFID0gbnAucG9seWZpdChzaXplcywgdGltZXNfR0UsIDMpXG5jb2VmZmljaWVudHNfQlMgPSBucC5wb2x5Zml0KHNpemVzLCB0aW1lc19CUywgMilcbnBvbHlub21pYWxfR0UgPSBucC5wb2x5MWQoW2NvZWZmaWNpZW50c19HRVswXSwgMCwgMCwgMF0pXG5wb2x5bm9taWFsX0JTID0gbnAucG9seTFkKFtjb2VmZmljaWVudHNfQlNbMF0sIDAsIDBdKVxuXG4jIEdlbmVyYXRlIHggdmFsdWVzIGZvciBwbG90dGluZyB0aGUgcG9seW5vbWlhbCBsaW5lXG5HRV9wb2x5ID0gcG9seW5vbWlhbF9HRShucC5hcnJheShzaXplcywgZHR5cGU9bnAuZG91YmxlKSlcbnBsdC5sb2dsb2coc2l6ZXMsIEdFX3BvbHksIFwiQzAtLVwiLCBsYWJlbD1cIiRPKG5eMykkXCIpXG5CU19wb2x5ID0gcG9seW5vbWlhbF9CUyhucC5hcnJheShzaXplcywgZHR5cGU9bnAuZG91YmxlKSlcbnBsdC5sb2dsb2coc2l6ZXMsIEJTX3BvbHksIFwiQzEtLVwiLCBsYWJlbD1cIiRPKG5eMikkXCIpXG5cbnBsdC54bGFiZWwoXCIkbiRcIilcbnBsdC55bGFiZWwoXCJ0aW1lIChzKVwiKVxuXG5wbHQubGVnZW5kKClcbnBsdC5ncmlkKFRydWUpXG5cbnBsdC5zaG93KClcbiJ9
</script>
</div>
<p>We can use this information to improve the way in which we solve multiple systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right-hand sides <span class="math inline">\(\vec{b}\)</span>.</p>
</section>

<section id="sec-LU-factorisation" class="title-slide slide level2 center">
<h2>LU factorisation</h2>
<p>Our next algorithm, called LU factorisation, is a way to try to speed up Gaussian elimination by reusing information. This can be used when we solve systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right hand sides <span class="math inline">\(\vec{b}\)</span> - this is more common than you would think!</p>
<p>Recall the elementary row operations (EROs) from above. Note that the EROs can be produced by left multiplication with a suitable matrix:</p>
<ul>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 0
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ g &amp; h &amp; i \\ d &amp; e &amp; f
\end{pmatrix}
\]</span></p></li>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c &amp; d \\ e &amp; f &amp; g &amp; h \\ i &amp; j &amp; k &amp; l \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c &amp; d \\ i &amp; j &amp; k &amp; l \\ e &amp; f &amp; g &amp; h \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
\]</span></p></li>
<li><p>Multiply row by <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
\alpha &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
\alpha a &amp; \alpha b &amp; \alpha c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
\]</span></p></li>
<li><p><span class="math inline">\(\alpha \times \text{row } p + \text{row } q\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ \alpha &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ \alpha a + g &amp; \alpha b + h &amp; \alpha c + i
\end{pmatrix}
\]</span></p></li>
</ul>
<p>Since Gaussian elimination (GE) is just a sequence of EROs and each ERO is just multiplication by a suitable matrix, say <span class="math inline">\(E_k\)</span>, forward elimination applied to the system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> can be expressed as <span class="math display">\[
(E_m \cdots E_1) A \vec{x} = (E_m \cdots E_1) \vec{b},
\]</span> here <span class="math inline">\(m\)</span> is the number of EROs required to reduce the upper triangular form.</p>
<p>Let <span class="math inline">\(U = (E_m \cdots E_1) A\)</span> and <span class="math inline">\(L = (E_m \cdots E_1)^{-1}\)</span>. Now the original system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> is equivalent to</p>
<p><span class="math display">\[\begin{equation}
\label{eq:LU}
L U \vec{x} = \vec{b}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(U\)</span> is <em>upper triangular</em> (by construction) and <span class="math inline">\(L\)</span> may be shown to be lower triangular (provided the EROs do not include any row swaps).</p>
<p>Once <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> are known it is easy to solve <span class="math inline">\(\eqref{eq:LU}\)</span></p>
<ul>
<li>Solve <span class="math inline">\(L \vec{z} = \vec{b}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
<li>Solve <span class="math inline">\(U \vec{x} = \vec{z}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
<p><span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> may be found in <span class="math inline">\(O(n^3)\)</span> operations by performing GE and saving the <span class="math inline">\(E_i\)</span> matrices: however, it is more convenient to find them directly (also <span class="math inline">\(O(n^3)\)</span> operations).</p>
</section>
<section id="computing-l-and-u" class="slide level3">
<h3>Computing <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span></h3>
<p>Consider a general <span class="math inline">\(4 \times 4\)</span> matrix <span class="math inline">\(A\)</span> and its factorisation <span class="math inline">\(LU\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; a_{34} \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
l_{21} &amp; 1 &amp; 0 &amp; 0 \\
l_{31} &amp; l_{32} &amp; 1 &amp; 0 \\
l_{41} &amp; l_{42} &amp; l_{43} &amp; 1
\end{pmatrix}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} &amp; u_{14} \\
0 &amp; u_{22} &amp; u_{23} &amp; u_{24} \\
0 &amp; 0 &amp; u_{33} &amp; u_{34} \\
0 &amp; 0 &amp; 0 &amp; u_{44}
\end{pmatrix}
\]</span></p>
<p>For the first column,</p>
<p><span class="math display">\[
\begin{aligned}
a_{11} &amp; = (1, 0, 0, 0) (u_{11}, 0, 0, 0)^T &amp;&amp; = u_{11}
&amp; \rightarrow u_{11} &amp; = a_{11} \\
a_{21} &amp; = (l_{21}, 1, 0, 0)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{21} u_{11}
&amp; \rightarrow l_{21} &amp; = a_{21} / u_{11} \\
a_{31} &amp; = (l_{31}, l_{32}, 1, 0)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{31} u_{11}
&amp; \rightarrow l_{31} &amp; = a_{31} / u_{11} \\
a_{41} &amp; = (l_{41}, l_{42}, l_{43}, 1)(u_{11}, 0, 0, 0)^T &amp;&amp; = l_{41} u_{11}
&amp; \rightarrow l_{41} &amp; = a_{41} / u_{11}
\end{aligned}
\]</span></p>
<p>The second, third and fourth columns follow in a similar manner, giving all the entries in <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span>.</p>
<div id="rem-how-to-LU" class="proof remark">
<p><span class="proof-title"><em>Remark 2</em>. </span></p>
<ul>
<li><p><span class="math inline">\(L\)</span> is assumed to have 1’s on the diagonal, to ensure that the factorisation is unique.</p></li>
<li><p>The process involves division by the diagonal entries <span class="math inline">\(u_{11}, u_{22}\)</span>, etc., so they <strong>must</strong> be non-zero.</p></li>
<li><p>In general the factors <span class="math inline">\(l_{ij}\)</span> and <span class="math inline">\(u_{ij}\)</span> are calculated for each column <span class="math inline">\(j\)</span> in turn, i.e.,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb3-2"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb3-3"><a href=""></a>      <span class="co"># Compute factors u_{ij}</span></span>
<span id="cb3-4"><a href=""></a>      ...</span>
<span id="cb3-5"><a href=""></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb3-6"><a href=""></a>      <span class="co"># Compute factors l_{ij}</span></span>
<span id="cb3-7"><a href=""></a>      ...</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul>
</div>
<div id="exm-lu" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> Use <span class="math inline">\(LU\)</span> factorisation to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}.
\]</span></p>
<p>This can be rewritten in the form <span class="math inline">\(A = LU\)</span> where</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
l_{21} &amp; 1 &amp; 0 \\
l_{31} &amp; l_{32} &amp; 1
\end{pmatrix}
\begin{pmatrix}
u_{11} &amp; u_{12} &amp; u_{13} \\
0 &amp; u_{22} &amp; u_{23} \\
0 &amp; 0 &amp; u_{33}
\end{pmatrix}.
\]</span></p>
<p>Column 1 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
2 &amp; = u_{11} &amp;&amp; \rightarrow &amp; u_{11} &amp; = 2 \\
1 &amp; = l_{21} u_{11} &amp;&amp; \rightarrow &amp; l_{21} &amp; = 0.5 \\
2 &amp; = l_{31} u_{11} &amp;&amp; \rightarrow &amp; l_{31} &amp; = 1.
\end{aligned}
\]</span></p>
<p>Column 2 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
1 &amp; = u_{12} &amp;&amp; \rightarrow &amp; u_{12} &amp; = 1 \\
2 &amp; = l_{21} u_{12} + u_{22} &amp;&amp; \rightarrow &amp; u_{22} &amp; = 1.5 \\
4 &amp; = l_{31} u_{12} + l_{32} u_{22} &amp;&amp; \rightarrow &amp; l_{32} &amp; = 2.
\end{aligned}
\]</span></p>
<p>Column 3 of <span class="math inline">\(A\)</span> gives</p>
<p><span class="math display">\[
\begin{aligned}
4 &amp; = u_{13} &amp;&amp; \rightarrow &amp; u_{13} &amp; = 4 \\
2 &amp; = l_{21} u_{13} + u_{23} &amp;&amp; \rightarrow &amp; u_{23} &amp; = 0 \\
6 &amp; = l_{31} u_{13} + l_{32} u_{23} + u_{33} &amp;&amp; \rightarrow &amp; u_{33} &amp; = 2.
\end{aligned}
\]</span></p>
<p>Solve the lower triangular system <span class="math inline">\(L \vec{z} = \vec{b}\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0.5 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 1
\end{pmatrix}
\begin{pmatrix}
z_1 \\ z_2 \\ z_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}
\rightarrow
\begin{pmatrix}
z_1 \\ z_2 \\ z_3
\end{pmatrix}
= \begin{pmatrix}
12 \\ 3 \\ 4
\end{pmatrix}
\]</span></p>
<p>Solve the upper triangular system <span class="math inline">\(U \vec{x} = \vec{z}\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
0 &amp; 1.5 &amp; 0 \\
0 &amp; 0 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
\begin{pmatrix}
12 \\ 3 \\ 4
\end{pmatrix}
\rightarrow
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
1 \\ 2 \\ 2
\end{pmatrix}.
\]</span></p>
</div>
<div id="exr-lu" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> Rewrite the matrix <span class="math inline">\(A\)</span> as the product of lower and upper triangular matrices where</p>
<p><span class="math display">\[
A =
\begin{pmatrix}
4 &amp; 2 &amp; 0 \\
2 &amp; 3 &amp; 1 \\
0 &amp; 1 &amp; 2.5
\end{pmatrix}.
\]</span></p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>The first example gives</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
1 &amp; 2 &amp; 2 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0.5 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 1
\end{pmatrix}
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\
0 &amp; 1.5 &amp; 0 \\
0 &amp; 0 &amp; 2
\end{pmatrix}
\]</span></p>
<p>Note that</p>
<ul>
<li><p>the matrix <span class="math inline">\(U\)</span> is the same as the fully eliminated upper triangular form produced by Gaussian elimination;</p></li>
<li><p><span class="math inline">\(L\)</span> contains the multipliers that were used at each stage to eliminate the rows.</p></li>
</ul>
</div>
</section>

<section id="effects-of-finite-precision-arithmetic" class="title-slide slide level2 center">
<h2>Effects of finite precision arithmetic</h2>
<div id="exm-finite-precision" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> Consider the following linear system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
0 &amp; 2 &amp; 1 \\
2 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 4 \\ 5
\end{pmatrix}
\]</span></p>
<p><em>Problem</em>. We cannot eliminate the first column by the diagonal by adding multiples of row 1 to rows 2 and 3, respectively.</p>
<p><em>Solution</em>. Swap the order of the equations!</p>
<ul>
<li><p>Swap rows 1 and 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
4 \\ 7 \\ 5
\end{pmatrix}
\]</span></p></li>
<li><p>Now apply Gaussian elimination</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 1.5 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ 3
\end{pmatrix} \\
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 0 &amp; -0.75
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ -2.25
\end{pmatrix}.
\end{align*}\]</span></p></li>
</ul>
</div>
<div id="exm-finite-precision2" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> Consider another system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
4 &amp; 2 &amp; 1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ 5 \\ 2
\end{pmatrix}
\]</span></p>
<ul>
<li><p>Apply Gaussian elimination as usual:</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ 2
\end{pmatrix}
\\
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
0 &amp; 1 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\end{align*}\]</span></p></li>
<li><p><em>Problem</em>. We cannot eliminate the second column below the diagonal by adding a multiple of row 2 to row 3.</p></li>
<li><p>Again, this problem may be overcome simply by swapping the order of the equations – this time, swapping rows 2 and 3:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; -1 \\
0 &amp; 0 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\]</span></p></li>
<li><p>We can now continue the Gaussian elimination process as usual.</p></li>
</ul>
</div>
<p><em>In general</em>. Gaussian elimination requires row swaps to avoid breaking down when there is a zero in the “pivot” position. Avoiding zero-division might be a familiar aspect of Gaussian elimination, but there is an additional reason to apply pivoting when working with floating point numbers:</p>
<div id="exm-finite-precision3" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> Consider using Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
1 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<ul>
<li><p>The true, unique solution is <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>If <span class="math inline">\(\varepsilon \neq 0\)</span>, Gaussian elimination gives</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
0 &amp; 1 - \frac{1}{\varepsilon}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3 - \frac{2 + \varepsilon}{\varepsilon}
\end{pmatrix}
\]</span></p></li>
<li><p>Problems occur not only when <span class="math inline">\(\varepsilon = 0\)</span> but also when it is very small, i.e.&nbsp;when <span class="math inline">\(\frac{1}{\varepsilon}\)</span> is very large, which will introduce very significant rounding errors into the computation.</p></li>
</ul>
<p>Use Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
\varepsilon &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<ul>
<li><p>The true solution is still <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>Gaussian elimination now gives</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1 - \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 - 2\varepsilon
\end{pmatrix}
\]</span></p></li>
<li><p>The problems due to small values of <span class="math inline">\(\varepsilon\)</span> have disappeared.</p></li>
</ul>
<p>This is a genuine problem we see in the code versions too!</p>
<div>
<div id="pyodide-17" class="exercise-cell">

</div>
<script type="pyodide-17-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoicHJpbnQoXCJ3aXRob3V0IHJvdyBzd2FwcGluZzpcIilcbmZvciBlcHMgaW4gWzEuMGUtMiwgMS4wZS00LCAxLjBlLTYsIDEuMGUtOCwgMS4wZS0xMCwgMS4wZS0xMiwgMS4wZS0xNF06XG4gICAgQSA9IG5wLmFycmF5KFtbZXBzLCAxLjBdLCBbMS4wLCAxLjBdXSlcbiAgICBiID0gbnAuYXJyYXkoW1syLjAgKyBlcHNdLCBbMy4wXV0pXG5cbiAgICBnYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiKVxuICAgIHggPSBiYWNrd2FyZF9zdWJzdGl0dXRpb24oQSwgYilcbiAgICBwcmludChmXCJ7ZXBzPTouMWV9XCIsIGVuZD1cIiwgXCIpXG4gICAgcHJpbnRfYXJyYXkoeC5ULCBcInguVFwiLCBlbmQ9XCIsIFwiKVxuXG4gICAgQSA9IG5wLmFycmF5KFtbZXBzLCAxLjBdLCBbMS4wLCAxLjBdXSlcbiAgICBiID0gbnAuYXJyYXkoW1syLjAgKyBlcHNdLCBbMy4wXV0pXG4gICAgcHJpbnQoXCJTb2x1dGlvbj9cIiwgbnAuYWxsY2xvc2UoQSBAIHgsIGIpKVxucHJpbnQoKVxuXG5wcmludChcIndpdGggcm93IHN3YXBwaW5nOlwiKVxuZm9yIGVwcyBpbiBbMS4wZS0yLCAxLjBlLTQsIDEuMGUtNiwgMS4wZS04LCAxLjBlLTEwLCAxLjBlLTEyLCAxLjBlLTE0XTpcbiAgICBBID0gbnAuYXJyYXkoW1sxLjAsIDEuMF0sIFtlcHMsIDEuMF1dKVxuICAgIGIgPSBucC5hcnJheShbWzMuMF0sIFsyLjAgKyBlcHNdXSlcblxuICAgIGdhdXNzaWFuX2VsaW1pbmF0aW9uKEEsIGIpXG4gICAgeCA9IGJhY2t3YXJkX3N1YnN0aXR1dGlvbihBLCBiKVxuICAgIHByaW50KGZcIntlcHM9Oi4xZX1cIiwgZW5kPVwiLCBcIilcbiAgICBwcmludF9hcnJheSh4LlQsIFwieC5UXCIsIGVuZD1cIiwgXCIpXG5cbiAgICBBID0gbnAuYXJyYXkoW1sxLjAsIDEuMF0sIFtlcHMsIDEuMF1dKVxuICAgIGIgPSBucC5hcnJheShbWzMuMF0sIFsyLjAgKyBlcHNdXSlcbiAgICBwcmludChcIlNvbHV0aW9uP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpXG5wcmludCgpXG4ifQ==
</script>
</div>
</div>
<div id="rem-finite-precision" class="proof remark">
<p><span class="proof-title"><em>Remark 3</em>. </span></p>
<ul>
<li><p>Writing the equations in a different order has removed the previous problem.</p></li>
<li><p>The diagonal entries are now always <em>relatively</em> larger.</p></li>
<li><p>The interchange of the order of equations is a simple example of <strong>row pivoting</strong>. This strategy avoids excessive rounding errors in the computations.</p></li>
</ul>
</div>
</section>
<section id="gaussian-elimination-with-pivoting" class="slide level3">
<h3>Gaussian elimination with pivoting</h3>
<p>Key idea:</p>
<ul>
<li><p>Before eliminating entries in column <span class="math inline">\(j\)</span>:</p>
<ul>
<li>find the entry in column <span class="math inline">\(j\)</span>, below the diagonal, of maximum magnitude;</li>
<li>if that entry is larger in magnitude than the diagonal entry then swap its row with row <span class="math inline">\(j\)</span>.</li>
</ul></li>
<li><p>Then eliminate column <span class="math inline">\(j\)</span> as before.</p></li>
</ul>
<p>This algorithm will always work when the matrix <span class="math inline">\(A\)</span> is non-singular. Conversely, if all of the possible pivot values are zero this implies that the matrix is singular and a unique solution does not exist. At each elimination step the row multiplies used are guaranteed to be at most one in magnitude so any errors in the representation of the system cannot be amplified by the elimination process. As always, solving <span class="math inline">\(A \vec{x} = \vec{b}\)</span> requires that the entries in <span class="math inline">\(\vec{b}\)</span> are also swapped in the appropriate way.</p>
<p>Pivoting can be applied in an equivalent way to LU factorisation. The sequence of pivots is independent of the vector <span class="math inline">\(\vec{b}\)</span> and can be recorded and reused. The constraint imposed on the row multipliers means that for LU factorisation every entry in <span class="math inline">\(L\)</span> satisfies <span class="math inline">\(| l_{ij} | \le 1\)</span>.</p>
<div id="exm-ge-pivot" class="theorem example">
<p><span class="theorem-title"><strong>Example 6</strong></span> Consider the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
-3 &amp; 2.1 - \varepsilon &amp; 6 \\
5 &amp; -1 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 9.9 + \varepsilon \\ 11
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(0 \le \varepsilon \ll 1\)</span>, and solve it using</p>
<ol type="1">
<li><p>Gaussian elimination without pivoting</p></li>
<li><p>Gaussian elimination with pivoting.</p></li>
</ol>
<p>The exact solution is <span class="math inline">\(\vec{x} = (0, -1, 2)^T\)</span> for any <span class="math inline">\(\varepsilon\)</span> in the given range.</p>
<p><strong>1. Solve the system using Gaussian elimination with no pivoting.</strong></p>
<p>Eliminating the first column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>and then the second column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 0 &amp; 5 + 15/\varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5 + 2.5(12 + \varepsilon)/\varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to</p>
<p><span class="math display">\[
x_3 = \frac{3 + \frac{12 + \varepsilon}{\varepsilon}}{2 + \frac{6}{\varepsilon}}
\qquad
x_2 = \frac{(12 + \varepsilon) - 6x_3}{-\varepsilon} \qquad
x_1 = \frac{7+ 7x_2}{10}.
\]</span></p>
<p>There are many divisions by <span class="math inline">\(\varepsilon\)</span>, so we will have problems if <span class="math inline">\(\varepsilon\)</span> is (very) small.</p>
<p><strong>2. Solve the system using Gaussian elimination with pivoting.</strong></p>
<p>The first stage is identical (because <span class="math inline">\(a_{11} = 10\)</span> is largest).</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>but now <span class="math inline">\(|a_{22}| = \varepsilon\)</span> and <span class="math inline">\(|a_{32}| = 2.5\)</span> so we swap rows 2 and 3 to give</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; -\varepsilon &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>Now we may eliminate column 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; 0 &amp; 6 + 2 \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + 4 \varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to the exact answer:</p>
<p><span class="math display">\[
x_3 = \frac{12 + 4\varepsilon}{6 + 2 \varepsilon} = 2 \qquad
x_2 = \frac{7.5 - 5x_3}{2.5} = -1 \qquad
x_1 = \frac{7 + 7 x_2}{10} = 0.
\]</span></p>
</div>
</section>
<section id="python-code-for-gaussian-elimination-with-pivoting" class="slide level3">
<h3>Python code for Gaussian elimination with pivoting</h3>
<div>
<div id="pyodide-18" class="exercise-cell">

</div>
<script type="pyodide-18-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGdhdXNzaWFuX2VsaW1pbmF0aW9uX3dpdGhfcGl2b3RpbmcoQSwgYiwgdmVyYm9zZT1GYWxzZSk6XG4gICAgXCJcIlwiXG4gICAgcGVyZm9ybSBHYXVzc2lhbiBlbGltbmF0aW9uIHdpdGggcGl2b3RpbmcgdG8gcmVkdWNlIHRoZSBzeXN0ZW0gb2YgbGluZWFyXG4gICAgZXF1YXRpb25zIEF4PWIgdG8gdXBwZXIgdHJpYW5ndWxhciBmb3JtLlxuICAgIHVzZSB2ZXJib3NlIHRvIHByaW50IG91dCBpbnRlcm1lZGlhdGUgcmVwcmVzZW50YXRpb25zXG4gICAgXCJcIlwiXG4gICAgIyBmaW5kIHNoYXBlIG9mIHN5c3RlbVxuICAgIG4gPSBzeXN0ZW1fc2l6ZShBLCBiKVxuXG4gICAgIyBwZXJmb3JtIGZvcndhcmRzIGVsaW1pbmF0aW9uXG4gICAgZm9yIGkgaW4gcmFuZ2UobiAtIDEpOlxuICAgICAgICAjIGVsaW1pbmF0ZSBjb2x1bW4gaVxuICAgICAgICBpZiB2ZXJib3NlOlxuICAgICAgICAgICAgcHJpbnQoZlwiZWxpbWluYXRpbmcgY29sdW1uIHtpfVwiKVxuXG4gICAgICAgICMgZmluZCBsYXJnZXN0IGVudHJ5IGluIGNvbHVtbiBpXG4gICAgICAgIGxhcmdlc3QgPSBhYnMoQVtpLCBpXSlcbiAgICAgICAgal9tYXggPSBpXG4gICAgICAgIGZvciBqIGluIHJhbmdlKGkgKyAxLCBuKTpcbiAgICAgICAgICAgIGlmIGFicyhBW2osIGldKSA+IGxhcmdlc3Q6XG4gICAgICAgICAgICAgICAgbGFyZ2VzdCwgal9tYXggPSBhYnMoQVtqLCBpXSksIGpcblxuICAgICAgICAjIHN3YXAgcm93cyBqX21heCBhbmQgaVxuICAgICAgICByb3dfc3dhcChBLCBiLCBpLCBqX21heClcbiAgICAgICAgaWYgdmVyYm9zZTpcbiAgICAgICAgICAgIHByaW50KGZcInN3YXBwZWQgc3lzdGVtICh7aX0gPC0+IHtqX21heH0pXCIpXG4gICAgICAgICAgICBwcmludF9hcnJheShBKVxuICAgICAgICAgICAgcHJpbnRfYXJyYXkoYilcbiAgICAgICAgICAgIHByaW50KClcblxuICAgICAgICBmb3IgaiBpbiByYW5nZShpICsgMSwgbik6XG4gICAgICAgICAgICAjIHJvdyBqXG4gICAgICAgICAgICBmYWN0b3IgPSBBW2osIGldIC8gQVtpLCBpXVxuICAgICAgICAgICAgaWYgdmVyYm9zZTpcbiAgICAgICAgICAgICAgICBwcmludChmXCJyb3cge2p9IHwtPiByb3cge2p9IC0ge2ZhY3Rvcn0gKiByb3cge2l9XCIpXG4gICAgICAgICAgICByb3dfYWRkKEEsIGIsIGosIC1mYWN0b3IsIGkpXG5cbiAgICAgICAgaWYgdmVyYm9zZTpcbiAgICAgICAgICAgIHByaW50KFwibmV3IHN5c3RlbVwiKVxuICAgICAgICAgICAgcHJpbnRfYXJyYXkoQSlcbiAgICAgICAgICAgIHByaW50X2FycmF5KGIpXG4gICAgICAgICAgICBwcmludCgpXG4ifQ==
</script>
</div>
<p>Gaussian elimination without pivoting following by back subsitution:</p>
<div>
<div id="pyodide-19" class="exercise-cell">

</div>
<script type="pyodide-19-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZXBzID0gMS4wZS0xNFxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIGVsaW1pbmF0aW9uIHdpdGhvdXQgcGl2b3RpbmdcIilcbmdhdXNzaWFuX2VsaW1pbmF0aW9uKEEsIGIsIHZlcmJvc2U9VHJ1ZSlcbnByaW50KClcblxucHJpbnQoXCJ1cHBlciB0cmlhbmd1bGFyIHN5c3RlbTpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKVxuXG5wcmludChcInBlcmZvcm1pbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uXCIpXG54ID0gYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpXG5wcmludCgpXG5cbnByaW50KFwic29sdXRpb24gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uOlwiKVxucHJpbnRfYXJyYXkoeClcbnByaW50KClcblxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcbnByaW50KFwiRG9lcyB4IHNvbHZlIHRoZSBvcmlnaW5hbCBzeXN0ZW0/XCIsIG5wLmFsbGNsb3NlKEEgQCB4LCBiKSkifQ==
</script>
</div>
<p>Gaussian elimination with pivoting following by back subsitution:</p>
<div>
<div id="pyodide-20" class="exercise-cell">

</div>
<script type="pyodide-20-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZXBzID0gMS4wZS0xNFxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIGVsaW1pbmF0aW9uIHdpdGggcGl2b3RpbmdcIilcbmdhdXNzaWFuX2VsaW1pbmF0aW9uX3dpdGhfcGl2b3RpbmcoQSwgYiwgdmVyYm9zZT1UcnVlKVxucHJpbnQoKVxuXG5wcmludChcInVwcGVyIHRyaWFuZ3VsYXIgc3lzdGVtOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicGVyZm9ybWluZyBiYWNrd2FyZCBzdWJzdGl0dXRpb25cIilcbnggPSBiYWNrd2FyZF9zdWJzdGl0dXRpb24oQSwgYilcbnByaW50KClcblxucHJpbnQoXCJzb2x1dGlvbiB1c2luZyBiYWNrd2FyZCBzdWJzdGl0dXRpb246XCIpXG5wcmludF9hcnJheSh4KVxucHJpbnQoKVxuXG5BID0gbnAuYXJyYXkoW1sxMC4wLCAtNy4wLCAwLjBdLCBbLTMuMCwgMi4xIC0gZXBzLCA2LjBdLCBbNS4wLCAtMS4wLCA1LjBdXSlcbmIgPSBucC5hcnJheShbWzcuMF0sIFs5LjkgKyBlcHNdLCBbMTEuMF1dKVxucHJpbnQoXCJEb2VzIHggc29sdmUgdGhlIG9yaWdpbmFsIHN5c3RlbT9cIiwgbnAuYWxsY2xvc2UoQSBAIHgsIGIpKSJ9
</script>
</div>
</section>

<section id="further-reading" class="title-slide slide level2 center">
<h2>Further reading</h2>
<p>Some basic reading:</p>
<ul>
<li>Joseph F. Grcar. <a href="https://doi.org/10.1016/j.hm.2010.06.003">How ordinary elimination became Gaussian elimination</a>. Historia Mathematica. Volume 38, Issue 2, May 2011. (More history)</li>
</ul>
<p>Some implementations:</p>
<ul>
<li>Numpy <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html"><code>numpy.linalg.solve</code></a></li>
<li>Scipy <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lu.html"><code>scipy.linalg.lu</code></a></li>
<li>LAPACK Gaussian elimination (uses LU factorisation): <a href="https://netlib.org/lapack/explore-html-3.6.1/d7/d3b/group__double_g_esolve_ga5ee879032a8365897c3ba91e3dc8d512.html"><code>dgesv()</code></a></li>
<li>LAPACK LU Factorisation: <a href="http://www.netlib.org/lapack/explore-html/dd/d9a/group__double_g_ecomputational_ga0019443faea08275ca60a734d0593e60.html"><code>dgetrf()</code></a>.</li>
</ul>

<script type="pyodide-data">
eyJvcHRpb25zIjp7ImluZGV4VVJMIjoiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMjYuMS9mdWxsLyJ9LCJwYWNrYWdlcyI6eyJwa2dzIjpbInB5b2RpZGVfaHR0cCIsIm1pY3JvcGlwIiwiaXB5dGhvbiJdfX0=
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJweW9kaWRlLTIwIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMjAgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTIwLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMjAtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8yMCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMjAsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE5IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTkgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE5LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTktY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xOSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTksIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE4IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTggPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE4LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTgtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xOCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTgsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE3IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTcgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE3LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTctY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNyA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE2IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTYgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE2LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTYtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNiA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE1IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTUgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE1LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTUtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE0IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTQgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE0LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTQtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEzIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTMgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEzLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTMtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMyA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEyIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTIgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEyLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTItY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMiA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTExIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTEgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTExLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTEtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTEsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEwIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTAgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEwLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTAtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTAsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTkiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl85ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS05LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtOS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzkgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzksIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTgiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl84ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS04LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtOC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzggPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzgsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTciLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl83ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS03LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzcgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTYiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl82ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS02LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzYgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl81ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS01LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzUgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTQiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl80ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS00LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzQgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTMiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8zID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0zLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzMgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTIiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8yID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0yLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzIgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoiX3B5b2RpZGVfdmFsdWVfMSA9IHtcbiAgY29uc3QgeyBoaWdobGlnaHRQeXRob24sIGI2NERlY29kZX0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0xLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgLy8gRGVmYXVsdCBldmFsdWF0aW9uIGNvbmZpZ3VyYXRpb25cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIGlkOiBcInB5b2RpZGUtMS1jb250ZW50c1wiLFxuICAgIGVjaG86IHRydWUsXG4gICAgb3V0cHV0OiB0cnVlXG4gIH0sIGJsb2NrLmF0dHIpO1xuXG4gIC8vIEV2YWx1YXRlIHRoZSBwcm92aWRlZCBQeXRob24gY29kZVxuICBjb25zdCByZXN1bHQgPSBweW9kaWRlT2pzLnByb2Nlc3Moe2NvZGU6IGJsb2NrLmNvZGUsIG9wdGlvbnN9LCB7fSk7XG5cbiAgLy8gRWFybHkgeWllbGQgd2hpbGUgd2Ugd2FpdCBmb3IgdGhlIGZpcnN0IGV2YWx1YXRpb24gYW5kIHJlbmRlclxuICBpZiAob3B0aW9ucy5vdXRwdXQgJiYgIShcIjFcIiBpbiBweW9kaWRlT2pzLnJlbmRlcmVkT2pzKSkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICBpZiAob3B0aW9ucy5lY2hvKSB7XG4gICAgICAvLyBTaG93IG91dHB1dCBhcyBoaWdobGlnaHRlZCBzb3VyY2VcbiAgICAgIGNvbnN0IHByZUVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwic291cmNlQ29kZVwiO1xuICAgICAgcHJlRWxlbS5jbGFzc05hbWUgPSBcInNvdXJjZUNvZGUgcHl0aG9uXCI7XG4gICAgICBwcmVFbGVtLmFwcGVuZENoaWxkKGhpZ2hsaWdodFB5dGhvbihibG9jay5jb2RlKSk7XG4gICAgICBzcGlubmVyLmNsYXNzTmFtZSA9IFwic3Bpbm5lci1ncm93IHNwaW5uZXItZ3Jvdy1zbSBtLTIgcG9zaXRpb24tYWJzb2x1dGUgdG9wLTAgZW5kLTBcIjtcbiAgICAgIHByZUVsZW0uYXBwZW5kQ2hpbGQoc3Bpbm5lcik7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJlRWxlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwaW5uZXIuY2xhc3NOYW1lID0gXCJzcGlubmVyLWJvcmRlciBzcGlubmVyLWJvcmRlci1zbVwiO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwaW5uZXIpO1xuICAgIH1cblxuICAgIHlpZWxkIGNvbnRhaW5lcjtcbiAgfVxuXG4gIHB5b2RpZGVPanMucmVuZGVyZWRPanNbXCIxXCJdID0gdHJ1ZTtcbiAgeWllbGQgYXdhaXQgcmVzdWx0O1xufVxuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtcHJlbHVkZSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InB5b2RpZGVPanMgPSB7XG4gIGNvbnN0IHtcbiAgICBQeW9kaWRlRXZhbHVhdG9yLFxuICAgIFB5b2RpZGVFbnZpcm9ubWVudE1hbmFnZXIsXG4gICAgc2V0dXBQeXRob24sXG4gICAgc3RhcnRQeW9kaWRlV29ya2VyLFxuICAgIGI2NERlY29kZSxcbiAgICBjb2xsYXBzZVBhdGgsXG4gIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1zdGF0dXNcIik7XG4gIGNvbnN0IGluZGljYXRvckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGluZGljYXRvckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xuXG4gIGxldCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICBzdGF0dXNUZXh0LmNsYXNzTGlzdCA9IFwiZXhlcmNpc2UtbG9hZGluZy1kZXRhaWxzXCI7XG4gIHN0YXR1c1RleHQgPSBzdGF0dXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc3RhdHVzVGV4dCk7XG4gIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgSW5pdGlhbGlzZWA7XG5cbiAgLy8gSG9pc3QgaW5kaWNhdG9yIG91dCBmcm9tIGZpbmFsIHNsaWRlIHdoZW4gcnVubmluZyB1bmRlciByZXZlYWxcbiAgY29uc3QgcmV2ZWFsU3RhdHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgLmV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpZiAocmV2ZWFsU3RhdHVzKSB7XG4gICAgcmV2ZWFsU3RhdHVzLnJlbW92ZSgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsID4gLnNsaWRlc1wiKS5hcHBlbmRDaGlsZChyZXZlYWxTdGF0dXMpO1xuICB9XG5cbiAgLy8gTWFrZSBhbnkgcmV2ZWFsIHNsaWRlcyB3aXRoIGxpdmUgY2VsbHMgc2Nyb2xsYWJsZVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJldmVhbCAuZXhlcmNpc2UtY2VsbFwiKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGVsLmNsb3Nlc3QoJ3NlY3Rpb24uc2xpZGUnKS5jbGFzc0xpc3QuYWRkKFwic2Nyb2xsYWJsZVwiKTtcbiAgfSlcblxuICAvLyBQeW9kaWRlIHN1cHBsZW1lbnRhbCBkYXRhIGFuZCBvcHRpb25zXG4gIGNvbnN0IGRhdGFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtZGF0YVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGI2NERlY29kZShkYXRhQ29udGVudCkpO1xuXG4gIC8vIEdyYWIgbGlzdCBvZiByZXNvdXJjZXMgdG8gYmUgZG93bmxvYWRlZFxuICBjb25zdCBmaWxlc0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwidmZzLWZpbGVcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBmaWxlcyA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGZpbGVzQ29udGVudCkpO1xuXG4gIGxldCBweW9kaWRlUHJvbWlzZSA9IChhc3luYyAoKSA9PiB7XG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBQeW9kaWRlYDtcbiAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgc3RhcnRQeW9kaWRlV29ya2VyKGRhdGEub3B0aW9ucyk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6IG1pY3JvcGlwYDtcbiAgICBhd2FpdCBweW9kaWRlLmxvYWRQYWNrYWdlKFwibWljcm9waXBcIik7XG4gICAgY29uc3QgbWljcm9waXAgPSBhd2FpdCBweW9kaWRlLnB5aW1wb3J0KFwibWljcm9waXBcIik7XG4gICAgYXdhaXQgZGF0YS5wYWNrYWdlcy5wa2dzLm1hcCgocGtnKSA9PiAoKSA9PiB7XG4gICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6ICR7cGtnfWA7XG4gICAgICByZXR1cm4gbWljcm9waXAuaW5zdGFsbChwa2cpO1xuICAgIH0pLnJlZHVjZSgoY3VyLCBuZXh0KSA9PiBjdXIudGhlbihuZXh0KSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIGF3YWl0IG1pY3JvcGlwLmRlc3Ryb3koKTtcblxuICAgIC8vIERvd25sb2FkIGFuZCBpbnN0YWxsIHJlc291cmNlc1xuICAgIGF3YWl0IGZpbGVzLm1hcCgoZmlsZSkgPT4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IGZpbGUuc3Vic3RyaW5nKGZpbGUubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyByZXNvdXJjZTogJHtuYW1lfWA7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGUpO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IGRvd25sb2FkIFxcYCR7ZmlsZX1cXGAuIEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogXCIke3Jlc3BvbnNlLnN0YXR1c1RleHR9XCIuYCk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcblxuICAgICAgLy8gU3RvcmUgVVJMcyBpbiB0aGUgY3dkIHdpdGhvdXQgYW55IHN1YmRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgICAgIGZpbGUgPSBuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBDb2xsYXBzZSBoaWdoZXIgZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgICAgZmlsZSA9IGNvbGxhcHNlUGF0aChmaWxlKTtcblxuICAgICAgLy8gQ3JlYXRlIGRpcmVjdG9yeSB0cmVlLCBpZ25vcmluZyBcImRpcmVjdG9yeSBleGlzdHNcIiBWRlMgZXJyb3JzXG4gICAgICBjb25zdCBwYXJ0cyA9IGZpbGUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSk7XG4gICAgICBsZXQgcGF0aCA9ICcnO1xuICAgICAgd2hpbGUgKHBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGF0aCArPSBwYXJ0cy5zaGlmdCgpICsgJy8nO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHB5b2RpZGUuRlMubWtkaXIocGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoZS5uYW1lICE9PSBcIkVycm5vRXJyb3JcIikgdGhyb3cgZTtcbiAgICAgICAgICBpZiAoZS5lcnJubyAhPT0gMjApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuVVRGOFRvU3RyaW5nKGVycm9yVGV4dFB0cik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVzeXN0ZW0gRXJyb3IgJHtlLmVycm5vfSBcIiR7ZXJyb3JUZXh0fVwiLmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0aGlzIGZpbGUgdG8gdGhlIFZGU1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHB5b2RpZGUuRlMud3JpdGVGaWxlKGZpbGUsIG5ldyBVaW50OEFycmF5KGRhdGEpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUubmFtZSAhPT0gXCJFcnJub0Vycm9yXCIpIHRocm93IGU7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5VVEY4VG9TdHJpbmcoZXJyb3JUZXh0UHRyKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yICR7ZS5lcnJub30gXCIke2Vycm9yVGV4dH1cIi5gKTtcbiAgICAgIH1cbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcblxuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgUHlvZGlkZSBlbnZpcm9ubWVudCBzZXR1cGA7XG4gICAgYXdhaXQgc2V0dXBQeXRob24ocHlvZGlkZSk7XG5cbiAgICBzdGF0dXNUZXh0LnJlbW92ZSgpO1xuICAgIGlmIChzdGF0dXNDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgIHN0YXR1c0NvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gcHlvZGlkZTtcbiAgfSkoKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgc3RhdHVzVGV4dC5zdHlsZS5jb2xvciA9IFwidmFyKC0tZXhlcmNpc2UtZWRpdG9yLWhsLWVyLCAjQUQwMDAwKVwiO1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBlcnIubWVzc2FnZTtcbiAgICAvL2luZGljYXRvckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnNwaW5uZXItZ3Jvd1wiKS5jbGFzc0xpc3QuYWRkKFwiZC1ub25lXCIpO1xuICAgIHRocm93IGVycjtcbiAgfSk7XG5cbiAgLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsIE9KUyBibG9jayByZW5kZXJcbiAgY29uc3QgcmVuZGVyZWRPanMgPSB7fTtcblxuICBjb25zdCBwcm9jZXNzID0gYXN5bmMgKGNvbnRleHQsIGlucHV0cykgPT4ge1xuICAgIGNvbnN0IHB5b2RpZGUgPSBhd2FpdCBweW9kaWRlUHJvbWlzZTtcbiAgICBjb25zdCBldmFsdWF0b3IgPSBuZXcgUHlvZGlkZUV2YWx1YXRvcihweW9kaWRlLCBjb250ZXh0KTtcbiAgICBhd2FpdCBldmFsdWF0b3IucHJvY2VzcyhpbnB1dHMpO1xuICAgIHJldHVybiBldmFsdWF0b3IuY29udGFpbmVyO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBweW9kaWRlUHJvbWlzZSxcbiAgICByZW5kZXJlZE9qcyxcbiAgICBwcm9jZXNzLFxuICB9O1xufVxuIn1dfQ==
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lec03_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lec03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lec03_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="ojs-module-contents">
    eyJjb250ZW50cyI6W119
    </script>
    <script type="module">
    if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
    window._ojs.paths.runtimeToDoc = "../../..";
    window._ojs.paths.runtimeToRoot = "../../../..";
    window._ojs.paths.docToRoot = "..";
    window._ojs.selfContained = false;
    window._ojs.runtime.interpretFromScriptTags();
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>