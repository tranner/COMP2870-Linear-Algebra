<!DOCTYPE html>
<html lang="en"><head>
<script src="lec03_files/libs/clipboard/clipboard.min.js"></script>
<script src="lec03_files/libs/quarto-html/tabby.min.js"></script>
<script src="lec03_files/libs/quarto-html/popper.min.js"></script>
<script src="lec03_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lec03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lec03_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lec03_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lec03_files/libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="lec03_files/libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Dr.&nbsp;Thomas Ranner (Tom)">
  <title>COMP2870 Theoretical Foundations of Computer Science II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lec03_files/libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link href="lec03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lec03_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script>
    MathJax = {
      tex: {
        tags: 'ams'  // should be 'ams', 'none', or 'all'
      }
    };
  </script>
  <script type="module" src="lec03_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
  <link href="lec03_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">COMP2870 Theoretical Foundations of Computer Science II</h1>
  <p class="subtitle">Direct solvers for systems of linear equations</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Thomas Ranner (Tom) 
</div>
<div class="quarto-title-author-email">
<a href="mailto:T.Ranner@leeds.ac.uk">T.Ranner@leeds.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            School of Computer Science, University of Leeds
          </p>
    </div>
</div>

</section>
<section>
<section id="direct-solvers-for-systems-of-linear-equations" class="title-slide slide level1 center">
<h1>Direct solvers for systems of linear equations</h1>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Module learning objective</strong></p>
</div>
<div class="callout-content">
<p>Apply <strong>direct</strong> and iterative solvers to solve systems of linear equations; implement methods using floating point numbers and investigate computational cost using computer experiments.</p>
</div>
</div>
</div>
<p>Chapter 4</p>
</section>
<section id="reminder-of-the-problem" class="title-slide slide level2 center">
<h2>Reminder of the problem</h2>
<p>Recall the problem is to solve a set of <span class="math inline">\(n\)</span> <strong>linear</strong> equations for <span class="math inline">\(n\)</span> unknown values <span class="math inline">\(x_j\)</span>, for <span class="math inline">\(j=1, 2, \ldots, n\)</span>.</p>
<p><strong>Notation</strong>:</p>
<p><span class="math display">\[\begin{align*}
\text{Equation } 1:
&amp;&amp; a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n &amp; = b_1 \\
\text{Equation } 2:
&amp;&amp; a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n &amp; = b_2 \\
\vdots \\
\text{Equation } i:
&amp;&amp; a_{i1} x_1 + a_{i2} x_2 + a_{i3} x_3 + \cdots + a_{in} x_n &amp; = b_i \\
\vdots \\
\text{Equation } n:
&amp;&amp; a_{n1} x_1 + a_{n2} x_2 + a_{n3} x_3 + \cdots + a_{nn} x_n &amp; = b_n.
\end{align*}\]</span></p>
</section>
<section id="general-matrix-vector-form" class="slide level3">
<h3>General matrix vector form</h3>
<p>We can also write the system of linear equations in <em>general matrix-vector</em> form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; \cdots &amp; a_{2n} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; a_{3n} \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
</section>

<section id="special-types-of-matrices" class="title-slide slide level2 center">
<h2>Special types of matrices</h2>
<p>The general matrix <span class="math inline">\(A\)</span> before the examples is known as a <strong>full</strong> matrix: any of its components <span class="math inline">\(a_{ij}\)</span> might be nonzero.</p>
</section>
<section id="triangular-matrix" class="slide level3">
<h3>Triangular matrix</h3>
<p>One common (and important) structure takes the form</p>
<p><span class="math display">\[
A = \begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\ a_{21} &amp; a_{22} &amp; 0 &amp; \cdots &amp;
0 \\ a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots
&amp; \vdots \\ a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn} \end{pmatrix}.
\]</span></p>
</section>
<section id="triangular-matrix-1" class="slide level3">
<h3>Triangular matrix</h3>
<ul>
<li><p>A is a <strong>lower triangular</strong> matrix. Every entry above the leading diagonal is zero:</p>
<p><span class="math display">\[ a_{ij} = 0 \quad \text{ for } \quad j &gt; i. \]</span></p></li>
<li><p>The <em>transpose</em> of this matrix is an <strong>upper triangular</strong> matrix and can be treated in a very similar manner.</p></li>
<li><p>Note that the determinant of a triangular matrix is simply the product of diagonal coefficients: <span class="math display">\[
\det A = a_{11} a_{22} \cdots a_{nn} = \prod_{i=1}^n a_{ii}.
\]</span></p></li>
</ul>
</section>

<section id="solving-triangular-systems-of-equations" class="title-slide slide level2 center">
<h2>Solving triangular systems of equations</h2>
<p>A general <em>lower triangular</em> system of equations has <span class="math inline">\(a_{ij} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span> and takes the form:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; \cdots &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; a_{n2} &amp; a_{n3} &amp; \cdots &amp; a_{nn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n
\end{pmatrix} =
\begin{pmatrix}
b_1 \\ b_2 \\ b_3 \\ \vdots \\ b_n
\end{pmatrix}.
\]</span></p>
</section>
<section id="how-to-do-it" class="slide level3">
<h3>How to do it</h3>
<p>Note that first equation is</p>
<p><span class="math display">\[
a_{11} x_1 = b_1.
\]</span></p>
<p>Then <span class="math inline">\(x_i\)</span> can be found by calculating</p>
<p><span class="math display">\[
x_i = \frac{1}{a_{ii}} \left(b_i - \sum_{j=1}^{i-1} a_{ij} x_j \right)
\]</span></p>
<p>for each row <span class="math inline">\(i = 1, 2, \ldots, n\)</span> in turn.</p>
<aside class="notes">
<ul>
<li>Each calculation requires only previously computed values <span class="math inline">\(x_j\)</span> (and the sum gives a loop for <span class="math inline">\(j &lt; i\)</span>.</li>
<li>The matrix <span class="math inline">\(A\)</span> <strong>must</strong> have non-zero diagonal entries<br>
i.e.&nbsp;<span class="math inline">\(a_{ii} \neq 0\)</span> for <span class="math inline">\(i = 1, 2, \ldots, n\)</span>.</li>
<li><strong>Upper triangular</strong> systems of equations can be solved in similarly.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example" class="slide level3">
<h3>Example</h3>
<p>Solve the lower triangular system of equations given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;&amp; &amp;&amp; &amp;= 2 \\
x_1 &amp;+&amp; 2 x_2 &amp;&amp; &amp;= 7 \\
2 x_1 &amp;+&amp; 4 x_2 &amp;+&amp; 6 x_3 &amp;= 26
\end{aligned}
\]</span></p>
<p>or, equivalently,</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 0 &amp; 0 \\
1 &amp; 2 &amp; 0 \\
2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7 \\ 26
\end{pmatrix}.
\]</span></p>
<aside class="notes">
<p>The solution can be calculated systematically from</p>
<p><span class="math display">\[
\begin{aligned}
x_1 &amp;= \frac{b_1}{a_{11}} = \frac{2}{2} = 1 \\
x_2 &amp;= \frac{b_2 - a_{21} x_1}{a_{22}}
= \frac{7 - 1 \times 1}{2} = \frac{6}{2} = 3 \\
x_3 &amp;= \frac{b_3 - a_{31} x_1 - a_{32} x_2}{a_33}
= \frac{26 - 2 \times 1 - 4 \times 3}{6}  = \frac{12}{6}
= 2
\end{aligned}
\]</span></p>
<p>which gives the solution <span class="math inline">\(\vec{x} = (1, 3, 2)^T\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise" class="slide level3">
<h3>Exercise</h3>
<p>Solve the upper triangular linear system given by</p>
<p><span class="math display">\[
\begin{aligned}
2 x_1 &amp;+&amp; x_2 &amp;+&amp; 4 x_3 &amp;=&amp; 12 \\
&amp;&amp; 1.5 x_2 &amp;&amp; &amp;=&amp; 3 \\
&amp;&amp; &amp;&amp; 2 x_3 &amp;=&amp; 4
\end{aligned}.
\]</span></p>
</section>
<section id="remarks" class="slide level3">
<h3>Remarks</h3>
<ul>
<li><p>It is simple to solve a lower (upper) triangular system of equations (provided the diagonal is non-zero).</p></li>
<li><p>This process is often referred to as <strong>forward</strong> (<strong>backwards</strong>) <strong>substitution</strong>.</p></li>
</ul>
</section>
<section id="python-version" class="slide level3">
<h3>Python version</h3>
<p>We start with some helper code which determines the size of the system we are working with:</p>
<div>
<div id="pyodide-1" class="exercise-cell">

</div>
<script type="pyodide-1-contents">
eyJhdHRyIjp7ImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZSwiaW5jbHVkZSI6ZmFsc2UsIm91dHB1dCI6ZmFsc2V9LCJjb2RlIjoiXG5pbXBvcnQgaW5zcGVjdFxuXG5pbXBvcnQgbnVtcHkgYXMgbnBcblxuZGVmIHN5c3RlbV9zaXplKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFZhbGlkYXRlIHRoZSBkaW1lbnNpb25zIG9mIGEgbGluZWFyIHN5c3RlbSBhbmQgcmV0dXJuIGl0cyBzaXplLlxuXG4gICAgVGhpcyBmdW5jdGlvbiBjaGVja3Mgd2hldGhlciB0aGUgZ2l2ZW4gY29lZmZpY2llbnQgbWF0cml4IGBBYCBpcyBzcXVhcmVcbiAgICBhbmQgd2hldGhlciBpdHMgZGltZW5zaW9ucyBhcmUgY29tcGF0aWJsZSB3aXRoIHRoZSByaWdodC1oYW5kIHNpZGUgdmVjdG9yXG4gICAgYGJgLiBJZiB0aGUgZGltZW5zaW9ucyBhcmUgdmFsaWQsIGl0IHJldHVybnMgdGhlIHNpemUgb2YgdGhlIHN5c3RlbS5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgQSA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAyRCBhcnJheSBvZiBzaGFwZSBgYChuLCBuKWBgIHJlcHJlc2VudGluZyB0aGUgY29lZmZpY2llbnQgbWF0cml4IG9mXG4gICAgICAgIHRoZSBsaW5lYXIgc3lzdGVtLlxuICAgIGIgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgYXJyYXkgb2Ygc2hhcGUgYGAobiwgbylgYCByZXByZXNlbnRpbmcgdGhlIHJpZ2h0LWhhbmQgc2lkZSB2ZWN0b3IuXG5cbiAgICBSZXR1cm5zXG4gICAgLS0tLS0tLVxuICAgIGludFxuICAgICAgICBUaGUgc2l6ZSBvZiB0aGUgc3lzdGVtLCBpLmUuLCB0aGUgbnVtYmVyIG9mIHZhcmlhYmxlcyBgbmAuXG5cbiAgICBSYWlzZXNcbiAgICAtLS0tLS1cbiAgICBWYWx1ZUVycm9yXG4gICAgICAgIElmIGBBYCBpcyBub3Qgc3F1YXJlIG9yIGlmIHRoZSBzaXplIG9mIGBiYCBkb2VzIG5vdCBtYXRjaCB0aGUgbnVtYmVyIG9mXG4gICAgICAgIHJvd3MgaW4gYEFgLlxuICAgIFwiXCJcIlxuXG4gICAgIyBWYWxpZGF0ZSB0aGF0IEEgaXMgYSAyRCBzcXVhcmUgbWF0cml4XG4gICAgaWYgQS5uZGltICE9IDI6XG4gICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZlwiTWF0cml4IEEgbXVzdCBiZSAyRCwgYnV0IGdvdCB7QS5uZGltfUQgYXJyYXlcIilcblxuICAgIG4sIG0gPSBBLnNoYXBlXG4gICAgaWYgbiAhPSBtOlxuICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGZcIk1hdHJpeCBBIG11c3QgYmUgc3F1YXJlLCBidXQgZ290IEEuc2hhcGU9e0Euc2hhcGV9XCIpXG5cbiAgICBpZiBiLnNoYXBlWzBdICE9IG46XG4gICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoXG4gICAgICAgICAgICBmXCJTeXN0ZW0gc2hhcGVzIGFyZSBub3QgY29tcGF0aWJsZTogQS5zaGFwZT17QS5zaGFwZX0sIFwiXG4gICAgICAgICAgICBmXCJiLnNoYXBlPXtiLnNoYXBlfVwiXG4gICAgICAgIClcblxuICAgIHJldHVybiBuXG5cblxuZGVmIHByaW50X2FycmF5KGFycmF5LCBhcnJheV9uYW1lPU5vbmUsIGVuZD1Ob25lKTpcbiAgICBcIlwiXCJcbiAgICBOaWNlbHkgcHJpbnQgYSAyRCBOdW1QeSBhcnJheSB3aXRoIGR5bmFtaWMgcHJlY2lzaW9uIGZvcm1hdHRpbmcuXG5cbiAgICBUaGlzIGZ1bmN0aW9uIHByaW50cyBhIDJEIGFycmF5IGluIGEgcmVhZGFibGUsIGZvcm1hdHRlZCBzdHlsZS4gSXRcbiAgICBhdXRvbWF0aWNhbGx5IGRldGVybWluZXMgdGhlIHJlcXVpcmVkIHByZWNpc2lvbiB0byBhY2N1cmF0ZWx5IHJlcHJlc2VudCB0aGVcbiAgICBhcnJheSB2YWx1ZXMsIHVwIHRvIGEgbWF4aW11bSBvZiAxNSBkZWNpbWFsIHBsYWNlcy4gVGhlIHByaW50ZWQgb3V0cHV0XG4gICAgaW5jbHVkZXMgdGhlIGFycmF5IG5hbWUgaWYgcHJvdmlkZWQ7IG90aGVyd2lzZSwgdGhlIGZ1bmN0aW9uIGF0dGVtcHRzIHRvXG4gICAgaW5mZXIgdGhlIHZhcmlhYmxlIG5hbWUgZnJvbSB0aGUgY2FsbGluZyBzY29wZS5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgYXJyYXkgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMkQgTnVtUHkgYXJyYXkgdG8gcHJpbnQuXG4gICAgYXJyYXlfbmFtZSA6IHN0ciwgb3B0aW9uYWxcbiAgICAgICAgVGhlIG5hbWUgdG8gZGlzcGxheSBmb3IgdGhlIGFycmF5IGluIHRoZSBvdXRwdXQuIElmIGBgTm9uZWBgIChkZWZhdWx0KSxcbiAgICAgICAgdGhlIGZ1bmN0aW9uIGF0dGVtcHRzIHRvIGluZmVyIHRoZSB2YXJpYWJsZSBuYW1lIGZyb20gdGhlIGNhbGxlcidzIGxvY2FsXG4gICAgICAgIHZhcmlhYmxlcy4gSWYgaXQgY2Fubm90IGJlIGluZmVycmVkLCBkZWZhdWx0cyB0byBgYFwiYXJyYXlcImBgLlxuICAgIGVuZCA6IHN0ciwgb3B0aW9uYWxcbiAgICAgICAgU3RyaW5nIGFwcGVuZGVkIGFmdGVyIHRoZSBsYXN0IHZhbHVlIGluIGVhY2ggcm93LCBzaW1pbGFyIHRvIHRoZSBgZW5kYFxuICAgICAgICBwYXJhbWV0ZXIgaW4gUHl0aG9uJ3MgYnVpbHQtaW4gYGBwcmludGBgIGZ1bmN0aW9uLiBEZWZhdWx0IGlzIGBgTm9uZWBgLFxuICAgICAgICB3aGljaCBhZGRzIGEgbmV3bGluZS5cbiAgICBcIlwiXCJcbiAgICAjIGZpbmQgYXJyYXlfbmFtZVxuICAgIGlmIGFycmF5X25hbWUgaXMgTm9uZTpcbiAgICAgICAgZnJhbWUgPSBpbnNwZWN0LmN1cnJlbnRmcmFtZSgpLmZfYmFja1xuICAgICAgICBmb3IgbmFtZSwgdmFsdWUgaW4gZnJhbWUuZl9sb2NhbHMuaXRlbXMoKTpcbiAgICAgICAgICAgIGlmIHZhbHVlIGlzIGFycmF5OlxuICAgICAgICAgICAgICAgIGFycmF5X25hbWUgPSBuYW1lXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICBpZiBhcnJheV9uYW1lIGlzIE5vbmU6XG4gICAgICAgIGFycmF5X25hbWUgPSBcImFycmF5XCJcblxuICAgICMgZGV0ZXJtaW5lIHByZWNpc2lvblxuICAgIHByZWNpc2lvbiA9IDFcbiAgICB3aGlsZSBub3QgbnAuYWxsY2xvc2UoYXJyYXksIG5wLnJvdW5kKGFycmF5LCBwcmVjaXNpb24pKTpcbiAgICAgICAgcHJlY2lzaW9uID0gcHJlY2lzaW9uICsgMVxuICAgICAgICBpZiBwcmVjaXNpb24gPT0gMTY6XG4gICAgICAgICAgICBicmVha1xuICAgIGZvcm1hdF9zdHIgPSBmXCJ7ezp7cHJlY2lzaW9uICsgM30ue3ByZWNpc2lvbn1mfX1cIlxuXG4gICAgbiwgbSA9IGFycmF5LnNoYXBlXG5cbiAgICBmb3IgaSBpbiByYW5nZShuKTpcbiAgICAgICAgaWYgaSA9PSAwOlxuICAgICAgICAgICAgcHJpbnQoZlwie2FycmF5X25hbWV9ID0gWyBcIiwgZW5kPVwiXCIpXG4gICAgICAgIGVsc2U6XG4gICAgICAgICAgICBwcmludChcIiBcIiAqIGxlbihhcnJheV9uYW1lKSArIFwiICAgWyBcIiwgZW5kPVwiXCIpXG5cbiAgICAgICAgcHJpbnQoXCIsIFwiLmpvaW4oW2Zvcm1hdF9zdHIuZm9ybWF0KHYpIGZvciB2IGluIGFycmF5W2ldXSksIGVuZD1cIiBdXCIpXG4gICAgICAgIHByaW50KGVuZD1lbmQpXG4ifQ==
</script>
</div>
<div>
<div id="pyodide-2" class="exercise-cell">

</div>
<script type="pyodide-2-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5BID0gbnAuYXJyYXkoW1syLjAsIDMuMF0sIFstMy4wLCAyLjBdXSlcbmIgPSBucC5hcnJheShbWzQuMF0sIFs3LjBdXSlcblxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludChcInN5c3RlbSBzaXplIGlzIFwiLCBzeXN0ZW1fc2l6ZShBLCBiKSkifQ==
</script>
</div>
</section>
<section id="forward-substitution" class="slide level3">
<h3>Forward substitution</h3>
<p>We can define functions to solve both upper and lower triangular form systems of linear equations:</p>
<div>
<div id="pyodide-3" class="exercise-cell">

</div>
<script type="pyodide-3-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGZvcndhcmRfc3Vic3RpdHV0aW9uKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFNvbHZlIGEgbG93ZXIgdHJpYW5ndWxhciBzeXN0ZW0gb2YgbGluZWFyIGVxdWF0aW9ucyB1c2luZyBmb3J3YXJkXG4gICAgc3Vic3RpdHV0aW9uLlxuICAgIFwiXCJcIlxuICAgICMgZ2V0IHNpemUgb2Ygc3lzdGVtXG4gICAgbiA9IHN5c3RlbV9zaXplKEEsIGIpXG5cbiAgICAuLi4ifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="kw">def</span> forward_substitution(A, b):</span>
<span id="cb1-2"><a href=""></a>    <span class="co"># check is lower triangular</span></span>
<span id="cb1-3"><a href=""></a>    <span class="cf">if</span> <span class="kw">not</span> np.allclose(A, np.tril(A)):</span>
<span id="cb1-4"><a href=""></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Matrix A is not lower triangular"</span>)</span>
<span id="cb1-5"><a href=""></a></span>
<span id="cb1-6"><a href=""></a>    <span class="co"># create solution variable</span></span>
<span id="cb1-7"><a href=""></a>    x <span class="op">=</span> np.empty_like(b)</span>
<span id="cb1-8"><a href=""></a></span>
<span id="cb1-9"><a href=""></a>    <span class="co"># perform forwards solve</span></span>
<span id="cb1-10"><a href=""></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb1-11"><a href=""></a>        partial_sum <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1-12"><a href=""></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, i):</span>
<span id="cb1-13"><a href=""></a>            partial_sum <span class="op">+=</span> A[i, j] <span class="op">*</span> x[j]</span>
<span id="cb1-14"><a href=""></a>        x[i] <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> A[i, i] <span class="op">*</span> (b[i] <span class="op">-</span> partial_sum)</span>
<span id="cb1-15"><a href=""></a></span>
<span id="cb1-16"><a href=""></a>    <span class="cf">return</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div>
<div id="pyodide-4" class="exercise-cell">

</div>
<script type="pyodide-4-contents">
eyJhdHRyIjp7ImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZSwiaW5jbHVkZSI6ZmFsc2UsIm91dHB1dCI6ZmFsc2V9LCJjb2RlIjoiXG5kZWYgYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFNvbHZlIGFuIHVwcGVyIHRyaWFuZ3VsYXIgc3lzdGVtIG9mIGxpbmVhciBlcXVhdGlvbnMgdXNpbmcgYmFja3dhcmRcbiAgICBzdWJzdGl0dXRpb24uXG5cbiAgICBUaGlzIGZ1bmN0aW9uIHNvbHZlcyB0aGUgc3lzdGVtIG9mIGVxdWF0aW9uczpcblxuICAgIC4uIG1hdGg6OlxuICAgICAgICBBIHggPSBiXG5cbiAgICB3aGVyZSBgQWAgaXMgYW4gKip1cHBlciB0cmlhbmd1bGFyIG1hdHJpeCoqIChhbGwgZWxlbWVudHMgYmVsb3cgdGhlIG1haW5cbiAgICBkaWFnb25hbCBhcmUgemVybykuIFRoZSBzb2x1dGlvbiB2ZWN0b3IgYHhgIGlzIGNvbXB1dGVkIHN0YXJ0aW5nIGZyb20gdGhlXG4gICAgbGFzdCBlcXVhdGlvbiBhbmQgcHJvY2VlZGluZyBiYWNrd2FyZC5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgQSA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAyRCBOdW1QeSBhcnJheSBvZiBzaGFwZSBgYChuLCBuKWBgIHJlcHJlc2VudGluZyB0aGUgdXBwZXIgdHJpYW5ndWxhclxuICAgICAgICBjb2VmZmljaWVudCBtYXRyaXggb2YgdGhlIHN5c3RlbS5cbiAgICBiIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDFEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sKWBgIG9yIGEgMkQgTnVtUHkgYXJyYXkgb2Ygc2hhcGVcbiAgICAgICAgYGAobiwgMSlgYCByZXByZXNlbnRpbmcgdGhlIHJpZ2h0LWhhbmQgc2lkZSB2ZWN0b3IuXG5cbiAgICBSZXR1cm5zXG4gICAgLS0tLS0tLVxuICAgIHggOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwpYGAgY29udGFpbmluZyB0aGUgc29sdXRpb24gdmVjdG9yLlxuICAgIFwiXCJcIlxuICAgICMgZ2V0IHNpemUgb2Ygc3lzdGVtXG4gICAgbiA9IHN5c3RlbV9zaXplKEEsIGIpXG5cbiAgICAjIGNoZWNrIGlzIHVwcGVyIHRyaWFuZ3VsYXJcbiAgICBhc3NlcnQgbnAuYWxsY2xvc2UoQSwgbnAudHJpdShBKSlcblxuICAgICMgY3JlYXRlIHNvbHV0aW9uIHZhcmlhYmxlXG4gICAgeCA9IG5wLmVtcHR5X2xpa2UoYilcblxuICAgICMgcGVyZm9ybSBiYWNrd2FyZHMgc29sdmVcbiAgICBmb3IgaSBpbiByYW5nZShuIC0gMSwgLTEsIC0xKTogICMgaXRlcmF0ZSBvdmVyIHJvd3MgYmFja3dhcmRzXG4gICAgICAgIHBhcnRpYWxfc3VtID0gMC4wXG4gICAgICAgIGZvciBqIGluIHJhbmdlKGkgKyAxLCBuKTpcbiAgICAgICAgICAgIHBhcnRpYWxfc3VtICs9IEFbaSwgal0gKiB4W2pdXG4gICAgICAgIHhbaV0gPSAxLjAgLyBBW2ksIGldICogKGJbaV0gLSBwYXJ0aWFsX3N1bSlcblxuICAgIHJldHVybiB4XG4ifQ==
</script>
</div>
</section>
<section id="test-it-out" class="slide level3">
<h3>Test it out!</h3>
<div>
<div id="pyodide-5" class="exercise-cell">

</div>
<script type="pyodide-5-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAwLjAsIDAuMF0sIFsxLjAsIDIuMCwgMC4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzIuMF0sIFs3LjBdLCBbMjYuMF1dKVxuXG5wcmludChcIlRoZSBzeXN0ZW0gaXMgZ2l2ZW4gYnk6XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJTb2x2aW5nIHRoZSBzeXN0ZW0gdXNpbmcgZm9yd2FyZCBzdWJzdGl0dXRpb25cIilcbnggPSBmb3J3YXJkX3N1YnN0aXR1dGlvbihBLCBiKVxucHJpbnQoKVxuXG5wcmludChcIlRoZSBzb2x1dGlvbiB1c2luZyBmb3J3YXJkIHN1YnN0aXR1dGlvbiBpczpcIilcbnByaW50X2FycmF5KHgpXG5wcmludCgpXG5cbnByaW50KFwiRG9lcyB4IHJlYWxseSBzb2x2ZSB0aGUgc3lzdGVtP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpIn0=
</script>
</div>
</section>
<section id="the-big-plan-for-a-general-matrix" class="slide level3">
<h3>The big plan for a general matrix!</h3>
<p>Recall that the <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> represents the coefficients that multiply the unknowns in each equation (row), while the <span class="math inline">\(n\)</span>-vector <span class="math inline">\(\vec{b}\)</span> represents the right-hand-side values.</p>
<blockquote>
<p>Our strategy will be to reduce the system to a triangular system of matrices, which is then easy to solve!</p>
</blockquote>
</section>

<section id="elementary-row-operations" class="title-slide slide level2 center">
<h2>Elementary row operations</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<p>Note three thingsâ€¦</p>
</section>

<section id="elementary-row-operations-ii" class="title-slide slide level2 center">
<h2>Elementary row operations ii</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li>The order in which we choose to write the <span class="math inline">\(n\)</span> equations is irrelevant</li>
</ul>
</section>

<section id="elementary-row-operations-iii" class="title-slide slide level2 center">
<h2>Elementary row operations iii</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li><p>We can multiply any equation by an arbitrary real number (<span class="math inline">\(k \neq 0\)</span> say):</p>
<p><span class="math display">\[
k a_{p1} x_1 + k a_{p2} x_2 + k a_{p3} x_3 + \cdots + k a_{pn} x_n = k b_p.
\]</span></p></li>
</ul>
</section>

<section id="elementary-row-operations-iv" class="title-slide slide level2 center">
<h2>Elementary row operations iv</h2>
<p>Consider equation <span class="math inline">\(p\)</span> of the above system:</p>
<p><span class="math display">\[
a_{p1} x_1 + a_{p2} x_2 + a_{p3} x_3 + \cdots + a_{pn} x_n = b_p,
\]</span></p>
<p>and equation <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[
a_{q1} x_1 + a_{q2} x_2 + a_{q3} x_3 + \cdots + a_{qn} x_n = b_q.
\]</span></p>
<ul>
<li>We can add any two equations:</li>
</ul>
<p><span class="math display">\[
(a_{p1} + a_{q1}) x_1 + (a_{p2} + a_{q2}) x_2 + \cdots + (a_{pn} +
a_{qn}) x_n = b_p + b_q.
\]</span></p>
</section>
<section id="example-1" class="slide level3">
<h3>Example</h3>
<p>Consider the system <span class="math display">\[\begin{align}
2 x_1 + 3 x_2 &amp; = 4  \label{eq:eg1a} \\
-3 x_1 + 2 x_2 &amp; = 7 \label{eq:eg1b}.
\end{align}\]</span></p>
<aside class="notes">
<p>Then we have: <span class="math display">\[\begin{align*}
4 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp; 8 x_1 + 12 x_2 &amp; = 16 \\
-15. \times \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp; 4.5 x_2 - 3 x_2 &amp; = -10.5 \\
\text{\eqref{eq:eg1a}} + \text{\eqref{eq:eg1b}} &amp; \rightarrow &amp;
-x_1 + 5 x_2 &amp; = 11 \\
\text{\eqref{eq:eg1b}} + 1.5 \times \text{\eqref{eq:eg1a}} &amp; \rightarrow &amp;
0 + 6.5 x_2 &amp; = 13.
\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-1" class="slide level3">
<h3>Exercise</h3>
<p>Consider the system <span class="math display">\[\begin{align}
x_1 + 2 x_2 &amp; = 1 \label{eq:eg2a} \\
4 x_1 + x_2 &amp; = -3 \label{eq:eg2b}.
\end{align}\]</span> Work out the result of these elementary row operations: <span class="math display">\[\begin{align*}
2 \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
0.25 \times \text{\eqref{eq:eg2b}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-1) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow \\
\text{\eqref{eq:eg2b}} + (-4) \times \text{\eqref{eq:eg2a}} &amp; \rightarrow
\end{align*}\]</span></p>
<aside class="notes">
<p>For a system written in matrix form our three observations mean the following:</p>
<ul>
<li><p>We can swap any two rows of the matrix (and corresponding right-hand side entries). For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
-3 &amp; 2\\ 2 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
7 \\ 4
\end{pmatrix}
\]</span></p></li>
<li><p>We can multiply any row of the matrix (and corresponding right-hand side entry) by a scalar. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; \frac{3}{2} \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
2 \\ 7
\end{pmatrix}
\]</span></p></li>
<li><p>We can replace row <span class="math inline">\(q\)</span> by row <span class="math inline">\(q + k \times\)</span> row <span class="math inline">\(p\)</span>. For example:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 3 \\ -3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 7
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
2 &amp; 3 \\ 0 &amp; 6.5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
4 \\ 13
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(w\)</span> by row <span class="math inline">\(2 + 1.5 \times\)</span> row <span class="math inline">\(1\)</span>)</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2 \\ 4 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -3
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 &amp; 2 \\ 0 &amp; -7
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix} =
\begin{pmatrix}
1 \\ -7
\end{pmatrix}
\]</span></p>
<p>(here we replaced row <span class="math inline">\(2\)</span> by row <span class="math inline">\(2 + (-4) \times\)</span> row <span class="math inline">\(1\)</span>)</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="our-grand-plan---refined" class="slide level3">
<h3>Our grand plan - refined</h3>
<p>Our strategy for solving systems of linear equations using Gaussian elimination is based on the following ideas:</p>
<ul>
<li><p>The three types of operation described above are called <strong>elementary row operations</strong> (ERO).</p></li>
<li><p>We will apply a sequence of ERO to reduce an arbitrary system to a triangular form, which, we will see, can be easily solved.</p></li>
<li><p>The algorithm for reducing a general matrix to upper triangular form is known as <strong>forward elimination</strong> or (more commonly) as <strong>Gaussian elimination</strong>.</p></li>
</ul>
</section>

<section id="gaussian-elimination" class="title-slide slide level2 center">
<h2>Gaussian elimination</h2>
<p>The method is so old, in fact we have evidence of Chinese mathematicians using Gaussian elimination in 179CE (From <a href="https://en.wikipedia.org/wiki/Gaussian_elimination">Wikipedia</a>):</p>
<blockquote>
<p>The method of Gaussian elimination appears in the Chinese mathematical text Chapter Eight: Rectangular Arrays of The Nine Chapters on the Mathematical Art. Its use is illustrated in eighteen problems, with two to five equations. The first reference to the book by this title is dated to 179 CE, but parts of it were written as early as approximately 150 BCE. It was commented on by Liu Hui in the 3rd century.</p>
</blockquote>
</section>
<section id="the-algorithm" class="slide level3">
<h3>The algorithm</h3>
<p>The following algorithm systematically introduces zeros into the system of equations, below the diagonal.</p>
<ol type="1">
<li>Subtract multiples of row 1 from the rows below it to eliminate (make zero) non-zero entries in column 1.</li>
<li>Subtract multiples of the new row 2 from the rows below it to eliminate non-zero entries in column 2.</li>
<li>Repeat for row <span class="math inline">\(3, 4, \ldots, n-1\)</span>.</li>
</ol>
<p>After row <span class="math inline">\(n-1\)</span> all entities below the diagonal have been eliminated, so <span class="math inline">\(A\)</span> is now upper triangular and the resulting system can be solved by backward substitution.</p>
</section>
<section id="example-2" class="slide level3">
<h3>Example</h3>
<p>Use Gaussian elimination to reduce the following system of equations to upper triangular form:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 4 \\ 1 &amp; 2 &amp; 2 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 9 \\ 22
\end{pmatrix}.
\]</span></p>
<aside class="notes">
<p>First, use the first row to eliminate the first column below the diagonal:</p>
<ul>
<li><p>(row 2) <span class="math inline">\(- 0.5 \times\)</span> (row 1) gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ 2 &amp; 4 &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 22
\end{pmatrix}
\]</span></p></li>
<li><p>(row 3) <span class="math inline">\(-\)</span> (row 1) then gives</p>
<p><span class="math display">\[
\begin{pmatrix}
  2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; 3 &amp; 2
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
12 \\ 3 \\ 10
\end{pmatrix}
\]</span></p></li>
</ul>
<p>Now use the second row to eliminate the second column below the diagonal.</p>
<ul>
<li><p>(row 3) <span class="math inline">\(- 2 \times\)</span> (row 2) gives</p>
<p><span class="math display">\[
  \begin{pmatrix}
   2 &amp; 1 &amp; 4 \\ \mathbf{0} &amp; 1.5 &amp; 0 \\ \mathbf{0} &amp; \mathbf{0} &amp; 2
  \end{pmatrix}
  \begin{pmatrix}
  x_1 \\ x_2 \\ x_3
  \end{pmatrix} =
  \begin{pmatrix}
  12 \\ 3 \\ 4
  \end{pmatrix}
  \]</span></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise-2" class="slide level3">
<h3>Exercise</h3>
<p>Use Gaussian elimination to reduce the following system of linear equations to upper triangular form.</p>
<p><span class="math display">\[
\begin{pmatrix}
4 &amp; -1 &amp; -1 \\ 2 &amp; 4 &amp; 2 \\ 1 &amp; 2 &amp; 4
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
9 \\ -6 \\ 3
\end{pmatrix}.
\]</span></p>
</section>
<section id="key-idea" class="slide level3">
<h3>Key idea</h3>
<p>The key idea is that:</p>
<ul>
<li><p>Each row <span class="math inline">\(i\)</span> is used to eliminate the entries in column <span class="math inline">\(i\)</span> below <span class="math inline">\(a_{ii}\)</span>, i.e.&nbsp;it forces <span class="math inline">\(a_{ji} = 0\)</span> for <span class="math inline">\(j &gt; i\)</span>.</p></li>
<li><p>The elimination is done by subtracting a multiple of row <span class="math inline">\(i\)</span> from row <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[
  (\text{row } j) \leftarrow (\text{row } j) - \frac{a_{ji}}{a_{ii}}
  (\text{row } i).
  \]</span></p></li>
</ul>
<aside class="notes">
<ul>
<li><p>Our update formula guarantees that <span class="math inline">\(a_{ji}\)</span> becomes zero because</p>
<p><span class="math display">\[
  a_{ji} \leftarrow a_{ji} - \frac{a_{ji}}{a_{ii}} a_{ii} = a_{ji} - a_{ji} =
  0.
  \]</span></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="python-version-1" class="slide level3">
<h3>Python version</h3>
</section>
<section id="row-swap" class="slide level3">
<h3>Row swap</h3>
<div>
<div id="pyodide-6" class="exercise-cell">

</div>
<script type="pyodide-6-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19zd2FwKEEsIGIsIHAsIHEpOlxuICAgIFwiXCJcIlxuICAgIFN3YXAgdHdvIHJvd3MgKHAgYW5kIHEpIGluIGEgbGluZWFyIHN5c3RlbSBvZiBlcXVhdGlvbnMgaW4gcGxhY2UuXG4gICAgXCJcIlwiXG4gICAgbiA9IHN5c3RlbV9zaXplKEEsIGIpXG4gICAgLi4uIn0=
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="kw">def</span> row_swap(A, b, p, q):</span>
<span id="cb2-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href=""></a><span class="co">    Swap two rows in a linear system of equations in place.</span></span>
<span id="cb2-4"><a href=""></a></span>
<span id="cb2-5"><a href=""></a><span class="co">    This function swaps the rows `p` and `q` of the coefficient matrix `A`</span></span>
<span id="cb2-6"><a href=""></a><span class="co">    and the right-hand side vector `b` for a linear system of equations</span></span>
<span id="cb2-7"><a href=""></a><span class="co">    of the form ``Ax = b``. The operation is performed **in place**, modifying</span></span>
<span id="cb2-8"><a href=""></a><span class="co">    the input arrays directly.</span></span>
<span id="cb2-9"><a href=""></a></span>
<span id="cb2-10"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb2-11"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb2-12"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb2-13"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb2-14"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb2-15"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb2-16"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb2-17"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb2-18"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb2-19"><a href=""></a><span class="co">        The index of the first row to swap. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb2-20"><a href=""></a><span class="co">    q : int</span></span>
<span id="cb2-21"><a href=""></a><span class="co">        The index of the second row to swap. Must satisfy ``0 &lt;= q &lt; n``.</span></span>
<span id="cb2-22"><a href=""></a></span>
<span id="cb2-23"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb2-24"><a href=""></a><span class="co">    -------</span></span>
<span id="cb2-25"><a href=""></a><span class="co">    None</span></span>
<span id="cb2-26"><a href=""></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb2-27"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb2-28"><a href=""></a><span class="co">    """</span></span>
<span id="cb2-29"><a href=""></a>    <span class="co"># get system size</span></span>
<span id="cb2-30"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb2-31"><a href=""></a>    <span class="co"># swap rows of A</span></span>
<span id="cb2-32"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb2-33"><a href=""></a>        A[p, j], A[q, j] <span class="op">=</span> A[q, j], A[p, j]</span>
<span id="cb2-34"><a href=""></a>    <span class="co"># swap rows of b</span></span>
<span id="cb2-35"><a href=""></a>    b[p, <span class="dv">0</span>], b[q, <span class="dv">0</span>] <span class="op">=</span> b[q, <span class="dv">0</span>], b[p, <span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="row-swap-test" class="slide level3">
<h3>Row swap test</h3>
<div>
<div id="pyodide-7" class="exercise-cell">

</div>
<script type="pyodide-7-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwic3dhcHBpbmcgcm93cyAwIGFuZCAxXCIpXG5yb3dfc3dhcChBLCBiLCAwLCAxKSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRpbmcgZnJvbSB6ZXJvIVxucHJpbnQoKVxuXG5wcmludChcIm5ldyBhcnJheXM6XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KCkifQ==
</script>
</div>
</section>
<section id="row-scaling" class="slide level3">
<h3>Row scaling</h3>
<div>
<div id="pyodide-8" class="exercise-cell">

</div>
<script type="pyodide-8-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19zY2FsZShBLCBiLCBwLCBrKTpcbiAgICBcIlwiXCJcbiAgICBTY2FsZSBhIHJvdyAocCkgb2YgYSBsaW5lYXIgc3lzdGVtIGJ5IGEgY29uc3RhbnQgZmFjdG9yIChrKSBpbiBwbGFjZS5cbiAgICBcIlwiXCJcbiAgICBuID0gc3lzdGVtX3NpemUoQSwgYilcbiAgICAuLi4ifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="kw">def</span> row_scale(A, b, p, k):</span>
<span id="cb3-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb3-3"><a href=""></a><span class="co">    Scale a row of a linear system by a constant factor in place.</span></span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a><span class="co">    This function multiplies all entries in row `p` of the coefficient matrix</span></span>
<span id="cb3-6"><a href=""></a><span class="co">    `A` and the corresponding entry in the right-hand side vector `b` by a</span></span>
<span id="cb3-7"><a href=""></a><span class="co">    scalar `k`. The operation is performed **in place**, modifying the input</span></span>
<span id="cb3-8"><a href=""></a><span class="co">    arrays directly.</span></span>
<span id="cb3-9"><a href=""></a></span>
<span id="cb3-10"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb3-11"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb3-12"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb3-13"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb3-14"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb3-15"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb3-16"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb3-17"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb3-18"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb3-19"><a href=""></a><span class="co">        The index of the row to scale. Must satisfy ``0 &lt;= p &lt; n``.</span></span>
<span id="cb3-20"><a href=""></a><span class="co">    k : float</span></span>
<span id="cb3-21"><a href=""></a><span class="co">        The scalar multiplier applied to the entire row.</span></span>
<span id="cb3-22"><a href=""></a></span>
<span id="cb3-23"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb3-24"><a href=""></a><span class="co">    -------</span></span>
<span id="cb3-25"><a href=""></a><span class="co">    None</span></span>
<span id="cb3-26"><a href=""></a><span class="co">        This function modifies `A` and `b` directly and does not return</span></span>
<span id="cb3-27"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb3-28"><a href=""></a><span class="co">    """</span></span>
<span id="cb3-29"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb3-30"><a href=""></a></span>
<span id="cb3-31"><a href=""></a>    <span class="co"># scale row p of A</span></span>
<span id="cb3-32"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb3-33"><a href=""></a>        A[p, j] <span class="op">=</span> k <span class="op">*</span> A[p, j]</span>
<span id="cb3-34"><a href=""></a>    <span class="co"># scale row p of b</span></span>
<span id="cb3-35"><a href=""></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">*</span> k</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="row-scale-test" class="slide level3">
<h3>Row scale test</h3>
<div>
<div id="pyodide-9" class="exercise-cell">

</div>
<script type="pyodide-9-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicm93IDAgfC0+IDAuNSAqIHJvdyAwXCIpXG5yb3dfc2NhbGUoQSwgYiwgMCwgMC41KSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRlZCBmcm9tIHplcm8hXG5wcmludCgpXG5cbnByaW50KFwibmV3IGFycmF5czpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKSJ9
</script>
</div>
</section>
<section id="row-adding" class="slide level3">
<h3>Row adding</h3>
<div>
<div id="pyodide-10" class="exercise-cell">

</div>
<script type="pyodide-10-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIHJvd19hZGQoQSwgYiwgcCwgaywgcSk6XG4gICAgXCJcIlwiXG4gICAgUGVyZm9ybSBhbiBpbi1wbGFjZSByb3cgYWRkaXRpb24gb3BlcmF0aW9uIG9uIGEgbGluZWFyIHN5c3RlbS5cbiAgICByb3dfcCDihpAgcm93X3AgKyBrICogcm93X3FcbiAgICBcIlwiXCJcbiAgICBuID0gc3lzdGVtX3NpemUoQSwgYilcbiAgICAuLi4ifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="kw">def</span> row_add(A, b, p, k, q):</span>
<span id="cb4-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href=""></a><span class="co">    Perform an in-place row addition operation on a linear system.</span></span>
<span id="cb4-4"><a href=""></a></span>
<span id="cb4-5"><a href=""></a><span class="co">    This function applies the elementary row operation:</span></span>
<span id="cb4-6"><a href=""></a></span>
<span id="cb4-7"><a href=""></a><span class="co">    ``row_p â† row_p + k * row_q``</span></span>
<span id="cb4-8"><a href=""></a></span>
<span id="cb4-9"><a href=""></a><span class="co">    where `row_p` and `row_q` are rows in the coefficient matrix `A` and the</span></span>
<span id="cb4-10"><a href=""></a><span class="co">    right-hand side vector `b`. It updates the entries of `A` and `b`</span></span>
<span id="cb4-11"><a href=""></a><span class="co">    **in place**, directly modifying the original data.</span></span>
<span id="cb4-12"><a href=""></a></span>
<span id="cb4-13"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb4-14"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb4-15"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb4-16"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb4-17"><a href=""></a><span class="co">        of the linear system.</span></span>
<span id="cb4-18"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb4-19"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb4-20"><a href=""></a><span class="co">        vector of the system.</span></span>
<span id="cb4-21"><a href=""></a><span class="co">    p : int</span></span>
<span id="cb4-22"><a href=""></a><span class="co">        The index of the row to be updated (destination row). Must satisfy</span></span>
<span id="cb4-23"><a href=""></a><span class="co">        ``0 &lt;= p &lt; n``.</span></span>
<span id="cb4-24"><a href=""></a><span class="co">    k : float</span></span>
<span id="cb4-25"><a href=""></a><span class="co">        The scalar multiplier applied to `row_q` before adding it to `row_p`.</span></span>
<span id="cb4-26"><a href=""></a><span class="co">    q : int</span></span>
<span id="cb4-27"><a href=""></a><span class="co">        The index of the source row to be scaled and added. Must satisfy</span></span>
<span id="cb4-28"><a href=""></a><span class="co">        ``0 &lt;= q &lt; n``.</span></span>
<span id="cb4-29"><a href=""></a><span class="co">    """</span></span>
<span id="cb4-30"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb4-31"><a href=""></a></span>
<span id="cb4-32"><a href=""></a>    <span class="co"># Perform the row operation</span></span>
<span id="cb4-33"><a href=""></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb4-34"><a href=""></a>        A[p, j] <span class="op">=</span> A[p, j] <span class="op">+</span> k <span class="op">*</span> A[q, j]</span>
<span id="cb4-35"><a href=""></a></span>
<span id="cb4-36"><a href=""></a>    <span class="co"># Update the corresponding value in b</span></span>
<span id="cb4-37"><a href=""></a>    b[p, <span class="dv">0</span>] <span class="op">=</span> b[p, <span class="dv">0</span>] <span class="op">+</span> k <span class="op">*</span> b[q, <span class="dv">0</span>]</span>
<span id="cb4-38"><a href=""></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="row-adding-test" class="slide level3">
<h3>Row adding test</h3>
<div>
<div id="pyodide-11" class="exercise-cell">

</div>
<script type="pyodide-11-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAzLjBdLCBbLTMuMCwgMi4wXV0pXG5iID0gbnAuYXJyYXkoW1s0LjBdLCBbNy4wXV0pXG5cbnByaW50KFwic3RhcnRpbmcgYXJyYXlzOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicm93IDEgfC0+IHJvdyAxICsgMS41ICogcm93IDBcIilcbnJvd19hZGQoQSwgYiwgMSwgMS41LCAwKSAgIyByZW1lbWJlciBudW1weSBhcnJheXMgYXJlIGluZGV4ZWQgc3RhcnRlZCBmcm9tIHplcm8hXG5wcmludCgpXG5cbnByaW50KFwibmV3IGFycmF5czpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKVxuIn0=
</script>
</div>
</section>
<section id="gaussian-elimination-definition" class="slide level3">
<h3>Gaussian elimination definition</h3>
<p>Now we can define our Gaussian elimination function. We update the values in-place to avoid extra memory allocations.</p>
<div>
<div id="pyodide-12" class="exercise-cell">

</div>
<script type="pyodide-12-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGdhdXNzaWFuX2VsaW1pbmF0aW9uKEEsIGIsIHZlcmJvc2U9RmFsc2UpOlxuICAgIFwiXCJcIlxuICAgIFBlcmZvcm0gR2F1c3NpYW4gZWxpbWluYXRpb24gdG8gcmVkdWNlIGEgbGluZWFyIHN5c3RlbSB0byB1cHBlciB0cmlhbmd1bGFyXG4gICAgZm9ybS5cbiAgICBcIlwiXCJcbiAgICAuLi4ifQ==
</script>
</div>
<aside class="notes">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a><span class="kw">def</span> gaussian_elimination(A, b, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb5-2"><a href=""></a>    <span class="co">"""</span></span>
<span id="cb5-3"><a href=""></a><span class="co">    Perform Gaussian elimination to reduce a linear system to upper triangular</span></span>
<span id="cb5-4"><a href=""></a><span class="co">    form.</span></span>
<span id="cb5-5"><a href=""></a></span>
<span id="cb5-6"><a href=""></a><span class="co">    This function performs **forward elimination** to transform the coefficient</span></span>
<span id="cb5-7"><a href=""></a><span class="co">    matrix `A` into an upper triangular matrix, while applying the same</span></span>
<span id="cb5-8"><a href=""></a><span class="co">    operations to the right-hand side vector `b`. This is the first step in</span></span>
<span id="cb5-9"><a href=""></a><span class="co">    solving a linear system of equations of the form ``Ax = b`` using Gaussian</span></span>
<span id="cb5-10"><a href=""></a><span class="co">    elimination.</span></span>
<span id="cb5-11"><a href=""></a></span>
<span id="cb5-12"><a href=""></a><span class="co">    Parameters</span></span>
<span id="cb5-13"><a href=""></a><span class="co">    ----------</span></span>
<span id="cb5-14"><a href=""></a><span class="co">    A : numpy.ndarray</span></span>
<span id="cb5-15"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, n)`` representing the coefficient matrix</span></span>
<span id="cb5-16"><a href=""></a><span class="co">        of the system.</span></span>
<span id="cb5-17"><a href=""></a><span class="co">    b : numpy.ndarray</span></span>
<span id="cb5-18"><a href=""></a><span class="co">        A 2D NumPy array of shape ``(n, 1)`` representing the right-hand side</span></span>
<span id="cb5-19"><a href=""></a><span class="co">        vector.</span></span>
<span id="cb5-20"><a href=""></a><span class="co">    verbose : bool, optional</span></span>
<span id="cb5-21"><a href=""></a><span class="co">        If ``True``, prints detailed information about each elimination step,</span></span>
<span id="cb5-22"><a href=""></a><span class="co">        including the row operations performed and the intermediate forms of</span></span>
<span id="cb5-23"><a href=""></a><span class="co">        `A` and `b`. Default is ``False``.</span></span>
<span id="cb5-24"><a href=""></a></span>
<span id="cb5-25"><a href=""></a><span class="co">    Returns</span></span>
<span id="cb5-26"><a href=""></a><span class="co">    -------</span></span>
<span id="cb5-27"><a href=""></a><span class="co">    None</span></span>
<span id="cb5-28"><a href=""></a><span class="co">        This function modifies `A` and `b` **in place** and does not return</span></span>
<span id="cb5-29"><a href=""></a><span class="co">        anything.</span></span>
<span id="cb5-30"><a href=""></a><span class="co">    """</span></span>
<span id="cb5-31"><a href=""></a>    <span class="co"># find shape of system</span></span>
<span id="cb5-32"><a href=""></a>    n <span class="op">=</span> system_size(A, b)</span>
<span id="cb5-33"><a href=""></a></span>
<span id="cb5-34"><a href=""></a>    <span class="co"># perform forwards elimination</span></span>
<span id="cb5-35"><a href=""></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb5-36"><a href=""></a>        <span class="co"># eliminate column i</span></span>
<span id="cb5-37"><a href=""></a>        <span class="cf">if</span> verbose:</span>
<span id="cb5-38"><a href=""></a>            <span class="bu">print</span>(<span class="ss">f"eliminating column </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-39"><a href=""></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb5-40"><a href=""></a>            <span class="co"># row j</span></span>
<span id="cb5-41"><a href=""></a>            factor <span class="op">=</span> A[j, i] <span class="op">/</span> A[i, i]</span>
<span id="cb5-42"><a href=""></a>            <span class="cf">if</span> verbose:</span>
<span id="cb5-43"><a href=""></a>                <span class="bu">print</span>(<span class="ss">f"  row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> |-&gt; row </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss"> * row </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-44"><a href=""></a>            row_add(A, b, j, <span class="op">-</span>factor, i)</span>
<span id="cb5-45"><a href=""></a></span>
<span id="cb5-46"><a href=""></a>        <span class="cf">if</span> verbose:</span>
<span id="cb5-47"><a href=""></a>            <span class="bu">print</span>()</span>
<span id="cb5-48"><a href=""></a>            <span class="bu">print</span>(<span class="st">"new system"</span>)</span>
<span id="cb5-49"><a href=""></a>            print_array(A)</span>
<span id="cb5-50"><a href=""></a>            print_array(b)</span>
<span id="cb5-51"><a href=""></a>            <span class="bu">print</span>()</span>
<span id="cb5-52"><a href=""></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-3" class="slide level3">
<h3>Example</h3>
<p>We can try our code on Example 1:</p>
<div>
<div id="pyodide-13" class="exercise-cell">

</div>
<script type="pyodide-13-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIEVsaW1pbmF0aW9uXCIpXG5nYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiLCB2ZXJib3NlPVRydWUpXG5wcmludCgpXG5cbnByaW50KFwiZmluYWwgc3lzdGVtOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbiMgdGVzdCB0aGF0IEEgaXMgcmVhbGx5IHVwcGVyIHRyaWFuZ3VsYXJcbnByaW50KFwiSXMgQSByZWFsbHkgdXBwZXIgdHJpYW5ndWxhcj9cIiwgbnAuYWxsY2xvc2UoQSwgbnAudHJpdShBKSkpXG4ifQ==
</script>
</div>
</section>

<section id="combining-gaussian-elimination-and-backward-substitution" class="title-slide slide level2 center">
<h2>Combining Gaussian elimination and backward substitution</h2>
<p>Our grand strategy can now come together so we have a method to solve systems of linear equations:</p>
<p>Given a system of linear equations <span class="math inline">\(A\vec{x} = \vec{b}\)</span>;</p>
<ul>
<li>First perform Gaussian elimination to give an equivalent system of equations in upper triangular form;</li>
<li>Then use backward substitution to produce a solution <span class="math inline">\(\vec{x}\)</span></li>
</ul>
</section>
<section id="try-it-out" class="slide level3">
<h3>Try it out!</h3>
<div>
<div id="pyodide-14" class="exercise-cell">

</div>
<script type="pyodide-14-contents">
eyJhdHRyIjp7ImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZSwiaW5jbHVkZSI6ZmFsc2UsIm91dHB1dCI6ZmFsc2V9LCJjb2RlIjoiXG5kZWYgcm93X3N3YXAoQSwgYiwgcCwgcSk6XG4gICAgXCJcIlwiXG4gICAgU3dhcCB0d28gcm93cyBpbiBhIGxpbmVhciBzeXN0ZW0gb2YgZXF1YXRpb25zIGluIHBsYWNlLlxuXG4gICAgVGhpcyBmdW5jdGlvbiBzd2FwcyB0aGUgcm93cyBgcGAgYW5kIGBxYCBvZiB0aGUgY29lZmZpY2llbnQgbWF0cml4IGBBYFxuICAgIGFuZCB0aGUgcmlnaHQtaGFuZCBzaWRlIHZlY3RvciBgYmAgZm9yIGEgbGluZWFyIHN5c3RlbSBvZiBlcXVhdGlvbnNcbiAgICBvZiB0aGUgZm9ybSBgYEF4ID0gYmBgLiBUaGUgb3BlcmF0aW9uIGlzIHBlcmZvcm1lZCAqKmluIHBsYWNlKiosIG1vZGlmeWluZ1xuICAgIHRoZSBpbnB1dCBhcnJheXMgZGlyZWN0bHkuXG5cbiAgICBQYXJhbWV0ZXJzXG4gICAgLS0tLS0tLS0tLVxuICAgIEEgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMkQgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwgbilgYCByZXByZXNlbnRpbmcgdGhlIGNvZWZmaWNpZW50IG1hdHJpeFxuICAgICAgICBvZiB0aGUgbGluZWFyIHN5c3RlbS5cbiAgICBiIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIDEpYGAgcmVwcmVzZW50aW5nIHRoZSByaWdodC1oYW5kIHNpZGVcbiAgICAgICAgdmVjdG9yIG9mIHRoZSBzeXN0ZW0uXG4gICAgcCA6IGludFxuICAgICAgICBUaGUgaW5kZXggb2YgdGhlIGZpcnN0IHJvdyB0byBzd2FwLiBNdXN0IHNhdGlzZnkgYGAwIDw9IHAgPCBuYGAuXG4gICAgcSA6IGludFxuICAgICAgICBUaGUgaW5kZXggb2YgdGhlIHNlY29uZCByb3cgdG8gc3dhcC4gTXVzdCBzYXRpc2Z5IGBgMCA8PSBxIDwgbmBgLlxuXG4gICAgUmV0dXJuc1xuICAgIC0tLS0tLS1cbiAgICBOb25lXG4gICAgICAgIFRoaXMgZnVuY3Rpb24gbW9kaWZpZXMgYEFgIGFuZCBgYmAgZGlyZWN0bHkgYW5kIGRvZXMgbm90IHJldHVyblxuICAgICAgICBhbnl0aGluZy5cbiAgICBcIlwiXCJcbiAgICAjIGdldCBzeXN0ZW0gc2l6ZVxuICAgIG4gPSBzeXN0ZW1fc2l6ZShBLCBiKVxuICAgICMgc3dhcCByb3dzIG9mIEFcbiAgICBmb3IgaiBpbiByYW5nZShuKTpcbiAgICAgICAgQVtwLCBqXSwgQVtxLCBqXSA9IEFbcSwgal0sIEFbcCwgal1cbiAgICAjIHN3YXAgcm93cyBvZiBiXG4gICAgYltwLCAwXSwgYltxLCAwXSA9IGJbcSwgMF0sIGJbcCwgMF1cblxuXG5kZWYgcm93X3NjYWxlKEEsIGIsIHAsIGspOlxuICAgIFwiXCJcIlxuICAgIFNjYWxlIGEgcm93IG9mIGEgbGluZWFyIHN5c3RlbSBieSBhIGNvbnN0YW50IGZhY3RvciBpbiBwbGFjZS5cblxuICAgIFRoaXMgZnVuY3Rpb24gbXVsdGlwbGllcyBhbGwgZW50cmllcyBpbiByb3cgYHBgIG9mIHRoZSBjb2VmZmljaWVudCBtYXRyaXhcbiAgICBgQWAgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGVudHJ5IGluIHRoZSByaWdodC1oYW5kIHNpZGUgdmVjdG9yIGBiYCBieSBhXG4gICAgc2NhbGFyIGBrYC4gVGhlIG9wZXJhdGlvbiBpcyBwZXJmb3JtZWQgKippbiBwbGFjZSoqLCBtb2RpZnlpbmcgdGhlIGlucHV0XG4gICAgYXJyYXlzIGRpcmVjdGx5LlxuXG4gICAgUGFyYW1ldGVyc1xuICAgIC0tLS0tLS0tLS1cbiAgICBBIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIG4pYGAgcmVwcmVzZW50aW5nIHRoZSBjb2VmZmljaWVudCBtYXRyaXhcbiAgICAgICAgb2YgdGhlIGxpbmVhciBzeXN0ZW0uXG4gICAgYiA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAyRCBOdW1QeSBhcnJheSBvZiBzaGFwZSBgYChuLCAxKWBgIHJlcHJlc2VudGluZyB0aGUgcmlnaHQtaGFuZCBzaWRlXG4gICAgICAgIHZlY3RvciBvZiB0aGUgc3lzdGVtLlxuICAgIHAgOiBpbnRcbiAgICAgICAgVGhlIGluZGV4IG9mIHRoZSByb3cgdG8gc2NhbGUuIE11c3Qgc2F0aXNmeSBgYDAgPD0gcCA8IG5gYC5cbiAgICBrIDogZmxvYXRcbiAgICAgICAgVGhlIHNjYWxhciBtdWx0aXBsaWVyIGFwcGxpZWQgdG8gdGhlIGVudGlyZSByb3cuXG5cbiAgICBSZXR1cm5zXG4gICAgLS0tLS0tLVxuICAgIE5vbmVcbiAgICAgICAgVGhpcyBmdW5jdGlvbiBtb2RpZmllcyBgQWAgYW5kIGBiYCBkaXJlY3RseSBhbmQgZG9lcyBub3QgcmV0dXJuXG4gICAgICAgIGFueXRoaW5nLlxuICAgIFwiXCJcIlxuICAgIG4gPSBzeXN0ZW1fc2l6ZShBLCBiKVxuXG4gICAgIyBzY2FsZSByb3cgcCBvZiBBXG4gICAgZm9yIGogaW4gcmFuZ2Uobik6XG4gICAgICAgIEFbcCwgal0gPSBrICogQVtwLCBqXVxuICAgICMgc2NhbGUgcm93IHAgb2YgYlxuICAgIGJbcCwgMF0gPSBiW3AsIDBdICoga1xuXG5cbmRlZiByb3dfYWRkKEEsIGIsIHAsIGssIHEpOlxuICAgIFwiXCJcIlxuICAgIFBlcmZvcm0gYW4gaW4tcGxhY2Ugcm93IGFkZGl0aW9uIG9wZXJhdGlvbiBvbiBhIGxpbmVhciBzeXN0ZW0uXG5cbiAgICBUaGlzIGZ1bmN0aW9uIGFwcGxpZXMgdGhlIGVsZW1lbnRhcnkgcm93IG9wZXJhdGlvbjpcblxuICAgIGBgcm93X3Ag4oaQIHJvd19wICsgayAqIHJvd19xYGBcblxuICAgIHdoZXJlIGByb3dfcGAgYW5kIGByb3dfcWAgYXJlIHJvd3MgaW4gdGhlIGNvZWZmaWNpZW50IG1hdHJpeCBgQWAgYW5kIHRoZVxuICAgIHJpZ2h0LWhhbmQgc2lkZSB2ZWN0b3IgYGJgLiBJdCB1cGRhdGVzIHRoZSBlbnRyaWVzIG9mIGBBYCBhbmQgYGJgXG4gICAgKippbiBwbGFjZSoqLCBkaXJlY3RseSBtb2RpZnlpbmcgdGhlIG9yaWdpbmFsIGRhdGEuXG5cbiAgICBQYXJhbWV0ZXJzXG4gICAgLS0tLS0tLS0tLVxuICAgIEEgOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgMkQgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwgbilgYCByZXByZXNlbnRpbmcgdGhlIGNvZWZmaWNpZW50IG1hdHJpeFxuICAgICAgICBvZiB0aGUgbGluZWFyIHN5c3RlbS5cbiAgICBiIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIDEpYGAgcmVwcmVzZW50aW5nIHRoZSByaWdodC1oYW5kIHNpZGVcbiAgICAgICAgdmVjdG9yIG9mIHRoZSBzeXN0ZW0uXG4gICAgcCA6IGludFxuICAgICAgICBUaGUgaW5kZXggb2YgdGhlIHJvdyB0byBiZSB1cGRhdGVkIChkZXN0aW5hdGlvbiByb3cpLiBNdXN0IHNhdGlzZnlcbiAgICAgICAgYGAwIDw9IHAgPCBuYGAuXG4gICAgayA6IGZsb2F0XG4gICAgICAgIFRoZSBzY2FsYXIgbXVsdGlwbGllciBhcHBsaWVkIHRvIGByb3dfcWAgYmVmb3JlIGFkZGluZyBpdCB0byBgcm93X3BgLlxuICAgIHEgOiBpbnRcbiAgICAgICAgVGhlIGluZGV4IG9mIHRoZSBzb3VyY2Ugcm93IHRvIGJlIHNjYWxlZCBhbmQgYWRkZWQuIE11c3Qgc2F0aXNmeVxuICAgICAgICBgYDAgPD0gcSA8IG5gYC5cbiAgICBcIlwiXCJcbiAgICBuID0gc3lzdGVtX3NpemUoQSwgYilcblxuICAgICMgUGVyZm9ybSB0aGUgcm93IG9wZXJhdGlvblxuICAgIGZvciBqIGluIHJhbmdlKG4pOlxuICAgICAgICBBW3AsIGpdID0gQVtwLCBqXSArIGsgKiBBW3EsIGpdXG5cbiAgICAjIFVwZGF0ZSB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBpbiBiXG4gICAgYltwLCAwXSA9IGJbcCwgMF0gKyBrICogYltxLCAwXVxuXG5cbmRlZiBnYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiLCB2ZXJib3NlPUZhbHNlKTpcbiAgICBcIlwiXCJcbiAgICBQZXJmb3JtIEdhdXNzaWFuIGVsaW1pbmF0aW9uIHRvIHJlZHVjZSBhIGxpbmVhciBzeXN0ZW0gdG8gdXBwZXIgdHJpYW5ndWxhclxuICAgIGZvcm0uXG5cbiAgICBUaGlzIGZ1bmN0aW9uIHBlcmZvcm1zICoqZm9yd2FyZCBlbGltaW5hdGlvbioqIHRvIHRyYW5zZm9ybSB0aGUgY29lZmZpY2llbnRcbiAgICBtYXRyaXggYEFgIGludG8gYW4gdXBwZXIgdHJpYW5ndWxhciBtYXRyaXgsIHdoaWxlIGFwcGx5aW5nIHRoZSBzYW1lXG4gICAgb3BlcmF0aW9ucyB0byB0aGUgcmlnaHQtaGFuZCBzaWRlIHZlY3RvciBgYmAuIFRoaXMgaXMgdGhlIGZpcnN0IHN0ZXAgaW5cbiAgICBzb2x2aW5nIGEgbGluZWFyIHN5c3RlbSBvZiBlcXVhdGlvbnMgb2YgdGhlIGZvcm0gYGBBeCA9IGJgYCB1c2luZyBHYXVzc2lhblxuICAgIGVsaW1pbmF0aW9uLlxuXG4gICAgUGFyYW1ldGVyc1xuICAgIC0tLS0tLS0tLS1cbiAgICBBIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIG4pYGAgcmVwcmVzZW50aW5nIHRoZSBjb2VmZmljaWVudCBtYXRyaXhcbiAgICAgICAgb2YgdGhlIHN5c3RlbS5cbiAgICBiIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDJEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sIDEpYGAgcmVwcmVzZW50aW5nIHRoZSByaWdodC1oYW5kIHNpZGVcbiAgICAgICAgdmVjdG9yLlxuICAgIHZlcmJvc2UgOiBib29sLCBvcHRpb25hbFxuICAgICAgICBJZiBgYFRydWVgYCwgcHJpbnRzIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IGVhY2ggZWxpbWluYXRpb24gc3RlcCxcbiAgICAgICAgaW5jbHVkaW5nIHRoZSByb3cgb3BlcmF0aW9ucyBwZXJmb3JtZWQgYW5kIHRoZSBpbnRlcm1lZGlhdGUgZm9ybXMgb2ZcbiAgICAgICAgYEFgIGFuZCBgYmAuIERlZmF1bHQgaXMgYGBGYWxzZWBgLlxuXG4gICAgUmV0dXJuc1xuICAgIC0tLS0tLS1cbiAgICBOb25lXG4gICAgICAgIFRoaXMgZnVuY3Rpb24gbW9kaWZpZXMgYEFgIGFuZCBgYmAgKippbiBwbGFjZSoqIGFuZCBkb2VzIG5vdCByZXR1cm5cbiAgICAgICAgYW55dGhpbmcuXG4gICAgXCJcIlwiXG4gICAgIyBmaW5kIHNoYXBlIG9mIHN5c3RlbVxuICAgIG4gPSBzeXN0ZW1fc2l6ZShBLCBiKVxuXG4gICAgIyBwZXJmb3JtIGZvcndhcmRzIGVsaW1pbmF0aW9uXG4gICAgZm9yIGkgaW4gcmFuZ2UobiAtIDEpOlxuICAgICAgICAjIGVsaW1pbmF0ZSBjb2x1bW4gaVxuICAgICAgICBpZiB2ZXJib3NlOlxuICAgICAgICAgICAgcHJpbnQoZlwiZWxpbWluYXRpbmcgY29sdW1uIHtpfVwiKVxuICAgICAgICBmb3IgaiBpbiByYW5nZShpICsgMSwgbik6XG4gICAgICAgICAgICAjIHJvdyBqXG4gICAgICAgICAgICBmYWN0b3IgPSBBW2osIGldIC8gQVtpLCBpXVxuICAgICAgICAgICAgaWYgdmVyYm9zZTpcbiAgICAgICAgICAgICAgICBwcmludChmXCIgIHJvdyB7an0gfC0+IHJvdyB7an0gLSB7ZmFjdG9yfSAqIHJvdyB7aX1cIilcbiAgICAgICAgICAgIHJvd19hZGQoQSwgYiwgaiwgLWZhY3RvciwgaSlcblxuICAgICAgICBpZiB2ZXJib3NlOlxuICAgICAgICAgICAgcHJpbnQoKVxuICAgICAgICAgICAgcHJpbnQoXCJuZXcgc3lzdGVtXCIpXG4gICAgICAgICAgICBwcmludF9hcnJheShBKVxuICAgICAgICAgICAgcHJpbnRfYXJyYXkoYilcbiAgICAgICAgICAgIHByaW50KClcblxuXG5kZWYgYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpOlxuICAgIFwiXCJcIlxuICAgIFNvbHZlIGFuIHVwcGVyIHRyaWFuZ3VsYXIgc3lzdGVtIG9mIGxpbmVhciBlcXVhdGlvbnMgdXNpbmcgYmFja3dhcmRcbiAgICBzdWJzdGl0dXRpb24uXG5cbiAgICBUaGlzIGZ1bmN0aW9uIHNvbHZlcyB0aGUgc3lzdGVtIG9mIGVxdWF0aW9uczpcblxuICAgIC4uIG1hdGg6OlxuICAgICAgICBBIHggPSBiXG5cbiAgICB3aGVyZSBgQWAgaXMgYW4gKip1cHBlciB0cmlhbmd1bGFyIG1hdHJpeCoqIChhbGwgZWxlbWVudHMgYmVsb3cgdGhlIG1haW5cbiAgICBkaWFnb25hbCBhcmUgemVybykuIFRoZSBzb2x1dGlvbiB2ZWN0b3IgYHhgIGlzIGNvbXB1dGVkIHN0YXJ0aW5nIGZyb20gdGhlXG4gICAgbGFzdCBlcXVhdGlvbiBhbmQgcHJvY2VlZGluZyBiYWNrd2FyZC5cblxuICAgIFBhcmFtZXRlcnNcbiAgICAtLS0tLS0tLS0tXG4gICAgQSA6IG51bXB5Lm5kYXJyYXlcbiAgICAgICAgQSAyRCBOdW1QeSBhcnJheSBvZiBzaGFwZSBgYChuLCBuKWBgIHJlcHJlc2VudGluZyB0aGUgdXBwZXIgdHJpYW5ndWxhclxuICAgICAgICBjb2VmZmljaWVudCBtYXRyaXggb2YgdGhlIHN5c3RlbS5cbiAgICBiIDogbnVtcHkubmRhcnJheVxuICAgICAgICBBIDFEIE51bVB5IGFycmF5IG9mIHNoYXBlIGBgKG4sKWBgIG9yIGEgMkQgTnVtUHkgYXJyYXkgb2Ygc2hhcGVcbiAgICAgICAgYGAobiwgMSlgYCByZXByZXNlbnRpbmcgdGhlIHJpZ2h0LWhhbmQgc2lkZSB2ZWN0b3IuXG5cbiAgICBSZXR1cm5zXG4gICAgLS0tLS0tLVxuICAgIHggOiBudW1weS5uZGFycmF5XG4gICAgICAgIEEgTnVtUHkgYXJyYXkgb2Ygc2hhcGUgYGAobiwpYGAgY29udGFpbmluZyB0aGUgc29sdXRpb24gdmVjdG9yLlxuICAgIFwiXCJcIlxuICAgICMgZ2V0IHNpemUgb2Ygc3lzdGVtXG4gICAgbiA9IHN5c3RlbV9zaXplKEEsIGIpXG5cbiAgICAjIGNoZWNrIGlzIHVwcGVyIHRyaWFuZ3VsYXJcbiAgICBhc3NlcnQgbnAuYWxsY2xvc2UoQSwgbnAudHJpdShBKSlcblxuICAgICMgY3JlYXRlIHNvbHV0aW9uIHZhcmlhYmxlXG4gICAgeCA9IG5wLmVtcHR5X2xpa2UoYilcblxuICAgICMgcGVyZm9ybSBiYWNrd2FyZHMgc29sdmVcbiAgICBmb3IgaSBpbiByYW5nZShuIC0gMSwgLTEsIC0xKTogICMgaXRlcmF0ZSBvdmVyIHJvd3MgYmFja3dhcmRzXG4gICAgICAgIHBhcnRpYWxfc3VtID0gMC4wXG4gICAgICAgIGZvciBqIGluIHJhbmdlKGkgKyAxLCBuKTpcbiAgICAgICAgICAgIHBhcnRpYWxfc3VtICs9IEFbaSwgal0gKiB4W2pdXG4gICAgICAgIHhbaV0gPSAxLjAgLyBBW2ksIGldICogKGJbaV0gLSBwYXJ0aWFsX3N1bSlcblxuICAgIHJldHVybiB4XG4ifQ==
</script>
</div>
<p>We can use our code to test this:</p>
<div>
<div id="pyodide-15" class="exercise-cell">

</div>
<script type="pyodide-15-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIEVsaW1pbmF0aW9uXCIpXG5nYXVzc2lhbl9lbGltaW5hdGlvbihBLCBiLCB2ZXJib3NlPVRydWUpXG5wcmludCgpXG5cbnByaW50KFwidXBwZXIgdHJpYW5ndWxhciBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJTb2x2aW5nIHRoZSBzeXN0ZW0gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uXCIpXG54ID0gYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpXG5wcmludCgpXG5cbnByaW50KFwic29sdXRpb24gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uOlwiKVxucHJpbnRfYXJyYXkoeClcbnByaW50KClcblxuQSA9IG5wLmFycmF5KFtbMi4wLCAxLjAsIDQuMF0sIFsxLjAsIDIuMCwgMi4wXSwgWzIuMCwgNC4wLCA2LjBdXSlcbmIgPSBucC5hcnJheShbWzEyLjBdLCBbOS4wXSwgWzIyLjBdXSlcbnByaW50KFwiRG9lcyB4IHJlYWxseSBzb2x2ZSB0aGUgb3JpZ2luYWwgc3lzdGVtP1wiLCBucC5hbGxjbG9zZShBIEAgeCwgYikpIn0=
</script>
</div>
</section>
<section id="exercise-3" class="slide level3">
<h3>Exercise</h3>
<p>Use Gaussian elimination followed by backwards elimination to solve the system: <span class="math display">\[\begin{equation*}
\begin{pmatrix}
2 &amp; 1 &amp; -1 \\
4 &amp; 5 &amp; 7 \\
-8 &amp; -3 &amp; 3
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix} =
\begin{pmatrix}
6 \\ 30 \\ -22
\end{pmatrix}.
\end{equation*}\]</span></p>
</section>

<section id="the-cost-of-gaussian-elimination" class="title-slide slide level2 center">
<h2>The cost of Gaussian Elimination</h2>
<p>Gaussian elimination (GE) is unnecessarily expensive when it is applied to many systems of equations with the same matrix <span class="math inline">\(A\)</span> but different right-hand sides <span class="math inline">\(\vec{b}\)</span>.</p>
<ul>
<li>The forward elimination process is the most computationally expensive part at <span class="math inline">\(O(n^3)\)</span> but is exactly the same for any choice of <span class="math inline">\(\vec{b}\)</span>.</li>
<li>In contrast, the solution of the resulting upper triangular system only requires <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
</section>
<section id="timing-plot" class="slide level3">
<h3>Timing plot</h3>
<div id="2d9a54dd" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lec03_files/figure-revealjs/cell-4-output-1.png" width="822" height="431"></p>
<figcaption>Runtime cost of applying Gaussian elimination (GE) and backwards solution (BS).</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="sec-LU-factorisation" class="title-slide slide level2 center">
<h2>LU factorisation</h2>
<p>Recall the elementary row operations (EROs) from above. Note that the EROs can be produced by left multiplication with a suitable matrix:</p>
<ul>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 1 &amp; 0
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ g &amp; h &amp; i \\ d &amp; e &amp; f
\end{pmatrix}
\]</span></p></li>
</ul>
</section>
<section id="elementary-row-operations-visited" class="slide level3">
<h3>Elementary row operations (visited)</h3>
<ul>
<li><p>Row swap:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c &amp; d \\ e &amp; f &amp; g &amp; h \\ i &amp; j &amp; k &amp; l \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c &amp; d \\ i &amp; j &amp; k &amp; l \\ e &amp; f &amp; g &amp; h \\ m &amp; n &amp; o &amp; p
\end{pmatrix}
\]</span></p></li>
<li><p>Multiply row by <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
\alpha &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
\alpha a &amp; \alpha b &amp; \alpha c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
\]</span></p></li>
<li><p><span class="math inline">\(\alpha \times \text{row } p + \text{row } q\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ \alpha &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i
\end{pmatrix}
= \begin{pmatrix}
a &amp; b &amp; c \\ d &amp; e &amp; f \\ \alpha a + g &amp; \alpha b + h &amp; \alpha c + i
\end{pmatrix}
\]</span></p></li>
</ul>
</section>
<section id="the-key-idea" class="slide level3">
<h3>The key idea</h3>
<p>Since Gaussian elimination (GE) is just a sequence of EROs and each ERO is just multiplication by a suitable matrix, say <span class="math inline">\(E_k\)</span>, forward elimination applied to the system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> can be expressed as <span class="math display">\[
(E_m \cdots E_1) A \vec{x} = (E_m \cdots E_1) \vec{b},
\]</span> here <span class="math inline">\(m\)</span> is the number of EROs required to reduce the upper triangular form.</p>
</section>
<section id="the-key-idea-ii" class="slide level3">
<h3>The key idea ii</h3>
<p>Let <span class="math inline">\(U = (E_m \cdots E_1) A\)</span> and <span class="math inline">\(L = (E_m \cdots E_1)^{-1}\)</span>. Now the original system <span class="math inline">\(A \vec{x} = \vec{b}\)</span> is equivalent to</p>
<p><span class="math display">\[\begin{equation}
\label{eq:LU}
L U \vec{x} = \vec{b}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(U\)</span> is <em>upper triangular</em> (by construction) and <span class="math inline">\(L\)</span> may be shown to be lower triangular (provided the EROs do not include any row swaps).</p>
</section>
<section id="the-cost-of-lu-factorisation" class="slide level3">
<h3>The cost of <span class="math inline">\(LU\)</span> factorisation</h3>
<p>Once <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> are known it is easy to solve <span class="math inline">\(\eqref{eq:LU}\)</span></p>
<ul>
<li>Solve <span class="math inline">\(L \vec{z} = \vec{b}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
<li>Solve <span class="math inline">\(U \vec{x} = \vec{z}\)</span> in <span class="math inline">\(O(n^2)\)</span> operations.</li>
</ul>
<p><span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> may be found in <span class="math inline">\(O(n^3)\)</span> operations by performing GE and saving the <span class="math inline">\(E_i\)</span> matrices: however, it is more convenient to find them directly (also <span class="math inline">\(O(n^3)\)</span> operations).</p>
</section>

<section id="effects-of-finite-precision-arithmetic" class="title-slide slide level2 center">
<h2>Effects of finite precision arithmetic</h2>
<p>Consider the following linear system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
0 &amp; 2 &amp; 1 \\
2 &amp; 1 &amp; 0 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 4 \\ 5
\end{pmatrix}
\]</span></p>
<aside class="notes">
<p><em>Problem</em>. We cannot eliminate the first column by the diagonal by adding multiples of row 1 to rows 2 and 3, respectively.</p>
<p><em>Solution</em>. Swap the order of the equations!</p>
<ul>
<li><p>Swap rows 1 and 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
1 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
4 \\ 7 \\ 5
\end{pmatrix}
\]</span></p></li>
<li><p>Now apply Gaussian elimination</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 1.5 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ 3
\end{pmatrix} \\
\begin{pmatrix}
2 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; 1 \\
0 &amp; 0 &amp; -0.75
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
&amp;= \begin{pmatrix}
4 \\ 7 \\ -2.25
\end{pmatrix}.
\end{align*}\]</span></p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-2-1" class="slide level3">
<h3>Example 2</h3>
<p>Consider another system of equations</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
4 &amp; 2 &amp; 1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ 5 \\ 2
\end{pmatrix}
\]</span></p>
<aside class="notes">
<ul>
<li><p>Apply Gaussian elimination as usual:</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
2 &amp; 2 &amp; 0
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ 2
\end{pmatrix}
\\
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
0 &amp; 1 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\end{align*}\]</span></p></li>
<li><p><em>Problem</em>. We cannot eliminate the second column below the diagonal by adding a multiple of row 2 to row 3.</p></li>
<li><p>Again, this problem may be overcome simply by swapping the order of the equations â€“ this time, swapping rows 2 and 3:</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; -1 \\
0 &amp; 0 &amp; -1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
3 \\ -1 \\ -1
\end{pmatrix}
\]</span></p></li>
<li><p>We can now continue the Gaussian elimination process as usual.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-problem" class="slide level3">
<h3>The problem</h3>
<p><em>In general</em>, Gaussian elimination requires row swaps to avoid breaking down when there is a zero in the â€œpivotâ€ position.</p>
<p>Avoiding zero-division might be a familiar aspect of Gaussian elimination, but there is an additional reason to apply pivoting when working with floating point numbers:</p>
</section>
<section id="example-3-1" class="slide level3">
<h3>Example 3</h3>
<p>Consider using Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
1 &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<aside class="notes">
<ul>
<li><p>The true, unique solution is <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>If <span class="math inline">\(\varepsilon \neq 0\)</span>, Gaussian elimination gives</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon &amp; 1 \\
0 &amp; 1 - \frac{1}{\varepsilon}
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
2 + \varepsilon \\ 3 - \frac{2 + \varepsilon}{\varepsilon}
\end{pmatrix}
\]</span></p></li>
<li><p>Problems occur not only when <span class="math inline">\(\varepsilon = 0\)</span> but also when it is very small, i.e.&nbsp;when <span class="math inline">\(\frac{1}{\varepsilon}\)</span> is very large, which will introduce very significant rounding errors into the computation.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-3-ii" class="slide level3">
<h3>Example 3 ii</h3>
<p>Use Gaussian elimination to solve the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
\varepsilon &amp; 1
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(\varepsilon \neq 1\)</span>.</p>
<aside class="notes">
<ul>
<li><p>The true solution is still <span class="math inline">\((x_1, x_2)^T = (1, 2)^T\)</span>.</p></li>
<li><p>Gaussian elimination now gives</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1 - \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
= \begin{pmatrix}
3 \\ 2 - 2\varepsilon
\end{pmatrix}
\]</span></p></li>
<li><p>The problems due to small values of <span class="math inline">\(\varepsilon\)</span> have disappeared.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="how-bad-is-it" class="slide level3">
<h3>How bad is it?</h3>
<p>This is a genuine problem we see in the code versions too!</p>
<div id="2c904045" class="cell" data-execution_count="4">
<div class="cell-output cell-output-stdout">
<pre><code>without row swapping:
eps=1.0e-02, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-04, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-06, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-08, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-10, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-12, x.T = [  1.00009,  2.00000 ], Solution? False
eps=1.0e-14, x.T = [  1.0214,  2.0000 ], Solution? False

with row swapping:
eps=1.0e-02, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-04, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-06, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-08, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-10, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-12, x.T = [  1.0,  2.0 ], Solution? True
eps=1.0e-14, x.T = [  1.0,  2.0 ], Solution? True
</code></pre>
</div>
</div>
</section>
<section id="remarks-1" class="slide level3">
<h3>Remarks</h3>
<ul>
<li><p>Writing the equations in a different order has removed the previous problem.</p></li>
<li><p>The diagonal entries are now always <em>relatively</em> larger.</p></li>
<li><p>The interchange of the order of equations is a simple example of <strong>row pivoting</strong>. This strategy avoids excessive rounding errors in the computations.</p></li>
</ul>
</section>
<section id="gaussian-elimination-with-pivoting" class="slide level3">
<h3>Gaussian elimination with pivoting</h3>
<p>Key idea:</p>
<ul>
<li><p>Before eliminating entries in column <span class="math inline">\(j\)</span>:</p>
<ul>
<li>find the entry in column <span class="math inline">\(j\)</span>, below the diagonal, of maximum magnitude;</li>
<li>if that entry is larger in magnitude than the diagonal entry then swap its row with row <span class="math inline">\(j\)</span>.</li>
</ul></li>
<li><p>Then eliminate column <span class="math inline">\(j\)</span> as before.</p></li>
</ul>
<aside class="notes">
<p>This algorithm will always work when the matrix <span class="math inline">\(A\)</span> is non-singular. Conversely, if all of the possible pivot values are zero this implies that the matrix is singular and a unique solution does not exist. At each elimination step the row multiplies used are guaranteed to be at most one in magnitude so any errors in the representation of the system cannot be amplified by the elimination process. As always, solving <span class="math inline">\(A \vec{x} = \vec{b}\)</span> requires that the entries in <span class="math inline">\(\vec{b}\)</span> are also swapped in the appropriate way.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-4" class="slide level3">
<h3>Example</h3>
<p>Consider the linear system of equations given by</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
-3 &amp; 2.1 - \varepsilon &amp; 6 \\
5 &amp; -1 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 9.9 + \varepsilon \\ 11
\end{pmatrix}
\]</span></p>
<p>where <span class="math inline">\(0 \le \varepsilon \ll 1\)</span>, and solve it using</p>
<ol type="1">
<li><p>Gaussian elimination without pivoting</p></li>
<li><p>Gaussian elimination with pivoting.</p></li>
</ol>
<p>The exact solution is <span class="math inline">\(\vec{x} = (0, -1, 2)^T\)</span> for any <span class="math inline">\(\varepsilon\)</span> in the given range.</p>
<aside class="notes">
<p><strong>1. Solve the system using Gaussian elimination with no pivoting.</strong></p>
<p>Eliminating the first column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>and then the second column gives</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 0 &amp; 5 + 15/\varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5 + 2.5(12 + \varepsilon)/\varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to</p>
<p><span class="math display">\[
x_3 = \frac{3 + \frac{12 + \varepsilon}{\varepsilon}}{2 + \frac{6}{\varepsilon}}
\qquad
x_2 = \frac{(12 + \varepsilon) - 6x_3}{-\varepsilon} \qquad
x_1 = \frac{7+ 7x_2}{10}.
\]</span></p>
<p>There are many divisions by <span class="math inline">\(\varepsilon\)</span>, so we will have problems if <span class="math inline">\(\varepsilon\)</span> is (very) small.</p>
<p><strong>2. Solve the system using Gaussian elimination with pivoting.</strong></p>
<p>The first stage is identical (because <span class="math inline">\(a_{11} = 10\)</span> is largest).</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; -\varepsilon &amp; 6 \\
0 &amp; 2.5 &amp; 5
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 12 + \varepsilon \\ 7.5
\end{pmatrix}
\]</span></p>
<p>but now <span class="math inline">\(|a_{22}| = \varepsilon\)</span> and <span class="math inline">\(|a_{32}| = 2.5\)</span> so we swap rows 2 and 3 to give</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; -\varepsilon &amp; 6
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + \varepsilon
\end{pmatrix}
\]</span></p>
<p>Now we may eliminate column 2:</p>
<p><span class="math display">\[
\begin{pmatrix}
10 &amp; -7 &amp; 0 \\
0 &amp; 2.5 &amp; 5 \\
0 &amp; 0 &amp; 6 + 2 \varepsilon
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2 \\ x_3
\end{pmatrix}
= \begin{pmatrix}
7 \\ 7.5 \\ 12 + 4 \varepsilon
\end{pmatrix}
\]</span></p>
<p>which leads to the exact answer:</p>
<p><span class="math display">\[
x_3 = \frac{12 + 4\varepsilon}{6 + 2 \varepsilon} = 2 \qquad
x_2 = \frac{7.5 - 5x_3}{2.5} = -1 \qquad
x_1 = \frac{7 + 7 x_2}{10} = 0.
\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="python-code-for-gaussian-elimination-with-pivoting" class="slide level3">
<h3>Python code for Gaussian elimination with pivoting</h3>
<div>
<div id="pyodide-16" class="exercise-cell">

</div>
<script type="pyodide-16-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZGVmIGdhdXNzaWFuX2VsaW1pbmF0aW9uX3dpdGhfcGl2b3RpbmcoQSwgYiwgdmVyYm9zZT1GYWxzZSk6XG4gICAgXCJcIlwiXG4gICAgcGVyZm9ybSBHYXVzc2lhbiBlbGltbmF0aW9uIHdpdGggcGl2b3RpbmcgdG8gcmVkdWNlIHRoZSBzeXN0ZW0gb2YgbGluZWFyXG4gICAgZXF1YXRpb25zIEF4PWIgdG8gdXBwZXIgdHJpYW5ndWxhciBmb3JtLlxuICAgIHVzZSB2ZXJib3NlIHRvIHByaW50IG91dCBpbnRlcm1lZGlhdGUgcmVwcmVzZW50YXRpb25zXG4gICAgXCJcIlwiXG4gICAgIyBmaW5kIHNoYXBlIG9mIHN5c3RlbVxuICAgIG4gPSBzeXN0ZW1fc2l6ZShBLCBiKVxuXG4gICAgIyBwZXJmb3JtIGZvcndhcmRzIGVsaW1pbmF0aW9uXG4gICAgZm9yIGkgaW4gcmFuZ2UobiAtIDEpOlxuICAgICAgICAjIGVsaW1pbmF0ZSBjb2x1bW4gaVxuICAgICAgICBpZiB2ZXJib3NlOlxuICAgICAgICAgICAgcHJpbnQoZlwiZWxpbWluYXRpbmcgY29sdW1uIHtpfVwiKVxuICAgICAgICBmb3IgaiBpbiByYW5nZShpICsgMSwgbik6XG4gICAgICAgICAgICAjIHJvdyBqXG4gICAgICAgICAgICBmYWN0b3IgPSBBW2osIGldIC8gQVtpLCBpXVxuICAgICAgICAgICAgaWYgdmVyYm9zZTpcbiAgICAgICAgICAgICAgICBwcmludChmXCIgIHJvdyB7an0gfC0+IHJvdyB7an0gLSB7ZmFjdG9yfSAqIHJvdyB7aX1cIilcbiAgICAgICAgICAgIHJvd19hZGQoQSwgYiwgaiwgLWZhY3RvciwgaSlcblxuICAgICAgICBpZiB2ZXJib3NlOlxuICAgICAgICAgICAgcHJpbnQoKVxuICAgICAgICAgICAgcHJpbnQoXCJuZXcgc3lzdGVtXCIpXG4gICAgICAgICAgICBwcmludF9hcnJheShBKVxuICAgICAgICAgICAgcHJpbnRfYXJyYXkoYilcbiAgICAgICAgICAgIHByaW50KClcbiJ9
</script>
</div>
</section>
<section id="lets-run-it" class="slide level3">
<h3>Letâ€™s run it!</h3>
<p>Gaussian elimination without pivoting following by back subsitution:</p>
<div>
<div id="pyodide-17" class="exercise-cell">

</div>
<script type="pyodide-17-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZXBzID0gMS4wZS0xNFxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIGVsaW1pbmF0aW9uIHdpdGhvdXQgcGl2b3RpbmdcIilcbmdhdXNzaWFuX2VsaW1pbmF0aW9uKEEsIGIsIHZlcmJvc2U9VHJ1ZSlcbnByaW50KClcblxucHJpbnQoXCJ1cHBlciB0cmlhbmd1bGFyIHN5c3RlbTpcIilcbnByaW50X2FycmF5KEEpXG5wcmludF9hcnJheShiKVxucHJpbnQoKVxuXG5wcmludChcInBlcmZvcm1pbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uXCIpXG54ID0gYmFja3dhcmRfc3Vic3RpdHV0aW9uKEEsIGIpXG5wcmludCgpXG5cbnByaW50KFwic29sdXRpb24gdXNpbmcgYmFja3dhcmQgc3Vic3RpdHV0aW9uOlwiKVxucHJpbnRfYXJyYXkoeClcbnByaW50KClcblxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcbnByaW50KFwiRG9lcyB4IHNvbHZlIHRoZSBvcmlnaW5hbCBzeXN0ZW0/XCIsIG5wLmFsbGNsb3NlKEEgQCB4LCBiKSkifQ==
</script>
</div>
<p>Gaussian elimination with pivoting following by back subsitution:</p>
<div>
<div id="pyodide-18" class="exercise-cell">

</div>
<script type="pyodide-18-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiZXBzID0gMS4wZS0xNFxuQSA9IG5wLmFycmF5KFtbMTAuMCwgLTcuMCwgMC4wXSwgWy0zLjAsIDIuMSAtIGVwcywgNi4wXSwgWzUuMCwgLTEuMCwgNS4wXV0pXG5iID0gbnAuYXJyYXkoW1s3LjBdLCBbOS45ICsgZXBzXSwgWzExLjBdXSlcblxucHJpbnQoXCJzdGFydGluZyBzeXN0ZW06XCIpXG5wcmludF9hcnJheShBKVxucHJpbnRfYXJyYXkoYilcbnByaW50KClcblxucHJpbnQoXCJwZXJmb3JtaW5nIEdhdXNzaWFuIGVsaW1pbmF0aW9uIHdpdGggcGl2b3RpbmdcIilcbmdhdXNzaWFuX2VsaW1pbmF0aW9uX3dpdGhfcGl2b3RpbmcoQSwgYiwgdmVyYm9zZT1UcnVlKVxucHJpbnQoKVxuXG5wcmludChcInVwcGVyIHRyaWFuZ3VsYXIgc3lzdGVtOlwiKVxucHJpbnRfYXJyYXkoQSlcbnByaW50X2FycmF5KGIpXG5wcmludCgpXG5cbnByaW50KFwicGVyZm9ybWluZyBiYWNrd2FyZCBzdWJzdGl0dXRpb25cIilcbnggPSBiYWNrd2FyZF9zdWJzdGl0dXRpb24oQSwgYilcbnByaW50KClcblxucHJpbnQoXCJzb2x1dGlvbiB1c2luZyBiYWNrd2FyZCBzdWJzdGl0dXRpb246XCIpXG5wcmludF9hcnJheSh4KVxucHJpbnQoKVxuXG5BID0gbnAuYXJyYXkoW1sxMC4wLCAtNy4wLCAwLjBdLCBbLTMuMCwgMi4xIC0gZXBzLCA2LjBdLCBbNS4wLCAtMS4wLCA1LjBdXSlcbmIgPSBucC5hcnJheShbWzcuMF0sIFs5LjkgKyBlcHNdLCBbMTEuMF1dKVxucHJpbnQoXCJEb2VzIHggc29sdmUgdGhlIG9yaWdpbmFsIHN5c3RlbT9cIiwgbnAuYWxsY2xvc2UoQSBAIHgsIGIpKSJ9
</script>
</div>

<script type="pyodide-data">
eyJvcHRpb25zIjp7ImluZGV4VVJMIjoiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3B5b2RpZGUvdjAuMjYuMS9mdWxsLyJ9LCJwYWNrYWdlcyI6eyJwa2dzIjpbInB5b2RpZGVfaHR0cCIsIm1pY3JvcGlwIiwiaXB5dGhvbiIsIm51bXB5Il19fQ==
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJweW9kaWRlLTE4IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTggPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE4LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTgtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xOCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTgsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE3IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTcgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE3LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTctY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNyA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE2IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTYgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE2LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTYtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNiA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE1IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTUgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE1LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTUtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTE0IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6Il9weW9kaWRlX3ZhbHVlXzE0ID0ge1xuICBjb25zdCB7IGhpZ2hsaWdodFB5dGhvbiwgYjY0RGVjb2RlfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE0LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgLy8gRGVmYXVsdCBldmFsdWF0aW9uIGNvbmZpZ3VyYXRpb25cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIGlkOiBcInB5b2RpZGUtMTQtY29udGVudHNcIixcbiAgICBlY2hvOiB0cnVlLFxuICAgIG91dHB1dDogdHJ1ZVxuICB9LCBibG9jay5hdHRyKTtcblxuICAvLyBFdmFsdWF0ZSB0aGUgcHJvdmlkZWQgUHl0aG9uIGNvZGVcbiAgY29uc3QgcmVzdWx0ID0gcHlvZGlkZU9qcy5wcm9jZXNzKHtjb2RlOiBibG9jay5jb2RlLCBvcHRpb25zfSwge30pO1xuXG4gIC8vIEVhcmx5IHlpZWxkIHdoaWxlIHdlIHdhaXQgZm9yIHRoZSBmaXJzdCBldmFsdWF0aW9uIGFuZCByZW5kZXJcbiAgaWYgKG9wdGlvbnMub3V0cHV0ICYmICEoXCIxNFwiIGluIHB5b2RpZGVPanMucmVuZGVyZWRPanMpKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICAgIGlmIChvcHRpb25zLmVjaG8pIHtcbiAgICAgIC8vIFNob3cgb3V0cHV0IGFzIGhpZ2hsaWdodGVkIHNvdXJjZVxuICAgICAgY29uc3QgcHJlRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG4gICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJzb3VyY2VDb2RlXCI7XG4gICAgICBwcmVFbGVtLmNsYXNzTmFtZSA9IFwic291cmNlQ29kZSBweXRob25cIjtcbiAgICAgIHByZUVsZW0uYXBwZW5kQ2hpbGQoaGlnaGxpZ2h0UHl0aG9uKGJsb2NrLmNvZGUpKTtcbiAgICAgIHNwaW5uZXIuY2xhc3NOYW1lID0gXCJzcGlubmVyLWdyb3cgc3Bpbm5lci1ncm93LXNtIG0tMiBwb3NpdGlvbi1hYnNvbHV0ZSB0b3AtMCBlbmQtMFwiO1xuICAgICAgcHJlRWxlbS5hcHBlbmRDaGlsZChzcGlubmVyKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwcmVFbGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3Bpbm5lci5jbGFzc05hbWUgPSBcInNwaW5uZXItYm9yZGVyIHNwaW5uZXItYm9yZGVyLXNtXCI7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3Bpbm5lcik7XG4gICAgfVxuXG4gICAgeWllbGQgY29udGFpbmVyO1xuICB9XG5cbiAgcHlvZGlkZU9qcy5yZW5kZXJlZE9qc1tcIjE0XCJdID0gdHJ1ZTtcbiAgeWllbGQgYXdhaXQgcmVzdWx0O1xufVxuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtMTMiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8xMyA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMTMtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS0xMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzEzID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8xMywge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtMTIiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8xMiA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMTItY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS0xMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzEyID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8xMiwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtMTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8xMSA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMTEtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS0xMS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzExID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8xMSwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtMTAiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8xMCA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMTAtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS0xMC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzEwID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8xMCwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtOSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3B5b2RpZGVfZWRpdG9yXzkgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTktY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS05LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFB5b2RpZGVFeGVyY2lzZUVkaXRvcihcbiAgICBweW9kaWRlT2pzLnB5b2RpZGVQcm9taXNlLFxuICAgIGJsb2NrLmNvZGUsXG4gICAgb3B0aW9uc1xuICApO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3B5b2RpZGVfdmFsdWVfOSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfOSwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtOCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3B5b2RpZGVfZWRpdG9yXzggPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTgtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS04LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFB5b2RpZGVFeGVyY2lzZUVkaXRvcihcbiAgICBweW9kaWRlT2pzLnB5b2RpZGVQcm9taXNlLFxuICAgIGJsb2NrLmNvZGUsXG4gICAgb3B0aW9uc1xuICApO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3B5b2RpZGVfdmFsdWVfOCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfOCwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtNyIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3B5b2RpZGVfZWRpdG9yXzcgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTctY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS03LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFB5b2RpZGVFeGVyY2lzZUVkaXRvcihcbiAgICBweW9kaWRlT2pzLnB5b2RpZGVQcm9taXNlLFxuICAgIGJsb2NrLmNvZGUsXG4gICAgb3B0aW9uc1xuICApO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3B5b2RpZGVfdmFsdWVfNyA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfNywge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtNiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3B5b2RpZGVfZWRpdG9yXzYgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTYtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS02LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFB5b2RpZGVFeGVyY2lzZUVkaXRvcihcbiAgICBweW9kaWRlT2pzLnB5b2RpZGVQcm9taXNlLFxuICAgIGJsb2NrLmNvZGUsXG4gICAgb3B0aW9uc1xuICApO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3B5b2RpZGVfdmFsdWVfNiA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfNiwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtNSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3B5b2RpZGVfZWRpdG9yXzUgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTUtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgcHlvZGlkZS01LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFB5b2RpZGVFeGVyY2lzZUVkaXRvcihcbiAgICBweW9kaWRlT2pzLnB5b2RpZGVQcm9taXNlLFxuICAgIGJsb2NrLmNvZGUsXG4gICAgb3B0aW9uc1xuICApO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3B5b2RpZGVfdmFsdWVfNSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfNSwge30pO1xuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtNCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJfcHlvZGlkZV92YWx1ZV80ID0ge1xuICBjb25zdCB7IGhpZ2hsaWdodFB5dGhvbiwgYjY0RGVjb2RlfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTQtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICAvLyBEZWZhdWx0IGV2YWx1YXRpb24gY29uZmlndXJhdGlvblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgaWQ6IFwicHlvZGlkZS00LWNvbnRlbnRzXCIsXG4gICAgZWNobzogdHJ1ZSxcbiAgICBvdXRwdXQ6IHRydWVcbiAgfSwgYmxvY2suYXR0cik7XG5cbiAgLy8gRXZhbHVhdGUgdGhlIHByb3ZpZGVkIFB5dGhvbiBjb2RlXG4gIGNvbnN0IHJlc3VsdCA9IHB5b2RpZGVPanMucHJvY2Vzcyh7Y29kZTogYmxvY2suY29kZSwgb3B0aW9uc30sIHt9KTtcblxuICAvLyBFYXJseSB5aWVsZCB3aGlsZSB3ZSB3YWl0IGZvciB0aGUgZmlyc3QgZXZhbHVhdGlvbiBhbmQgcmVuZGVyXG4gIGlmIChvcHRpb25zLm91dHB1dCAmJiAhKFwiNFwiIGluIHB5b2RpZGVPanMucmVuZGVyZWRPanMpKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICAgIGlmIChvcHRpb25zLmVjaG8pIHtcbiAgICAgIC8vIFNob3cgb3V0cHV0IGFzIGhpZ2hsaWdodGVkIHNvdXJjZVxuICAgICAgY29uc3QgcHJlRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG4gICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJzb3VyY2VDb2RlXCI7XG4gICAgICBwcmVFbGVtLmNsYXNzTmFtZSA9IFwic291cmNlQ29kZSBweXRob25cIjtcbiAgICAgIHByZUVsZW0uYXBwZW5kQ2hpbGQoaGlnaGxpZ2h0UHl0aG9uKGJsb2NrLmNvZGUpKTtcbiAgICAgIHNwaW5uZXIuY2xhc3NOYW1lID0gXCJzcGlubmVyLWdyb3cgc3Bpbm5lci1ncm93LXNtIG0tMiBwb3NpdGlvbi1hYnNvbHV0ZSB0b3AtMCBlbmQtMFwiO1xuICAgICAgcHJlRWxlbS5hcHBlbmRDaGlsZChzcGlubmVyKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwcmVFbGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3Bpbm5lci5jbGFzc05hbWUgPSBcInNwaW5uZXItYm9yZGVyIHNwaW5uZXItYm9yZGVyLXNtXCI7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3Bpbm5lcik7XG4gICAgfVxuXG4gICAgeWllbGQgY29udGFpbmVyO1xuICB9XG5cbiAgcHlvZGlkZU9qcy5yZW5kZXJlZE9qc1tcIjRcIl0gPSB0cnVlO1xuICB5aWVsZCBhd2FpdCByZXN1bHQ7XG59XG4ifSx7ImNlbGxOYW1lIjoicHlvZGlkZS0zIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMyA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMy1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGBweW9kaWRlLTMtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8zID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8zLCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoicHlvZGlkZS0yIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMiA9IHtcbiAgY29uc3QgeyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMi1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGBweW9kaWRlLTItY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8yID0gcHlvZGlkZU9qcy5wcm9jZXNzKF9weW9kaWRlX2VkaXRvcl8yLCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoicHlvZGlkZS0xIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6Il9weW9kaWRlX3ZhbHVlXzEgPSB7XG4gIGNvbnN0IHsgaGlnaGxpZ2h0UHl0aG9uLCBiNjREZWNvZGV9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtMS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIC8vIERlZmF1bHQgZXZhbHVhdGlvbiBjb25maWd1cmF0aW9uXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHtcbiAgICBpZDogXCJweW9kaWRlLTEtY29udGVudHNcIixcbiAgICBlY2hvOiB0cnVlLFxuICAgIG91dHB1dDogdHJ1ZVxuICB9LCBibG9jay5hdHRyKTtcblxuICAvLyBFdmFsdWF0ZSB0aGUgcHJvdmlkZWQgUHl0aG9uIGNvZGVcbiAgY29uc3QgcmVzdWx0ID0gcHlvZGlkZU9qcy5wcm9jZXNzKHtjb2RlOiBibG9jay5jb2RlLCBvcHRpb25zfSwge30pO1xuXG4gIC8vIEVhcmx5IHlpZWxkIHdoaWxlIHdlIHdhaXQgZm9yIHRoZSBmaXJzdCBldmFsdWF0aW9uIGFuZCByZW5kZXJcbiAgaWYgKG9wdGlvbnMub3V0cHV0ICYmICEoXCIxXCIgaW4gcHlvZGlkZU9qcy5yZW5kZXJlZE9qcykpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGNvbnN0IHNwaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gICAgaWYgKG9wdGlvbnMuZWNobykge1xuICAgICAgLy8gU2hvdyBvdXRwdXQgYXMgaGlnaGxpZ2h0ZWQgc291cmNlXG4gICAgICBjb25zdCBwcmVFbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKTtcbiAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSBcInNvdXJjZUNvZGVcIjtcbiAgICAgIHByZUVsZW0uY2xhc3NOYW1lID0gXCJzb3VyY2VDb2RlIHB5dGhvblwiO1xuICAgICAgcHJlRWxlbS5hcHBlbmRDaGlsZChoaWdobGlnaHRQeXRob24oYmxvY2suY29kZSkpO1xuICAgICAgc3Bpbm5lci5jbGFzc05hbWUgPSBcInNwaW5uZXItZ3JvdyBzcGlubmVyLWdyb3ctc20gbS0yIHBvc2l0aW9uLWFic29sdXRlIHRvcC0wIGVuZC0wXCI7XG4gICAgICBwcmVFbGVtLmFwcGVuZENoaWxkKHNwaW5uZXIpO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHByZUVsZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGlubmVyLmNsYXNzTmFtZSA9IFwic3Bpbm5lci1ib3JkZXIgc3Bpbm5lci1ib3JkZXItc21cIjtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzcGlubmVyKTtcbiAgICB9XG5cbiAgICB5aWVsZCBjb250YWluZXI7XG4gIH1cblxuICBweW9kaWRlT2pzLnJlbmRlcmVkT2pzW1wiMVwiXSA9IHRydWU7XG4gIHlpZWxkIGF3YWl0IHJlc3VsdDtcbn1cbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLXByZWx1ZGUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJweW9kaWRlT2pzID0ge1xuICBjb25zdCB7XG4gICAgUHlvZGlkZUV2YWx1YXRvcixcbiAgICBQeW9kaWRlRW52aXJvbm1lbnRNYW5hZ2VyLFxuICAgIHNldHVwUHl0aG9uLFxuICAgIHN0YXJ0UHlvZGlkZVdvcmtlcixcbiAgICBiNjREZWNvZGUsXG4gICAgY29sbGFwc2VQYXRoLFxuICB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzdGF0dXNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctc3RhdHVzXCIpO1xuICBjb25zdCBpbmRpY2F0b3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpbmRpY2F0b3JDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImQtbm9uZVwiKTtcblxuICBsZXQgc3RhdHVzVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgc3RhdHVzVGV4dC5jbGFzc0xpc3QgPSBcImV4ZXJjaXNlLWxvYWRpbmctZGV0YWlsc1wiO1xuICBzdGF0dXNUZXh0ID0gc3RhdHVzQ29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXR1c1RleHQpO1xuICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYEluaXRpYWxpc2VgO1xuXG4gIC8vIEhvaXN0IGluZGljYXRvciBvdXQgZnJvbSBmaW5hbCBzbGlkZSB3aGVuIHJ1bm5pbmcgdW5kZXIgcmV2ZWFsXG4gIGNvbnN0IHJldmVhbFN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsIC5leGVyY2lzZS1sb2FkaW5nLWluZGljYXRvclwiKTtcbiAgaWYgKHJldmVhbFN0YXR1cykge1xuICAgIHJldmVhbFN0YXR1cy5yZW1vdmUoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJldmVhbCA+IC5zbGlkZXNcIikuYXBwZW5kQ2hpbGQocmV2ZWFsU3RhdHVzKTtcbiAgfVxuXG4gIC8vIE1ha2UgYW55IHJldmVhbCBzbGlkZXMgd2l0aCBsaXZlIGNlbGxzIHNjcm9sbGFibGVcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXZlYWwgLmV4ZXJjaXNlLWNlbGxcIikuZm9yRWFjaCgoZWwpID0+IHtcbiAgICBlbC5jbG9zZXN0KCdzZWN0aW9uLnNsaWRlJykuY2xhc3NMaXN0LmFkZChcInNjcm9sbGFibGVcIik7XG4gIH0pXG5cbiAgLy8gUHlvZGlkZSBzdXBwbGVtZW50YWwgZGF0YSBhbmQgb3B0aW9uc1xuICBjb25zdCBkYXRhQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLWRhdGFcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShiNjREZWNvZGUoZGF0YUNvbnRlbnQpKTtcblxuICAvLyBHcmFiIGxpc3Qgb2YgcmVzb3VyY2VzIHRvIGJlIGRvd25sb2FkZWRcbiAgY29uc3QgZmlsZXNDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInZmcy1maWxlXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgZmlsZXMgPSBKU09OLnBhcnNlKGI2NERlY29kZShmaWxlc0NvbnRlbnQpKTtcblxuICBsZXQgcHlvZGlkZVByb21pc2UgPSAoYXN5bmMgKCkgPT4ge1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgUHlvZGlkZWA7XG4gICAgY29uc3QgcHlvZGlkZSA9IGF3YWl0IHN0YXJ0UHlvZGlkZVdvcmtlcihkYXRhLm9wdGlvbnMpO1xuXG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiBtaWNyb3BpcGA7XG4gICAgYXdhaXQgcHlvZGlkZS5sb2FkUGFja2FnZShcIm1pY3JvcGlwXCIpO1xuICAgIGNvbnN0IG1pY3JvcGlwID0gYXdhaXQgcHlvZGlkZS5weWltcG9ydChcIm1pY3JvcGlwXCIpO1xuICAgIGF3YWl0IGRhdGEucGFja2FnZXMucGtncy5tYXAoKHBrZykgPT4gKCkgPT4ge1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiAke3BrZ31gO1xuICAgICAgcmV0dXJuIG1pY3JvcGlwLmluc3RhbGwocGtnKTtcbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICBhd2FpdCBtaWNyb3BpcC5kZXN0cm95KCk7XG5cbiAgICAvLyBEb3dubG9hZCBhbmQgaW5zdGFsbCByZXNvdXJjZXNcbiAgICBhd2FpdCBmaWxlcy5tYXAoKGZpbGUpID0+IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLnN1YnN0cmluZyhmaWxlLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcbiAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgcmVzb3VyY2U6ICR7bmFtZX1gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBkb3dubG9hZCBcXGAke2ZpbGV9XFxgLiBFcnJvciAke3Jlc3BvbnNlLnN0YXR1c306IFwiJHtyZXNwb25zZS5zdGF0dXNUZXh0fVwiLmApO1xuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7XG5cbiAgICAgIC8vIFN0b3JlIFVSTHMgaW4gdGhlIGN3ZCB3aXRob3V0IGFueSBzdWJkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAgICBpZiAoZmlsZS5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICBmaWxlID0gbmFtZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29sbGFwc2UgaGlnaGVyIGRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGZpbGUgPSBjb2xsYXBzZVBhdGgoZmlsZSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkaXJlY3RvcnkgdHJlZSwgaWdub3JpbmcgXCJkaXJlY3RvcnkgZXhpc3RzXCIgVkZTIGVycm9yc1xuICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpO1xuICAgICAgbGV0IHBhdGggPSAnJztcbiAgICAgIHdoaWxlIChwYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBhdGggKz0gcGFydHMuc2hpZnQoKSArICcvJztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBweW9kaWRlLkZTLm1rZGlyKHBhdGgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKGUubmFtZSAhPT0gXCJFcnJub0Vycm9yXCIpIHRocm93IGU7XG4gICAgICAgICAgaWYgKGUuZXJybm8gIT09IDIwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHRQdHIgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuX3N0cmVycm9yKGUuZXJybm8pO1xuICAgICAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcHlvZGlkZS5fbW9kdWxlLlVURjhUb1N0cmluZyhlcnJvclRleHRQdHIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yICR7ZS5lcnJub30gXCIke2Vycm9yVGV4dH1cIi5gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgdGhpcyBmaWxlIHRvIHRoZSBWRlNcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBweW9kaWRlLkZTLndyaXRlRmlsZShmaWxlLCBuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChlLm5hbWUgIT09IFwiRXJybm9FcnJvclwiKSB0aHJvdyBlO1xuICAgICAgICBjb25zdCBlcnJvclRleHRQdHIgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuX3N0cmVycm9yKGUuZXJybm8pO1xuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuVVRGOFRvU3RyaW5nKGVycm9yVGV4dFB0cik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZXN5c3RlbSBFcnJvciAke2UuZXJybm99IFwiJHtlcnJvclRleHR9XCIuYCk7XG4gICAgICB9XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYFB5b2RpZGUgZW52aXJvbm1lbnQgc2V0dXBgO1xuICAgIGF3YWl0IHNldHVwUHl0aG9uKHB5b2RpZGUpO1xuXG4gICAgc3RhdHVzVGV4dC5yZW1vdmUoKTtcbiAgICBpZiAoc3RhdHVzQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA9PSAwKSB7XG4gICAgICBzdGF0dXNDb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHB5b2RpZGU7XG4gIH0pKCkuY2F0Y2goKGVycikgPT4ge1xuICAgIHN0YXR1c1RleHQuc3R5bGUuY29sb3IgPSBcInZhcigtLWV4ZXJjaXNlLWVkaXRvci1obC1lciwgI0FEMDAwMClcIjtcbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gZXJyLm1lc3NhZ2U7XG4gICAgLy9pbmRpY2F0b3JDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5zcGlubmVyLWdyb3dcIikuY2xhc3NMaXN0LmFkZChcImQtbm9uZVwiKTtcbiAgICB0aHJvdyBlcnI7XG4gIH0pO1xuXG4gIC8vIEtlZXAgdHJhY2sgb2YgaW5pdGlhbCBPSlMgYmxvY2sgcmVuZGVyXG4gIGNvbnN0IHJlbmRlcmVkT2pzID0ge307XG5cbiAgY29uc3QgcHJvY2VzcyA9IGFzeW5jIChjb250ZXh0LCBpbnB1dHMpID0+IHtcbiAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgcHlvZGlkZVByb21pc2U7XG4gICAgY29uc3QgZXZhbHVhdG9yID0gbmV3IFB5b2RpZGVFdmFsdWF0b3IocHlvZGlkZSwgY29udGV4dCk7XG4gICAgYXdhaXQgZXZhbHVhdG9yLnByb2Nlc3MoaW5wdXRzKTtcbiAgICByZXR1cm4gZXZhbHVhdG9yLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHlvZGlkZVByb21pc2UsXG4gICAgcmVuZGVyZWRPanMsXG4gICAgcHJvY2VzcyxcbiAgfTtcbn1cbiJ9XX0=
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lec03_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lec03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lec03_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lec03_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="ojs-module-contents">
    eyJjb250ZW50cyI6W119
    </script>
    <script type="module">
    if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
    window._ojs.paths.runtimeToDoc = "../../..";
    window._ojs.paths.runtimeToRoot = "../../../..";
    window._ojs.paths.docToRoot = "..";
    window._ojs.selfContained = false;
    window._ojs.runtime.interpretFromScriptTags();
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>